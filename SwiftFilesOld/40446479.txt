How do I get a specific value from returned json in Swift 3.0?
I am trying to get a value from json in Swift. I have added an image of the data tree. My previous attempts have not worked. Below is code which prints the full json object which is what I don't want. json tree image import PlaygroundSupport import UIKit let url = URL(string: "https://api.data.gov.sg/v1/transport/taxi-availability") var request = URLRequest(url: url!); request.addValue("xxxx", forHTTPHeaderField: "api-key") let task = URLSession.shared.dataTask(with: request) { data, response, error in guard error == nil else { print(error) return } guard let data = data else { print("Data is empty") return } let json = try! JSONSerialization.jsonObject(with: data, options: []) //print(json) }//end //["features"]??[0]? task.resume() PlaygroundPage.current.needsIndefiniteExecution = true
You just need to do something with the json you've been vended: let task = URLSession ... { data, response, error in let json = JSONSerialization.jsonObject(...) if let json = json as? [String: Any] { // now you have a top-level json dictionary for key, value in json { print("json[\"\(key\")] = \(value)") } } }
I didn't verify the following code but it should work for the son tree you provided. (disclaimer: might have some errors but its mostly correct) if let json = (try? JSONSerialization.jsonObject(with: data, options: [])) as? [String:Any] , let features = json["features"] as? [Any] , let firstFeature = features[0] as? [String:Any] , let properties = firstFeature["properties"] as? [String:Any] , let taxiCount = properties["taxi_count"] as? Int { print(taxiCount) }
If Json is dictionary let json = try! JSONSerialization.jsonObject(with: data, options: []) let jsonDict = json as? NSDictionary //if you have a key name let name = jsonDict["name"] as? String //and so on //if you have a array in your dictionary let likes = jsonDict["likes"] as? NSArray let numberOfLikes = likes.count for eachLike in likes { let likerName = eachLike["liker_name"] as? String }