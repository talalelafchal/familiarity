UISegmentedControl as UINavigationBar title item loads after some delay
Since I updated to Xcode8/iOS10 & Swift 3 I have this weird issue on segmented controls used as navigation bar titles.. it takes some time to appear. Or I can touch the area (invisible at that time) and it will appear. I believe the item as been loaded but just not be drawn and then it got either draw by touching the area or because of the event loop asking for view redraw. UI is not blocked. can't find a way to fix it. PS: could not reproduce on fresh new project Breaking with Debug View Hierarchy, it appears the UISegmentedControls lives but is not initialised with colors/texts.. then it will, few seconds later.
Ok this was due to threads. My app on loading was initialising a core data stack. On the callback of it I was instantiating the right view controller using window.rootViewController = vc, this needs to be executed on the main thread, but the completion of the core data stack init was launch on a background one. Something weird yet. I had implemented a UIWindow extension extension UIWindow { func setRootViewController(with viewController: UIViewController) { DispatchQueue.main.async { self.rootViewController = viewController } } } // beeing in background thread self.window.setRootViewController(with: self.rootVC) this will produce the issue below. but the next will work extension UIWindow { func setRootViewController(with viewController: UIViewController) { self.rootViewController = viewController } } // beeing in background thread DispatchQueue.main.async { self.window.setRootViewController(with: self.rootVC) } don't know what's the difference.