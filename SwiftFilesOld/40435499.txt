Communicating connection state between clients
In the iOS app I'm making, I want one user to know immediately if another user lost connection to the Firebase database. The onDisconnect method would work if it were not for the fact that it does not fire immediately, but instead fires after a few minutes have elapsed. Is there anything I'm missing in the API, or perhaps some clever (and not too messy) workaround that can accomplish this? Constant communication between these two users is very important, so it's critical that one knows immediately if the other has lost their ability to communicate.
To check if a user has gone offline or online to your Firebase Database you can :- FIRDatabase.database().reference().child(".info/connected").observe(.value,with : {(Snap) in let connected = Snap.value as? Bool print(connected!) }) .observe(.value, with : ... will open a separate network thread which will get called whenever the user's state is changed. There are two possibilities :- User deliberately closes the app. Just add this to your Data Structure :-  online_Users: { userID1 : true, userID2 : false, // user 2 went offline userID3 : true, userID4 : true, .... } And whenever your user goes offline or online just change this status to respective false or true by checking through connected! in above code block. Most probably you have to take into account the possibilities of app going into background, terminating etc.., whose call blocks are generally present in the AppDelegate such as func applicationWillResignActive(_:, func applicationDidEnterBackground(_ . Just surf through the documentation Then retrieve your user2 active state in your user1 app and there you go. Infact listen to the childChanged from your user1 app for user2 state that way it will be triggered every time it changes. User losses its network connection, as suggested by @Frank in comments:- FIRDatabase.database().reference().child("online_Users").onDisconnectUpdateChildValues([FIRAuth.auth()!.currentUser!.uid : false], withCompletionBlock: {(Err, Ref) in print(Ref) print(Err?.localizedDescription) }) Also see :- Firebase Documentation For offline capabilities PS:- Mathematically there can be four possible combination's to this particular situation. Any user state be either true or false so mahtematicaly speaking its (2C1)*(2C1) = 4. But i think you get the jist. To make your app foolproof you would need to satisfy all four of those combinations.