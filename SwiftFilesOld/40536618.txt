Swift 3: Authenticate with custom token(s), managing requests with server (node.js)
There is not much information in the Firebase Docs on dealing with custom tokens. I have set up a server with node.js, but I don't know how to manage requests to the server to send the information back to the app and vice-versa. Any resources on how to achieve this? This is the code for the node.js server var serviceAccount = require('./service-account.json'); var firebase = require('firebase'); var path = require("path"); var admin = require('firebase-admin'); var FirebaseTokenGenerator = require("firebase-token-generator"); var refreshToken; var uid = 'clientId'; var additionalClaims = { admin: true, manager: true, menuAccess: true }; var clientIdToken = firebase.auth().createCustomToken(uid, additionalClaims); console.log(clientIdToken) firebase.initializeApp({ serviceAccount: path.resolve(__dirname, '/Users/myUserName/Desktop/nodeClient/service-account.json'), databaseURL: "https://<firebase-project>.firebaseio.com/", databaseAuthVariableOverride: { uid: "clientId" } }); In xcode:  func login (email: String, password: String, onComplete: Completion?) { self.showActivityIndicatory(uiView: self.uiView) FIRAuth.auth()?.signIn(withEmail: email, password: password, completion: { (user, error) in if error != nil { self.handleFirebaseError(error: error! as NSError, onComplete: onComplete) self.stopAnimating() } else { // User successfully logged in FIRAuth.auth()?.addStateDidChangeListener { auth, user in if user != nil { let userUpdate = ["provider": String(describing:FIRAuth.auth()?.currentUser?.providerID), "email": "email": String(describing: FIRAuth.auth()?.currentUser?.email!) ] DataService.instance.registerUsers(uid: (user?.uid)!, user: userUpdate) FIRAuth.auth()?.signIn(withCustomToken: "clientIdToken") {(user, error) in if user != nil { print("Got here somehow..") print(user?.uid) // as I create a custom token, this user?.uid should be "clientId", right? } else { print(error) // I get an error here } } print("Signed in") } else { print("NOT SIGNED IN") } } let deadlineTime = DispatchTime.now() + .seconds(1) DispatchQueue.main.asyncAfter(deadline: deadlineTime) { self.performSegue(withIdentifier: "HomeSegue", sender: nil) } } }) } Optional(Error Domain=FIRAuthErrorDomain Code=17000 "The custom token format is incorrect. Please check the documentation." UserInfo={NSLocalizedDescription=The custom token format is incorrect. Please check the documentation., error_name=ERROR_INVALID_CUSTOM_TOKEN}) How shall I proceed? I know I have to send the credentials to my server from the app, but how do I achieve this? I am thinking of digging into JWT and Alamofire, and I have searched for days to solve this particular problem. I have encountered other programmers tackling the same issue.