Why is this JSON refusing to get a response? And fails on a curl http://.... response.json command
I am having trouble getting this JSON to output correctly. I have been struggling with this for a number of days now. The initial error I was receiving was: Error Domain=NSCocoaErrorDomain Code=3840 "Invalid value around character 0." UserInfo={NSDebugDescription=Invalid value around character 0.} This is the output in the browser I get when using the request: http://www.quasisquest.uk/KeepScore/getTotalsStats.php?player_id=2 {"Stats":{"totalWins":10,"totalDraws":6,"totalLosses":3,"winPercentage":"52.63%","goalsScored":40,"goalsConceded":30,"goalDifference":10}} After discussion on here it was mentioned the problem may be php side but I am at a loss to what since even a simple echo json_endcode ("test") and taking out any MySQL interference has not worked. I have spoke my to hosting company who have said everything is fine server-side. This is the Swift function: override func viewDidAppear(_ animated: Bool) { //communitiesTableView.reloadData() let isUserLoggedIn = UserDefaults.bool(UserDefaults.standard)(forKey: "isUserLoggedIn"); if(!isUserLoggedIn) { self.performSegue(withIdentifier: "loginView", sender: self); } let myUrl = URL(string: "http://www.quasisquest.uk/KeepScore/getTotalsStats.php?"); var request = URLRequest(url:myUrl!); request.addValue("application/json",forHTTPHeaderField: "Content-Type") request.addValue("application/json",forHTTPHeaderField: "Accept") request.httpMethod = "POST"; let postString = "player_id=\(self.playerId)"; request.httpBody = postString.data(using: String.Encoding.utf8); print (myUrl!,postString) let task = URLSession.shared.dataTask(with: request) { (data: Data?, response: URLResponse?, error: Error?) in DispatchQueue.main.async { if error != nil { print("error=\(error)") return } do{ let json = try JSONSerialization.jsonObject(with: data!, options: .allowFragments) as? AnyObject print (json!) if let arr = json?["Stats"] as? [[String:AnyObject]] { self.totalWins = arr.flatMap { $0["totalWins"]} print("here: ", self.totalWins) } } catch{ print(error) } } } task.resume() } Below is the php script:  <?php require ("Conn.php"); require ("MySQLDao.php"); $playerId = htmlentities($_REQUEST["player_id"]); $returnValue = array(); if(empty($playerId)) { $returnValue["status"] = "error"; $returnValue["message"] = "Missing required field"; echo json_encode($returnValue); return; } $dao = new MySQLDao(); $dao->openConnection(); //WINS LOSSES DRAWS AND % $playerTotalWins = array(); $playerTotalWins = $dao->getTotalWins($playerId); $playerTotalDraws = array(); $playerTotalDraws = $dao->getTotalDraws($playerId); $playerTotalLosses = array(); $playerTotalLosses = $dao->getTotalLosses($playerId); $winPercentage = (($playerTotalWins) / (($playerTotalWins) + ($playerTotalDraws) + ($playerTotalLosses))); $newWinpercent = sprintf("%.2f%%", $winPercentage* 100); //GOALS SCORED $goalsScoredHome = array(); $goalsScoredHome = $dao->getGFHome($playerId); $goalsScoredAway = array(); $goalsScoredAway = $dao->getGFAway($playerId); $totalGoalsScored = ($goalsScoredHome + $goalsScoredAway); //GOALS CONCEDED $goalsConcededHome = array(); $goalsConcededHome = $dao->getGCHome($playerId); $goalsConcededAway = array(); $goalsConcededAway = $dao->getGCAway($playerId); $totalGoalsConceded = ($goalsConcededHome + $goalsConcededAway); //GOAL DIFFERENCE $goalDifference = ($totalGoalsScored - $totalGoalsConceded); //PRINT OUT header('Content-Type: application/json'); $arr = array('totalWins' => $playerTotalWins, 'totalDraws' => $playerTotalDraws, 'totalLosses' => $playerTotalLosses, 'winPercentage' => $newWinpercent, 'goalsScored'=>$totalGoalsScored, 'goalsConceded'=>$totalGoalsConceded, 'goalDifference' => $goalDifference); echo json_encode (array('Stats' => $arr)); $dao -> closeConnection(); ?> It has been suggested I run a curl http://... -> response.json but this seems to save a file with 0 bytes. I am totally at a loss and new to Swift so all help is appreciated.
So the problem was in this line let myUrl = URL(string: "http://www.quasisquest.uk/KeepScore/getTotalsStats.php?"); The ? was kicking it out. Solved :)