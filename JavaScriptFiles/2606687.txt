Writing to a new window with javascript... get access denied
<p>I have been struggling with this for a while now, and decided it was time to ask for help.</p> <p>I am trying to create a print function on an aspx page, and I am using javascript to do this:</p> <pre><code> function PrintContentCell() { var display_setting = "toolbar=yes, location=no, directories=yes, menubar=yes,"; display_setting += "scrollbars=yes, width=750, height=600, left=100, top=25"; var content_innerhtml = document.getElementById("testTable").innerHTML; var document_print = window.open("Loading.htm", "", display_setting); document_print.document.open(); document_print.document.write('&lt;html&gt;&lt;head&gt;&lt;title&gt;Print&lt;/title&gt;&lt;/head&gt;'); document_print.document.write('&lt;body style="font-family:verdana; font-size:12px;" onLoad="self.print();self.close();" &gt;'); document_print.document.write(content_innerhtml); document_print.document.write('&lt;/body&gt;&lt;/html&gt;'); document_print.print(); document_print.document.close(); return false; } </code></pre> <p>I get "Access Denied" when the script tries to write to the new window. The Loading.htm file is just a very slim html document writing out the text "Loading...". I had hoped this would work after reading this thread: <a href="http://stackoverflow.com/questions/735136/ie-6-7-access-denied-trying-to-access-a-popup-window-document">IE 6/7 Access Denied trying to access a popup window.document</a></p> <p>Anybody can help?</p>
<p>Could you not simply <code>.write()</code> the "Loading" markup after creating an empty (<code>window.open("", ...)</code>) popup?</p> <p>It would avoid a trip to the server, seem more responsive to the user and solve your problem.</p> <p><strong>Edit</strong> In-fact, as your just shuffling data about on the client side, does the time it takes to render the HTML really warrant a loading banner?</p>
<p>If you want a new, empty popup window to write into, the usual approach is use an empty string for the URL:</p> <pre><code>window.open('', '_blank', features) </code></pre> <p>There's no point trying to open HTML from the server when you're immediately going to replace all the content before it's even had a chance to load. (Your empty window name <code>""</code> may also cause problems.)</p> <p>However, this is in any case not a good way to implement a “print version” of a page. Instead, use a <a href="http://www.alistapart.com/articles/goingtoprint/" rel="nofollow noreferrer">print stylesheet</a> which hides all but the contents of <code>testTable</code>.</p>