Javascript: Get the Index Value from an Array
<p>This is for a Java script course that Im taking...</p> <p>I need to create a simple user-login script. When the page loads a prompt pops up asking for the user name. If the correct username is entered, another prompt is displayed asking for a password.</p> <p>If both the username and valid, then you a sucessful message, otherwise you get a failure message.</p> <p>I've written all of the code, but am having trouble with validating the username and password. You can see in my code that I'm using two array lists. One for users and another for passwords. When I run my code, if I type in the correct username and password for user1, it validates, BUT if I enter user1 and the password for user2, it still validates.</p> <pre><code>&lt;script type="text/javascript"&gt; //Input from user var userId = prompt("Enter UserID", ""); userId_lowercase = userId.toLowerCase(); //Username and Password Arrays var userIdList = new Array(); userIdList[0] = "user1"; userIdList[1] = "user2"; userIdList[2] = "user3"; var passwordList = new Array(); passwordList[0] = "pass1"; passwordList[1] = "pass2"; passwordList[2] = "pass3"; //Process input and check for authentication //Check for correct userId var userIdFound; for (index in userIdList) { if (userId_lowercase == userIdList[index]) { userIdFound = "Y"; break; } } if (userIdFound == "Y") { document.write("&lt;p&gt;" + userId + " was Found&lt;/p&gt;"); ; //Check for correct Password var password = prompt("Enter Password", ""); var passwordFound; for (index in passwordList) { if (password == passwordList[index]) // This is where I need help, // how do I say // "if password is from the passwordList &amp;&amp; it matches the userId index selected" { passwordFound = "Y"; break; } } if (passwordFound == "Y") { document.write("&lt;p&gt;Welcome to the class!&lt;/p&gt;"); } else { document.write("&lt;p&gt;Error: Password is not valid.&lt;/p&gt;"); }//END Password Check } else { document.write("&lt;p&gt;" + userId + " was NOT found&lt;/p&gt;"); }//END USERID Check &lt;/script&gt; </code></pre>
<p>Rather than using arrays, use objects as associative arrays:</p> <pre><code>var Users = { root: 'god', fred: 'derf', luser: 'password' }; // you can access object properties using dot syntax: User.root // or using array syntax with a string as index User['root']; // when the name is stored in a variable, array syntax is the only option var name='root'; User[name]; </code></pre> <p>It's a good thing this is homework, otherwise I'd have to smack you with a board of cluefulness due to the inherent insecurity.</p> <p>You should also look into using the DOM API rather than the antiquated <code>document.write</code>.</p> <pre><code>&lt;script type="text/javascript"&gt; ... function reportLogin(msg) { var loginMsg = document.getElementById('LoginMsg'); if (loginMsg.firstChild) { loginMsg.firstChild.nodeValue=msg; } else { loginMsg.appendChild(document.createTextNode(msg)) } } &lt;/script&gt; ... &lt;p id="LoginMsg"&gt;&lt;/p&gt; </code></pre> <p>or</p> <pre><code>&lt;script type="text/javascript"&gt; ... function reportLogin(msg) { document.getElementById('LoginMsg').firstChild.nodeValue=msg; } &lt;/script&gt; ... &lt;p id="LoginMsg"&gt; &lt;/p&gt; </code></pre> <p>(Note the space in <code>#LoginMsg</code>.)</p>
<p>You will need to check the index of the username against the password. Once you have the username save that index to a variable say indexOfUserName and check that index against your password array. So instead of if (password == passwordList[index]) check if (password == passwordList[indexOfUserName]) </p>
<p>Here is where I would use a hash table (associative array)</p> <pre><code>var users = { user1:"pass1", user2:"pass2", user3:"pass3" }; </code></pre> <p>Now you can test like this:</p> <pre><code>function checkValidUser(userId, userPwd) { return ( users[userId] == userPwd ); } </code></pre> <p>Very simple.</p>
<p>First of all, I wouldn't use for-in, I'd use a simple for loop to iterate over the array. Then you could store the index that matches the user name to compare it to the password array:</p> <pre><code>var index; var userIndex; for (index = 0; index &lt; userIdList.length; index++) { if (userId_lowercase == userIdList[index]) { userIndex = index; userIdFound = "Y"; break; } } </code></pre> <p>Then, in your password loop you'd say:</p> <pre><code>if (password == passwordList[index] &amp;&amp; index == userIndex) { passwordFound = "Y"; break; } </code></pre> <p>That's the simple way around the problem. I don't know how much you've learned but you could also use an array of objects:</p> <pre><code>var userLogins = [{user:"user1", password:"pass1"},...etc]; </code></pre> <p>And then loop through that array once after asking for the name and password and seeing if they match:</p> <pre><code>for (index = 0; index &lt; userLogins.length; index++) { if (userLogins.user == userId_lowercase &amp;&amp; userLogins.password == password) { //Do stuff here } } </code></pre> <p>The thing to keep in mind is that you have to link the user name to the password somehow. The way you're currently doing this is by the index in both arrays, but that isn't guaranteed. It'd be much better to link the two bits of information in some way, as in the array of objects above.</p>
<p>If you want to make your teacher regrets her question, here's a special version:</p> <pre><code> var users = { user1:true, user2:true, user3:true }, pwds = {user1:'pw1', user2:'pw2', user3:'pw3'}; function theUser(userId){ return { hasThePassword:function(pwd){ return users[userId] &amp;&amp; pwds[userId] === pwd; } }; } if( theUser( prompt('Enter UserID', '') ).hasThePassword( prompt('Enter Password', '') )){ alert('user ok'); }else{ alert('wrong user or password'); }; </code></pre> <p>;-)</p>