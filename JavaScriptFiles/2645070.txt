Javascript function working strangely during the first call in CHROME?
<p>HI all,</p> <p>Below mentioned javascript code works fine in all browsers including chrome(from second call onwards). </p> <pre><code>function call(val){ url = window.location.href; indexnum = url.lastIndexOf("/"); str = url.slice(indexnum+1); window.location.href = url.replace(str, "sample.php?src_q=") + val; } </code></pre> <p>I am calling this function on onclick of a link as below</p> <pre><code>&lt;?php echo "&lt;a href='#' onclick='javascript:call(\"$fieldvalue\");'&gt;$fieldvalue&lt;/a&gt;" ?&gt; </code></pre> <p>Normal Behaviour : In all browser after clicking on the link new formed url is </p> <p>url://localhost/mysite/sample.php?src_q=val</p> <p>Strange Behaviour : When I click on the link for the first time in chrome value of variable <code>val</code> gets replaced by url and its value as follows</p> <p><a href="http://localhost/mysite/sample.php?src_q=http://localhost/mysite/val" rel="nofollow noreferrer">http://localhost/mysite/sample.php?src_q=http://localhost/mysite/val</a></p> <p>This strange behaviour happens during the first click in chrome. From the second call onwards in the same tab, the value of variable <code>val</code> works fine and I get desired url.</p> <p>I tried to google on it, but couldn't found any explanation. </p> <p>Thanks in advance.</p>
<p>A couple of things:</p> <ol> <li><p>Drop the "javascript:" from the beginning of the <code>onclick</code>. You'd use that in an <code>href</code>, not in an <code>onclick</code>.</p></li> <li><p>You might want to cancel navigation when the user clicks the link, by returning <code>false</code>:</p> <pre><code>onclick='callSearch2(...); return false;' </code></pre></li> </ol>