Javascript: Hijack Copy?
<p>I was just reading the Times online and I wanted to copy a bit of text from the article and IM it to a friend, but I noticed when I did so, it automatically appended the link back to the article in what I had copied. </p> <p>This is not a feature of my IM client, so I assume this happened because of some javascript on Times website.</p> <p>How would I accomplish this if I wanted to implement it on my site? Basically, I would have to hijack the copy operation and append the URL of the article to the end of the copied content, right? Thoughts?</p> <p>Here's the article I was reading, for reference: <a href="http://www.time.com/time/health/article/0,8599,1914857,00.html" rel="nofollow noreferrer">http://www.time.com/time/health/article/0,8599,1914857,00.html</a></p>
<p>What browser are you using (and what version)?</p> <p>In some newer browsers, the user is either asked if a website can access the clipboard, or its simply not allowed. In other browsers (IE 6, for example), it is allowed, and websites can easily read from and write to your copy clipboard.</p> <p>Here is the code (IE only)</p> <pre><code>clipboardData.setData("Text", "I just put this in the clipboard using JavaScript"); </code></pre>
<p>It's a breeze with jQuery (which your referenced site is using):</p> <pre><code>$("body").bind('copy', function(e) { // The user is copying something }); </code></pre> <p>You can use the jQuery Search &amp; Share Plugin which does this <em>exact</em> thing whenever somebody copies more than 40 chars from your site: <a href="http://www.latentmotion.com/search-and-share/" rel="nofollow noreferrer">http://www.latentmotion.com/search-and-share/</a></p> <p>The site that you referenced is apparently using a service called <a href="http://www.tynt.com/" rel="nofollow noreferrer">Tynt Insight</a> to accomplish this though.</p>
<p>They are using the free service <a href="http://www.tynt.com/" rel="nofollow noreferrer">Tynt</a>. If you want to accomplish the same thing, just use the same service.</p>
<p>The "Copy &amp; Paste Hijacker" jQuery plugin does exactly what you want and seems better suited for your purposes than Tynt or Search &amp; Share: <a href="http://plugins.jquery.com/project/copypaste" rel="nofollow">http://plugins.jquery.com/project/copypaste</a></p> <p>You can easily format the copied content, specify max or min characters, and easily include the title of the page or the URL in the copied content exactly where you want.</p>
<p>I recently noticed this on another website and wrote a <a href="http://joeba.in/joebain/Javascript%20Copy%20Hijack" rel="nofollow">blog post</a> on how it works. The jQuery example doesn't seem to actually modify what the user copies and pastes, it just adds a new context menu.</p> <p>In short:</p> <pre><code>var content = document.getElementById("content"); content.addEventListener("copy", oncopy); function oncopy() { var newEl = document.createElement("p"); document.body.appendChild(newEl); newEl.innerHTML = "In your copy, messing with your text!"; var selection = document.getSelection(); var range = selection.getRangeAt(0); selection.selectAllChildren(newEl); setTimeout(function() { newEl.parentNode.removeChild(newEl); selection.removeAllRanges(); selection.addRange(range); }, 0) } </code></pre> <p>The <code>setTimeout</code> at the end is important as it doesn't seem to work if the last part is executed immediately.</p> <p>This example <em>replaces</em> your selected text at the last minute with my chosen string. You can also grab the existing selection and append whatever you like to the end.</p>