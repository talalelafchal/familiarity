What broke in this Javascript 1.2 snippet?
<p>A friend has pointed me to his old website and says "the submit form just stopped working a while ago. I'm sure it's something simple." </p> <p>The form asks a child for a certain word from a book, and based on the answer, it should redirect the child to a success page or a failure page. It's using Javascript 1.2, circa 2001.</p> <p>You can see this form in in-action at:</p> <p><a href="http://www.secrethidingplaces.com/login1.html" rel="nofollow noreferrer">http://www.secrethidingplaces.com/login1.html</a></p> <p>Any idea why it's failing?</p> <p>The HTML does this:</p> <pre><code>&lt;script src="password.js" type="text/javascript" language="JavaScript1.2"&gt; &lt;/script&gt; &lt;script type="text/javascript" language="JavaScript1.2"&gt; &lt;!-- function showRightPage () { return window.location.href = "extra.html" ; } function showWrongPage () { return window.location.href = "sorry2.html" ; } //--&gt; &lt;/script&gt; </code></pre> <p>and then this: </p> <pre><code>document.write ( '&lt;form name="questionForm" action="javascript:checkAnswer()" method="post"&gt;' ) ; ... document.write ( '&lt;input type="text" name="userAnswer" value="" size="90"&gt;' ) ; document.write ( '&lt;INPUT TYPE="image" NAME="submit" SRC="stock/btn_send.gif" width="121" height="41" BORDER="0" ALT="submit"&gt;' ) ; document.write ( '\&lt;/p&gt;' ) ; document.write ( '\&lt;/form&gt;' ) ; </code></pre> <p>I'm assuming there's something ugly in CheckAnswer from ./password.js . I can hack the form to bypass that javascript and go straight to the success page:</p> <pre><code> document.write ( '&lt;form name="questionForm" action="extra.html" method="post"&gt;' ) ; </code></pre> <p><br/></p> <p>but I'd like to help my friend get his kids site working again. The CheckAnswer function is below. Is something going wrong in here?</p> <pre><code>function checkAnswer () { currentAnswer = answersArray [ choiceNumber ] ; if (agt.indexOf("msie") != -1) { rawAnswer = document.questionForm.userAnswer.value ; } else { rawAnswer = document.callThis.document.questionForm.userAnswer.value ; } lcAnswer = rawAnswer.toLowerCase ( ) ; includedAnswer = lcAnswer.indexOf ( "currentAnswer" ) ; zadaAnswer = lcAnswer.indexOf ( "zada" ) ; brendanAnswer = lcAnswer.indexOf ( "brendan" ) ; nineAnswer = lcAnswer.indexOf ( "nine" ) ; thirtyAnswer = lcAnswer.indexOf ( "thirty" ) ; if ( choiceNumber == 0 ) { if ( includedAnswer == -1 &amp;&amp; zadaAnswer == -1 &amp;&amp; brendanAnswer == -1 ) { checked = "wrong" ; } } if ( choiceNumber == 8 ) { if ( includedAnswer == -1 &amp;&amp; zadaAnswer == -1 &amp;&amp; nineAnswer == -1 ) { checked = "wrong" ; } } if ( choiceNumber == 16 ) { if ( includedAnswer == -1 &amp;&amp; zadaAnswer == -1 &amp;&amp; thirtyAnswer == -1 ) { checked = "wrong" ; } } if ( choiceNumber != 0 &amp;&amp; choiceNumber != 8 &amp;&amp; choiceNumber != 16 ) { if ( includedAnswer == -1 &amp;&amp; zadaAnswer == -1 ) { checked = "wrong" ; } } if ( checked == "wrong" ) { showWrongPage () ; } else { showRightPage () ; } } </code></pre> <p><br/> <b>Thanks!</b></p>
<p>It fails here: </p> <p>document.callThis.document.questionForm.userAnswer.value ;</p> <p>document.callThis is undefined, I have never seen that function.</p> <p>You can probably replace</p> <pre><code>if (agt.indexOf("msie") != -1) { rawAnswer = document.questionForm.userAnswer.value ; } else { rawAnswer = document.callThis.document.questionForm.userAnswer.value ; } </code></pre> <p>Simply replace it with:</p> <p>rawAnswer = document.questionForm.userAnswer.value ;</p> <p>I only tested this quickly in Firefox but I don't see why it wouldn't work elsewhere.</p>
<p>First answer is right. 'callThis' doesn't exist anywhere that I know of. I imagine it was some old netscape thing.</p> <p>I never do form access by name, but that javascript looks like it should work. The alternate version would be like:</p> <p>rawAnswer = document.getElementsByName('userAnswer')[0];</p>