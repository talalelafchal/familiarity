How to config IE to make &quot;wscript.shell&quot; work
<p>I have some code that used to work. But I today when I try it again. I kept got "[object error]".</p> <p>I thought it's the problem of IE safety configure. But I can find how to config IE to make it work.</p> <pre><code>function Run() { try { var objShell = new ActiveXObject("wscript.shell"); objShell.Run("calc"); } catch(e) { alert(e); } } </code></pre>
<p>You must enable ActiveX:</p> <ul> <li>Click on <em>Tools</em></li> <li>Select <em>Internet Options...</em></li> <li>Select <em>Security</em> tab.</li> <li>Select Internet in Web content zone.</li> <li>Then, click on <em>Custom Level...</em></li> <li>Go through all the ActiveX setting there, select <em>Prompt</em> or <em>Enable</em></li> </ul>
<p>it is Case Sensitive !!</p> <pre><code>&lt;html&gt; &lt;head&gt; &lt;script language="javascript" type="text/javascript"&gt; function OpenFile(){ alert ('Work'); var x = new ActiveXObject("WScript.Shell"); x.run('calc.exe'); } &lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;input type="button" value="GG" href="#" onclick="javascript:OpenFile();"&gt; &lt;/body&gt; &lt;/html&gt; </code></pre>
<p>It may be necessary to make a change to the IE settings:</p> <p>For example, for the Local intranet zone, you typically need to change a custom setting to "Initialize and script ActiveX controls not marked as safe for scripting."</p> <p>I couldn't get the sample above to run without making the change.</p>