Microsoft JScript runtime error: Object required
<p>I wrote a simple javascript function for validating to fields in a aspx page</p> <pre><code>function validate() { if (document.getElementById("&lt;%=tbName.ClientID%&gt;").value=="") { alert("Name Feild can not be blank"); document.getElementById("&lt;%=tbName.ClientID%&gt;").focus(); return false; } if (document.getElementById("&lt;%=ddlBranch.ClientID%&gt;").value=="SelectBranch") { alert("Branch Should Be Selected"); document.getElementById("&lt;%=ddlBranch.ClientID%&gt;").focus(); return false; } } </code></pre> <p>Everything worked fine. Later I linked it to aspx page like a external js file.</p> <p>head runat="server"></p> <p>script src="validation.js" type="text/javascript"> </p> <p>/script></p> <pre><code>&lt;title&gt;Validations&lt;/title&gt; </code></pre> <p>/head></p> <p></p> <pre><code>&lt;form id="form" runat="server"&gt; &lt;asp:Label ID="lblName" runat="server" Text="Nmae: "&gt;/asp:Label&gt; &lt;asp:TextBox ID="tbName" runat="server" Width="130px"&gt;/asp:TextBox&gt; &lt;asp:Label ID="lblBranch" runat="server" Text="Branch:"&gt;/asp:Label&gt; &lt;asp:DropDownList ID="ddlBranch" runat="server" Width="107px"&gt; &lt;asp:ListItem&gt;CSE&lt;/asp:ListItem&gt; &lt;asp:ListItem&gt;ECE&lt;/asp:ListItem&gt; &lt;asp:ListItem&gt;CIVIL&lt;/asp:ListItem&gt; &lt;asp:ListItem&gt;MECH&lt;/asp:ListItem&gt; &lt;asp:ListItem Selected="True" Value="SelectBranch"&gt;SelectBranch&lt;/asp:ListItem&gt; &lt;/asp:DropDownList&gt; &lt;asp:Button ID="btnSubmit" runat="server" Text="Submit" OnClientClick="return validate(&lt;%=tbName.ClientID%&gt;, &lt;%=ddlBranch.ClientID%&gt;)" /&gt; &lt;/form&gt; </code></pre> <p> and</p> <p>In aspx.cs page</p> <p>protected void Page_Load(object sender, EventArgs e)</p> <pre><code>{ Page.RegisterClientScriptBlock("MyScript", "&lt;SCRIPT Language='JavaScript' src='validation.js'&gt;&lt;/SCRIPT&gt;"); btnSubmit.Attributes.Add("onclick", "return validate()"); } </code></pre> <p>Now its giving error "Microsoft JScript runtime error: Object required".</p> <p>I'm unable to know where I went wrong.</p>
<p>Your script can only run <strong>inside</strong> the aspx page as it is. <code>&lt;%=tbName.ClientID%&gt;</code> is server-side logic it's placing the literal client-side ID in the output to the client, so before it looked like this when rendered in the HTML:</p> <pre><code>document.getElementById("tbName") //looks for &lt;input id="tbName" /&gt; </code></pre> <p>Now it looks <strong>just</strong> like this:</p> <pre><code>document.getElementById("&lt;%=tbName.ClientID%&gt;") //looks for &lt;input id="&lt;%=tbName.ClientID%&gt;" /&gt; ... doesn't exist :) </code></pre> <p>Since it's no longer finding an object/element (because <em>that</em> ID doesn't exist) you're getting the <code>object required</code> error. You have to either keep this logic in the page, or move to some other approach using classes, etc. If you're doing a lot of validation, I'd take a look at <a href="http://jquery.com/" rel="nofollow noreferrer">jQuery</a> and the <a href="http://bassistance.de/jquery-plugins/jquery-plugin-validation/" rel="nofollow noreferrer">validation library</a>.</p> <hr> <p><strong>Update:</strong> Here's the solution <a href="http://stackoverflow.com/users/157247/t-j-crowder">T.J.</a> provided for you in comments in full text form for an easier read. If you're only validating a few fields, this is the simplest fix to your situation:</p> <pre><code>function validate(nameId, branchId) { if (document.getElementById(nameId).value=="") { alert("Name Feild can not be blank"); document.getElementById(nameId).focus(); return false; } if (document.getElementById(branchId).value=="SelectBranch") { alert("Branch Should Be Selected"); document.getElementById(branchId).focus(); return false; } } </code></pre> <p>In your code-behind:</p> <pre><code>//Note your current method is deprecated after .Net 2.0+, should use this instead: //ClientScript.RegisterClientScriptInclude("validation", "validation.js"); Page.RegisterClientScriptBlock("MyScript", "&lt;script type='text/javascript' src='validation.js'&gt;&lt;/script&gt;"); btnSubmit.Attributes.Add("onclick", string.Format("return validate('{0}','{1}')", tbName.ClientID, ddlBranch.ClientID)); </code></pre>
<p>give the object you want to reference a html id which would output like</p> <pre><code>&lt;div id="myid"&gt;&lt;/div&gt; </code></pre> <p>than you can reference it by</p> <pre><code>document.getElementById("myid") </code></pre>