Why is this ASP Script not working?
<p>Could you tell me whats wrong with this ASP script:</p> <p>I think the error is in the <code>if</code> statement</p> <pre><code>&lt;script&gt; productID=new Array() variaveis=location.search.replace(/\x3F/,"").replace(/\x2B/g," ").split("&amp;") if(variaveis!=""){ for(i=0;i&lt;variaveis.length;i++){ nvar=variaveis[i].split("=") productID[nvar[0]]=unescape(nvar[1]) } } function QueryString(variavel){ return productID[variavel] } document.writeln (QueryString("c")); var flash = (QueryString("c")); if (flash = "flash1") { document.write("&lt;b&gt;flash1&lt;/b&gt;"); } else if (flash = "flash2") { document.write("&lt;b&gt;flash2&lt;/b&gt;"); } else { document.write("&lt;b&gt;another&lt;/b&gt;"); } &lt;/script&gt; </code></pre>
<p>Replace</p> <pre><code>if (flash = "flash1") </code></pre> <p>with</p> <pre><code>if (flash == "flash1") </code></pre> <p>etc.</p> <p>A single <code>=</code> is for assignment, not for testing equality. <a href="http://if" title="flash = &quot;flash1&quot;">JSLint</a> is a great tool for picking up these kinds of errors:</p> <pre><code>Error: Problem at line 1 character 20: Use the array literal notation []. productID=new Array() Problem at line 1 character 22: Missing semicolon. productID=new Array() Problem at line 2 character 77: Missing semicolon. variaveis=location.search.replace(/\x3F/,"").replace(/\x2B/g," ").split("&amp;") Problem at line 5 character 33: Missing semicolon. nvar=variaveis[i].split("=") Problem at line 6 character 41: Missing semicolon. productID[nvar[0]]=unescape(nvar[1]) Problem at line 11 character 29: Missing semicolon. return productID[variavel] Problem at line 16 character 11: Expected a conditional expression and instead saw an assignment. if (flash = "flash1") Problem at line 20 character 16: Expected a conditional expression and instead saw an assignment. else if (flash = "flash2") Implied global: productID 1,6,11, variaveis 2,3,4,5, i 4,5, nvar 5,6, unescape 6 </code></pre>