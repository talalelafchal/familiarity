How do templating engines in JavaScript work?
<p>Could you please explain me, how do templating engines in JavaScript work? Thank you.</p> <p><strong>JSON</strong></p> <pre><code>{ "color" : "red"} </code></pre> <p><strong>Template</strong></p> <pre><code>&lt;strong&gt;&lt;%=color%&gt;&lt;/strong&gt; </code></pre> <p><strong>Result</strong></p> <pre><code>&lt;strong&gt;Red&lt;/strong&gt; </code></pre>
<p>They may vary by implementation, but the one you're talking about looks like it works by doing the following:</p> <ol> <li><p>Parse the page looking for keys in <code>&lt;%= %&gt;</code> tags</p></li> <li><p>Match the key to the key/value pair in the JSON </p></li> <li><p>Replace the tags/key with the value.</p></li> </ol>
<p>As a starting point I would recommend you to give a look to the <code>String.prototype.replace</code> method and specially using its callback function:</p> <pre><code>function replaceTokens(str, replacement) { return str.replace(/&lt;\%=([^%&gt;]+)\%&gt;/g, function (str, match) { return replacement[match]; }); } var input = "&lt;strong&gt;&lt;%=color%&gt;&lt;/strong&gt;"; replaceTokens(input, { "color" : "Red"}); // returns &lt;strong&gt;Red&lt;/strong&gt; replaceTokens("&lt;%=var1%&gt; &lt;%=var2%&gt;", { "var1" : "Hello", "var2": "world!"}); // returns "Hello world!" </code></pre> <p>Give a look to these articles:</p> <ul> <li><a href="http://ejohn.org/blog/search-and-dont-replace/" rel="nofollow noreferrer">Search and Don't Replace</a></li> <li><a href="http://ejohn.org/blog/javascript-micro-templating/" rel="nofollow noreferrer">John Resig's Micro-Templating Engine</a></li> <li><a href="http://blog.markturansky.com/BetterJavascriptTemplates.html" rel="nofollow noreferrer">Better JavaScript Templates</a> (JSP-like syntax)</li> <li><a href="http://wiki.github.com/nje/jquery/jquery-templates-proposal" rel="nofollow noreferrer">jQuery Templates Proposal</a></li> </ul>
<p>It's not very different from other templating solutions (at the conceptual level).</p> <pre><code>{ "color" : "red"} </code></pre> <p>Specifies a <code>color</code> attribute with the value <code>red</code>.</p> <pre><code>&lt;strong&gt;&lt;%=color%&gt;&lt;/strong&gt; </code></pre> <p>Means "Use the value of <code>color</code> wherever I have <code>&lt;%=color%&gt;</code>. Based on wahat you have, the templating-engine probably walks the DOM and finds nodes that have values that match <code>&lt;%=somestring%&gt;</code>. Then, it checks to see if there is an attribute that matches the <code>somestring</code> value. If there is one, it replaces the value of <code>&lt;%=somestring%&gt;</code> with the value defined in the JSON (which, in this case is <code>red</code>).</p> <p>This finally gives you:</p> <pre><code>&lt;strong&gt;Red&lt;/strong&gt; </code></pre>