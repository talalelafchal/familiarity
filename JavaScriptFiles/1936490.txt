xmlhttp request in javascript file causing errors
<p>I have a javascript file which has some code somewhat like this:</p> <pre><code>var Slide = { init: function() { var thumbs = new Array(); thumbs = Core.getElementsByClass("thumb-img"); var i; for (i=0; i&lt;thumbs.length; i++) { Core.addEventListener(thumbs[i], "click", (function( j){return function(){Slide.showImage(j);/*alert(j);*/};})(i)); } }, </code></pre> <p>Now, I am trying to pass xmlhttp objects in this javascript file. I am adding the following just above the <code>init: function()</code>...</p> <pre><code>var xmlhttp; function getVote(int) { xmlhttp=GetXmlHttpObject(); if (xmlhttp==null) { alert ("Browser does not support HTTP Request"); return; } var value = int; alert(value); var url="user_submit.php"; url=url+"?vote="+int; url=url+"&amp;sid="+Math.random(); xmlhttp.onreadystatechange=stateChanged; xmlhttp.open("GET",url,true); xmlhttp.send(null); } function stateChanged() { if (xmlhttp.readyState==4) { document.getElementById("captionbox").innerHTML=xmlhttp.responseText; } } function GetXmlHttpObject() { var objXMLHttp=null; if (window.XMLHttpRequest) { objXMLHttp=new XMLHttpRequest(); } else if (window.ActiveXObject) { objXMLHttp=new ActiveXObject("Microsoft.XMLHTTP"); } return objXMLHttp; } </code></pre> <p>...but firebug gives me error: <code>missing : after property id var xmlhttp;\n</code></p> <p>What am I doing wrong?</p>
<p>That's invalid syntax - you can't have code just floating around in an object. The easiest way to do that would be to just move that code outside the Object.</p> <p>A better way would be to have a function <code>initXhr()</code>, which is called by <code>init()</code>. That would contain the same code as you tried to put before <code>init</code>. Then, add at the end:</p> <pre><code>this.xmlHttp = xmlHttp; </code></pre> <p>Then, in other functions, use <code>this.xmlHttp</code>.</p>
<p>It looks like you're putting normal Javascript inside an object block.</p> <p>Move the XMLHTTP code block above the line <code>var Slide =</code>.</p> <p>If this doesn't help, please show us the entire file.</p>