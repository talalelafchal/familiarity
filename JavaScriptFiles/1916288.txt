Get URL parameters and insert into form action url with javascript
<p>I have an html page that people access using an affiliate link, so it has affiliate code in the url (<a href="http://www.site.com?cmpid=1234&amp;aid=123" rel="nofollow noreferrer">http://www.site.com?cmpid=1234&amp;aid=123</a>). I want to add the cmpid and the aid to the form action url (so when submitted, it submits to the url /form.aspx but adds the cmpid and aid to the end, ie: form.aspx?cmpid=1234&amp;aid=123). </p> <p>I have no other option than javascript. I can't make this page php or aspx. </p>
<pre><code>window.onload = function() { var frm = document.forms[0]; frm.action = frm.action + location.search; } </code></pre>
<p>You can get access to the query string by <code>location.search</code>. Then you should be able to append it onto the form's action directly, something like the following:</p> <pre><code>// Get a reference to the form however, such as document.getElementById var form = ...; // Get the query string, stripping off the question mark (not strictly necessary // as it gets added back on below but makes manipulation much easier) var query = location.search.substring(1); // Highly recommended that you validate parameters for sanity before blindly appending // Now append them var existingAction = form.getAttribute("action"); form.setAttribute("action", existingAction + '?' + query); </code></pre> <p>By the way, I've found that modifying the query string of the form's action directly can be hit-and-miss - I think in particular, IE will trim off any query if you're POSTing the results. (This was a while ago and I can't remember the <em>exact</em> combination of factors, but suffice to say it's not a great idea).</p> <p>Thus you <em>may</em> want to do this by dynamically creating child elements of the <code>&lt;form&gt;</code> that are hidden inputs, to encode the desired name-value pairs from the query.</p>