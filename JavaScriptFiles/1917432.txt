why do my select boxes reset after appending a new one?
<p>For once, I am getting the intended results in IE6, but not FF (or Chrome). </p> <p>I have a select box (listing locations) which is dynamically generated using JS. I have a button that allows the user to add more of the select boxes, so they can choose more than one location.</p> <p>When the JS code adds the new select box, the already present select boxes get 'reset'. ex: I choose an option on the first select box, click the button to add a new select box, a new select box is added and shows the first option, but my first select box 'resets' to the first option as well, opposed to the option I had already selected.</p> <p>It's like the page is refreshing, but it's not.</p> <p>I don't know what wrong, I've already tried assigning unique ID's to each box to no prevail. Here is the code:</p> <p>HTML:</p> <pre><code>&lt;!-- BEGIN select location box - "slb" --&gt; &lt;div id="selectLocationBox"&gt; &lt;div id="slb_top"&gt; select location(s) you wish to view results for: &lt;/div&gt; &lt;div id="slb_mid"&gt; &lt;script language="javascript"&gt; add_LocationBar() &lt;/script&gt; &lt;/div&gt; &lt;div id="slb_bot"&gt; &lt;a onclick="add_LocationBar()"&gt;add another location&lt;/a&gt; &lt;input id="loc_hiddenInpt" type="hidden" runat="server" /&gt; &lt;!-- this hidden input box is used to save the part of query dealing with locations, JS will check any location drop down boxes and then put applicable part of query in this hidden input so ASP page can use it --&gt; &lt;/div&gt; &lt;/div&gt; &lt;!-- END select location box - "slb" --&gt; </code></pre> <p>JS CODE:</p> <pre><code>function add_LocationBar() { //create and populate array var ary_locations = new Array("SELECT", "--select--", "ABE", "Aberdeen, Scotland", "ABU", "Abu Dhabi, United Arab Emirates", "AAB", "Addis Ababa, Ethiopia", "ADD", "Addlestone, United Kingdom", "AKA", "Akasaka, Japan", "ALB", "Al Bidah, Kuwait", "ABA", "Albacete, Spain"); //create select drop down box var loc_select = document.createElement("select"); //populate select box with options from array for (var c = 0; c &lt; ary_locations.length; c=c+2) { var opt1 = document.createElement("option"); opt1.value = ary_locations[c] opt1.text = ary_locations[c+1] loc_select.options.add(opt1); } //add drop down to box document.getElementById("slb_mid").appendChild(loc_select); document.getElementById("slb_mid").innerHTML += "&lt;br /&gt;" } </code></pre> <p>Thank you in advance for any help/insight you can provide!</p>
<p>It appears that the problem occurs when you use innerHTML to add the line break. Try using appendChild again like below</p> <pre><code>document.getElementById("slb_mid").appendChild(loc_select); document.getElementById("slb_mid").appendChild(document.createElement("br")) </code></pre> <p>As far as I can tell the browser's innerHTML value is not up to date with the current selection for some reason. So the browser grabs the current value of innerHTML, appends <code>&lt;br/&gt;</code> and refreshes the element, erasing your selection. This should get you around it though.</p>