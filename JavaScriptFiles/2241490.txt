Google AJAX API Loader
<p>I am having a problem loading the Google AJAX APIs in response to user input instead of when the page loads. </p> <p>This works: </p> <pre><code>&lt;script type="text/javascript" src="http://www.google.com/jsapi"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; google.load("search", "1"); google.setOnLoadCallback(function() { alert("loaded"); }); &lt;/script&gt; </code></pre> <p>But this doesn't: </p> <pre><code>&lt;script type="text/javascript" src="http://www.google.com/jsapi"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; function clicked() { google.load("search", "1"); google.setOnLoadCallback(function() { alert("loaded"); }); } &lt;/script&gt; </code></pre> <p>The <strong>clicked</strong> function is a handler for a simple link. </p> <p>Does anyone know why?</p>
<p>Based on the IE Response, it may be the case that the Google AJAX APIs haven't loaded by the time you click the button, therefore the "google" object is undefined. </p> <p>Try this (<a href="http://code.google.com/apis/ajax/documentation/" rel="nofollow noreferrer">http://code.google.com/apis/ajax/documentation/</a>):</p> <pre><code>function mapsLoaded() { var map = new google.maps.Map2(document.getElementById("map")); map.setCenter(new google.maps.LatLng(37.4419, -122.1419), 13); } function loadMaps() { google.load("maps", "2", {"callback" : mapsLoaded}); } function initLoader() { var script = document.createElement("script"); script.src = "http://www.google.com/jsapi?key=ABCDEFG&amp;callback=loadMaps"; script.type = "text/javascript"; document.getElementsByTagName("head")[0].appendChild(script); } </code></pre>