Access Local Files with Local Javascript
<p>Based on the other answers on this site, I already feel like I know the answer to this question, but, as it's slightly different, I wanted to ask.</p> <p>Is it possible to access local files from JavaScript that is running locally on the machine (AKA, my website address will be file:///C:/...)? Or, is this sandboxed as well? </p> <p>What I am trying to do: I have a standalone computer that I want people to be able to drop in JSON or XML files into a local folder which are read in at the creation of the site and used to generate a single web page. If the JavaScript solution is not possible, can you provide any other suggestions?</p> <p>Thank you.</p>
<p>You could read the files using just an Ajax request, as though it was to the server. But you have to know the name of the file, and you can't write files.</p>
<p>Yes, although insecure, you can use:</p> <pre><code>fopen("c:\\MyFile.txt", 'r'); </code></pre>
<p>You should consider some sort of server side scripting language such a <a href="http://php.net/index.php" rel="nofollow noreferrer">PHP</a>, <a href="http://www.perl.org/" rel="nofollow noreferrer">Perl</a>, <a href="http://java.sun.com/products/jsp/" rel="nofollow noreferrer">JSP</a> or some form of <a href="http://en.wikipedia.org/wiki/Server-side_JavaScript" rel="nofollow noreferrer">SSJS</a>.</p>
<p>If you make an hypertext application page (.hta) instead of an HTML page (.htm/.html), then you have full access to the file system, using the FileSystemObject object.</p> <p>(Well, limited by the file access of the user account that is running the browser, of course.)</p>
<p>This will only work on IE, but if that is not a problem for you, here is some sample code to write to a file:</p> <pre><code> var fso, s; fso = new ActiveXObject("Scripting.FileSystemObject"); s = fso.OpenTextFile("c:\\path\\to\\myfile.txt" , 8, 1, -2); s.writeline("Hello World"); s.Close(); </code></pre> <p>And then to read from it:</p> <pre><code>f = fso.OpenTextFile(filename, ForReading); while (!f.AtEndOfStream) { var r = f.ReadLine(); document.write (r + "&lt;br /&gt;"); } f.Close(); </code></pre> <p>For more information about OpenTextFile, check out: <a href="http://msdn.microsoft.com/en-us/library/314cz14s(VS.85).aspx" rel="nofollow noreferrer">http://msdn.microsoft.com/en-us/library/314cz14s(VS.85).aspx</a></p>
<p>A webpage can read any file on the same server as it was loaded from (this is the cross-site policy of JavaScript). That means that the page file:///C:/mywebsite/index.html can read the file file://C:/somedir/somefile.xml. To read this file, either use ajax, load it in an iFrame or load it as a javascript or css file. </p> <p>Several browsers support custom methods for loading local file (and other interesting things), IE has activeX and Firefox has XPCOM.</p>
<p>According to <a href="https://developer.mozilla.org/En/Using_XMLHttpRequest" rel="nofollow noreferrer">the Firefox documentation</a>, the following code will work:</p> <pre><code>var req = new XMLHttpRequest(); req.open('GET', 'file:///home/user/file.json', false); req.send(null); if(req.status == 0) dump(req.responseText); </code></pre> <p>I seem to recall it only works within the same directory as the HTML page. And I don't know if this will work in other browsers.</p>
<p>If people are to drop a json string in to a folder, you could just have it be a plain text file, then use an AJAX call to the file name, just like you would point it to a php/asp script. I do this all the time for testing of pages before I have the backend done.</p> <p>I.E. if your page were C:\foo\index.html, you could have them drop to C:\foo\putyourstuff\json.txt here and run an AJAX call "putyourstuffhere/json.txt".</p>
<p><strong>IF</strong> the user grants your webpage permission to access those files, and <strong>IF</strong> they are located on the same machine as the webpage, then there is nothing preventing you from gaining <em>Read Only</em> access to files on the machine via JavaScript.</p>
<p>This worked for me in Firefox...</p> <p>Adapted code from this site: <a href="http://www.h-online.com/security/services/Firefox-Mozilla-Demo-Reading-local-files-via-local-HTML-files-761851.html" rel="nofollow">http://www.h-online.com/security/services/Firefox-Mozilla-Demo-Reading-local-files-via-local-HTML-files-761851.html</a></p> <pre><code>&lt;HTML&gt; &lt;BODY onLoad="ReadFileContent()" &gt; &lt;iframe id="local_file" name="local_file" src="file:///C:/test.txt" height=0 width=0&gt; &lt;/iframe&gt; &lt;script&gt; function ReadFileContent(){ alert(local_file.document.firstChild.innerHTML); } &lt;/script&gt; &lt;h2&gt;Read Local File&lt;/h2&gt; &lt;P&gt; If a window displays the content of your local file C:\test.txt the demo worked. If no additional window appears, it failed. You can close this window now.&lt;/p&gt; &lt;/body&gt; &lt;/html&gt; </code></pre>