Invalid argument in IE
<p>I love IE :)</p> <p>OK, so I've downloaded a scrip called TinySlidshow (<a href="http://www.leigeber.com/2008/12/javascript-slideshow/" rel="nofollow noreferrer">http://www.leigeber.com/2008/12/javascript-slideshow/</a>) works perfectly in FF then I tried IE and boom got an invalid argument error on like 160.</p> <p>Here is line 160 compressed which is what it looks like by default.</p> <pre><code>if(oh==h){clearInterval(e.si)}else{if(oh!=h){e.style.height=oh+(Math.ceil(Math.abs(h-oh)/s)*hd)+'px'}} </code></pre> <p>I broke it up so I could find exactly what it was and it came down to this line:</p> <pre><code>e.style.height=oh+(Math.ceil(Math.abs(h-oh)/s)*hd)+'px' </code></pre> <p>The line above is quite a few adding/dividing and multiplying on one line so I broke that up so my ocde looked a little like this:</p> <pre><code>e.style.height = new_hight + 'px' </code></pre> <p>But it still gave me the error on the line above. I tried putting a semi-colon on the end and it didn't work either... </p> <p>The script is located here at the moment:</p> <p><a href="http://www.romarkdesign.com.au/portfolio2.html" rel="nofollow noreferrer">http://www.romarkdesign.com.au/portfolio2.html</a></p> <p>Any ideas what I need to change to make IE work?</p>
<p>Same prob here. After watching it go through the debugger a few times, I noticed the pattern of the height being set to '-1px' whenever the error popped up. </p> <p>I may have fixed it...but it <em>is</em> IE and prone to flying off the handle in spite of my good intentions. </p> <p>You need to add "if(oh&lt;2){oh=2};" after the opening bracket of the if(oh!=h) statement. </p> <p>Change:</p> <pre><code> if(oh==h){clearInterval(e.si)}else{if(oh!=h){e.style.height=oh+(Math.ceil(Math.abs(h-oh)/s)*hd)+'px'}} </code></pre> <p>to:</p> <pre><code> if(oh==h){clearInterval(e.si)}else{if(oh!=h){if(oh&lt;2){oh=2};e.style.height=oh+(Math.ceil(Math.abs(h-oh)/s)*hd)+'px'}} </code></pre> <p>The theory here is that TINY doesn't like negative 'px' values, so I set oh to 2 if it is less than 2 coming into the problem statement. This forces the statement to evaluate to 1 at it's lowest value. '1px' seems to make TINY happy in IE...so far.</p>