Dynamic function call (apply)
<p>I am trying to dynamically call a function inside of an object. Found the <a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/apply" rel="nofollow noreferrer"><code>apply</code></a> function but not fully understanding it. Check out the code below, by triggering <code>Test.checkQueue()</code> it should in turn call <code>showSomething</code> "method". Thanks.</p> <pre><code>var Test = { , queue : [{action:'showSomething', id:'1234'},{action:'showOther', id:'456'}] , showSomething: function(what) { alert(what); } , checkQueue : function() { console.log('checkQueue'); console.log(this.queue); if (this.queue.length) { var do = this.queue.shift(); console.log(do); // action.action(action.id); do.action.apply(this, do.id || []); } } }; </code></pre>
<p>The problem is that <code>do.action</code> is a string, not a function. You could change your code in one of two ways.</p> <ol> <li><p>Instead of storing the <em>name</em> of the function in your queue, actually store the function:</p> <pre><code>queue : [ { action: this.showSomething ... </code></pre> <p>You might need to make sure that it has been defined first or something like that, though.</p></li> <li><p>Resolve the string back to the actual property:</p> <pre><code>this[do.action].apply(...) </code></pre></li> </ol>
<p>There are (at least) two problems with your use of <code>apply</code> here.</p> <ol> <li><p>It is a method of a function object, and you seem to be calling it on strings</p></li> <li><p>It always takes an array as its second parameter -- you are passing in either a string or an empty array.</p></li> </ol> <p>Try calling it like this:</p> <pre><code>Test[do.action].apply(this, do.id ? [do.id] : []); </code></pre> <p>Using <code>Test[do.action]</code> will access the actual function, rather than the string "showSomething" or "showOther", and <code>do.id ? [do.id] : []</code> will always return an array.</p>