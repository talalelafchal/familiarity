execcommand(&quot;SaveAs&quot;,null,&quot;file.csv&quot;) is not working in IE8
<pre><code>var doc = w.document; doc.open('application/CSV','replace'); doc.charset = "utf-8"; doc.write("all,hello"); doc.close(); if(doc.execCommand("SaveAs",null,"file.csv")) { window.alert("saved "); }else { window.alert("cannot be saved"); } </code></pre> <p>not working in IE 8 </p> <p>but woks in IE 6</p> <p>what is the problem ? it is alerting "cannot be saved"</p> <p>help me !!! advance thanks </p>
<p>The problem seems to be caused by an old bug that was fixed in Windows XP but is apparently unpatched in my Windows 7. From <a href="http://support.microsoft.com/kb/929863" rel="nofollow noreferrer">http://support.microsoft.com/kb/929863</a>:</p> <blockquote> <p>This problem occurs because of a limitation in the <strong>ExecCommand</strong> function. When you run the script that uses the <strong>ExecCommand</strong> function together with the <strong>SaveAs</strong> command, the script can only save a file that is the text file type.</p> </blockquote> <p>Sure enough, change the file extension to ".txt" and watch it magically work in IE8.</p> <p>The only workaround that comes to mind is to have a server-side language create the CSV file, and serve it up as a download (using the <code>Content-disposition: attachment</code> header).</p>
<p>If you could do this processing server side with PHP or .NET or Java or something, in the http headers set:</p> <pre><code>Content-Disposition: attachment; filename=file.csv </code></pre> <p>Which, unfortunately you can't do from JavaScript.</p>
<p>I know this is an very old thread, but I also faced this problem. You can fix it by adding the following value (depending on the extension of the file beeing downloaded) to your registry.</p> <p>E.g. for .csv file:</p> <pre><code>Windows Registry Editor Version 5.00 [HKEY_CLASSES_ROOT\.csv] "PerceivedType"="document" </code></pre> <p>@MICROSOFT: Shame on you; problem seems to be still unpatched :-)</p>