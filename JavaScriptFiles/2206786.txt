Problem Adding VBScript Into JavaScript
<p>I am using a Datepicker on my site and want the current day (selected on page load) to advance one day forward at 2pm.</p> <pre><code>$(function() { var dd = 0 var dsc = new Date(); if (dsc.getHours() &gt; 14) { dd = dd + 1; // go one day in the future } </code></pre> <p>Works perfectly but this uses the local time on the users machine.</p> <p>So I tried this.</p> <pre><code>$(function() { var dd = 0 var dsc = ('&lt;%= currentHour %&gt;'); if (dsc &gt; 14) { dd = dd + 1; // go one day in the future } </code></pre> <p>The currentHour gets it's value from </p> <pre><code>Dim currentHour currentHour = Hour(Now) </code></pre> <p>But this won't work. Can anyone help.</p>
<p>I am assuming you are declaring <code>currentHour</code> on the server side and that it outputs correctly in the JavaScript fragment you posted.</p> <p>You don't need to put the <code>currentHour</code> in quotes and parentheses. </p> <pre><code>$(function() { var dd = 0 var dsc = &lt;%= currentHour %&gt;; if (dsc &gt; 14) { dd = dd + 1; // go one day in the future } } </code></pre> <p>You don't need the <code>dsc</code> variable either:</p> <pre><code>$(function() { var dd = 0 if (&lt;%= currentHour %&gt; &gt; 14) { dd = dd + 1; // go one day in the future } } </code></pre> <p><strong>Edit:</strong> (following the comments)</p> <p>The &lt;%= %> syntax is an asp feature that will only be processed when in an ASP page. If this is in a static JS file, it will remain as it is and not be processed.</p>