How can I convert an HTML table to a CSV file, while taking colspan and rowspan into account?
<p>I have a Perl module that constructs an HTML table within it. I need to add a button that allows me to save this table as a CSV file.</p> <p>I can figure out how to do that much of it, but I'm having some problems with formatting, namely when it comes to <code>colspan</code> and <code>rowspan</code> tags. This is causing everything to shift and mess up since it thinks there are empty columns.</p> <p>Is there away to handle the <code>colspan</code> and <code>rowspan</code> tags while converting this table to a CSV, so that the formatting stays consistent?</p>
<p>If you showed an example of the data that is causing you poblems then we could help you better, but the <a href="https://metacpan.org/module/HTML%3a%3aTableExtract" rel="nofollow"><code>HTML::TableExtract</code></a> module takes account of <code>rowspan</code> and <code>colspan</code> issues, and can be used to generate CSV data.</p> <p>However it seems best to write your Perl so that the code is driven by a data source so that it can produce <em>either</em> HTML <em>or</em> CSV data. It is wrong to scan the HTML that you have produced to regenerate the original data source, and create CSV-formatted output from that</p>