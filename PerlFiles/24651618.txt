Call a Perl script from JavaScript
<p>I want to call a Perl script from JavaScript. The Perl script moves/copies a file from one folder to another. But when I try to call it it's not running.</p> <p>I am new in this field so a little help will do a lot to me.</p> <p><strong>copy_file.pl</strong></p> <pre><code>#!/usr/bin/env perl use strict; use warnings; use File::Copy; my $source_dir = "/home/Desktop/file"; my $target_dir = "/home/Desktop/Perl_script"; opendir(my $DIR, $source_dir) || die "can't opendir $source_dir: $!"; my @files = readdir($DIR); foreach my $t (@files) { if (-f "$source_dir/$t" ) { # Check with -f only for files (no directories) copy "$source_dir/$t", "$target_dir/$t"; } } closedir($DIR); </code></pre> <p><strong>home.html</strong></p> <pre><code>&lt;!DOCTYPE html&gt; &lt;html&gt; &lt;body&gt; &lt;h1&gt;My First JavaScript&lt;/h1&gt; &lt;p&gt;Click Date to display current day, date, and time.&lt;/p&gt; &lt;button type="button" onclick="myFunction()"&gt;Date&lt;/button&gt; &lt;p id="demo"&gt;&lt;/p&gt; &lt;script&gt; function myFunction() { document.getElementById("demo").innerHTML = Date(); $.get("copy_file.pl"); } &lt;/script&gt; &lt;/body&gt; &lt;/html&gt; </code></pre>
<p>If you look at your JavaScript error console you will see that it is complaining that <code>$</code> is not defined.</p> <p>You appear to be trying to use <a href="http://jquery.com/" rel="nofollow">jQuery</a>, you need to include the library for it in your page before you can use the functions it provides.</p> <pre><code>&lt;script src="path/to/where/you/put/jquery.js"&gt;&lt;/script&gt; </code></pre>
<p>This looks like CGI/Apache issue. For the Perl code to run correctly in an Apache environment you need to return a Content Type header as one of the first things that your code outputs. Try using code that looks more like this...</p> <pre><code>#!/usr/bin/env perl use strict; use warnings; print "Content-Type: text/html\n\n"; use File::Copy; use CGI::Carp qw(fatalsToBrowser); #nice error handling, assuming there's no major syntax issues that prevent the script from running my $source_dir = "/home/Desktop/file"; my $target_dir = "/home/Desktop/Perl_script"; opendir(my $DIR, $source_dir) || die "can't opendir $source_dir: $!"; my @files = readdir($DIR); foreach my $t (@files) { if (-f "$source_dir/$t" ) { # Check with -f only for files (no directories) copy "$source_dir/$t", "$target_dir/$t"; } } closedir($DIR); print "&lt;h1&gt;OK&lt;/h1&gt;\n"; print "&lt;p&gt;Print&lt;/p&gt;\n"; __END__ </code></pre> <p>Also, it goes without saying that you need to make sure that the script need to also be marked as executable on the file system and Apache needs to have the privs to run it. Once you have checked all of this run the script from the URL line to make sure you are getting some sort of output before trying to call the script from JavaScript.</p> <p>From the JavaScript perspective, you need to also include a link to jQuery if you want the JavaScript code to work correctly, as Quentin correctly points out. Try adding the following header section (and include) above your Body section...</p> <pre><code>&lt;head&gt; &lt;script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"&gt;&lt;/script&gt; &lt;/head&gt; </code></pre>