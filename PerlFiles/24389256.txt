On click event only fire once while having same class
<p>I have a notification system that generates all of an user's notifications into a table in my html along with a bunch of rows like these:</p> <pre><code>&lt;td class = "archive-button" data-notice_id = "&lt;%= $notice-&gt;notice_id()%&gt;"&gt;Archive&lt;/td&gt; </code></pre> <p>I then have a js script that runs everytime a "archive-button" is pressed:</p> <pre><code>$(document).on('click', '.archive-button', function(){ var notice_id = $(this).data('notice_id'); var archiveaddress = '/user/notices/archivenotice/' + notice_id; var archived_notice = 'tr.notification-' + notice_id; $.post(archiveaddress, {notice_id: notice_id}).done(function(){ $(archived_notice).css("background" , "#F2F2F2"); $('#num-posts').html(parseInt($('#num-posts').html(), 10) -1); }); }); </code></pre> <p>My question is: how do i make it so each button can only trigger the event once? Each class is the same as "archive-button" so when I do .one('clicl') it disables all my other that hasn't been clicked yet. I can retrieve the notice_id from perl and insert it into each tag when they're generated but I still can't reference that in my js script.</p>
<p>Just use <code>data</code> attributes as you have used to store <code>notice-id</code>, but now as a flag:</p> <pre><code>$(document).on('click', '.archive-button', function() { if ($(this).data("clicked") !== true) { $(this).data("clicked", true); var notice_id = $(this).data('notice_id'); var archiveaddress = '/user/notices/archivenotice/' + notice_id; var archived_notice = 'tr.notification-' + notice_id; $.post(archiveaddress, {notice_id: notice_id}).done(function() { $(archived_notice).css("background" , "#F2F2F2"); $('#num-posts').html(parseInt($('#num-posts').html(), 10) -1); }); } }); </code></pre> <p>Note: You should use a <em>real</em> button(<code>input</code> or <code>a</code>) instead of a <code>td</code> tag acting as a button.</p>
<p>Attach your listeners to actual table cells as opposed to <code>document</code>:</p> <pre><code>$( 'td.archive-button' ).one( 'click', function(){ var notice_id = $(this).data('notice_id'); // etc.... }); </code></pre> <p>When done in this way, each cell will get it's own click listener, thus effectively removing the need to store any current state.</p>