Fetch exon sequence from mysql database using Bio::DB::SeqFeature::Store
<p>I have uploaded genomic fasta sequence and its GFF3 file into local mysql database using "bp_seqfeature_load.pl". Now, I want to extract sequence from position 100-2000 on "-" strand of Chromosome 1, and want to print exon sequence between 100-2000, with fasta format. Following code extracting the sequence from 100-2000 with "+" strand. Could you kindly correct my program. I will use this program for multiple queries (genomics position) not just one (100-2000).</p> <pre><code> #!/usr/bin/perl use Getopt::Long; use File::Spec; use Bio::DB::SeqFeature::Store; use Bio::SeqIO; #use Carp::Always; my $DSN; my $ADAPTOR; my $VERBOSE = 1; my $USER = ''; my $PASS = ''; my @gff3opt; my @information; GetOptions( 'dsn=s' =&gt; \$DSN, 'adaptor=s' =&gt; \$ADAPTOR, 'user=s' =&gt; \$USER, 'password=s' =&gt; \$PASS, 'gff3opt=i{,}' =&gt; \@gff3opt, ) || die &lt;&lt;END; Options: -d --dsn The database name ($DSN) -a --adaptor The storage adaptor to use ($ADAPTOR) -u --user User to connect to database as -p --password Password to use to connect to database -g --gff3opt flag options to gff3_string (i.e.: pass -gffopt 1 to recurse) END $ADAPTOR ||= 'DBI::mysql'; $DSN ||= $ADAPTOR eq 'DBI::mysql' ? "mysql_read_default_file=$ENV{HOME}/.my.cnf" : ''; my $store = Bio::DB::SeqFeature::Store-&gt;new( -dsn =&gt; $DSN, -adaptor =&gt; $ADAPTOR, -user =&gt; $USER, -pass =&gt; $PASS, ) or die "Couldn't create connection to the database"; # on signals, give objects a chance to call their DESTROY methods $SIG{TERM} = $SIG{INT} = sub { undef $store; die "Aborted..."; }; @information = $store-&gt;fetch_sequence(-seqid=&gt;'I',-start=&gt;100,-end=&gt;2000); for my $f (@information){ print "$f\n"; } </code></pre> <p>Following command was used to run the script:</p> <p>./program.pl -d database_name -u user -p password</p> <p>Thanks for your kind help</p>