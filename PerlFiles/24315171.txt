Perl, minor modification - data 9999.9 changed to 999-999, now dropping zero value element
<p>I'm new to this site, so hope to make my question clear! I've inherited some Perl programs that I have had to make modifications to over the last few years - and I've had great success doing so... until now.</p> <p>The program in question reads GL codes from an .ini file, then reads a database table to pull the values associated with those GL codes for the prior day, placing results in a hash, ultimately creating a file to be imported to another system. The GL codes were formatted as 9999.9, but now they are formatted as 999-999. This caused the GL code NOT to be recognized as numeric. I made minor changes to accomodate for that:</p> <p>Changed IF statement from</p> <pre><code>foreach my $num ( @glnums ) { if ( $num == $amt[4] ) } </code></pre> <p>to</p> <pre><code>foreach my $num ( @glnums ) { if ( $num = $amt[4] ) } </code></pre> <p>which corrected my first error. I also changed:</p> <pre><code> my @srtkeys = sort keys %ccsales; </code></pre> <p>to</p> <pre><code> my @srtkeys = sort { $a cmp $b } keys %ccsales; </code></pre> <p>which did result in the GL codes being in the correct order.</p> <p>The program compiled and is pulling the correct results, and putting them in the right order - happy for that.</p> <p>What it is suddenly NOT doing is putting a 0 in place for any GL code that has no value. I need a column output for each GL code, so the record layout stays consistent. I do see a statement initializing the hash values with zeros, which I have not modified:</p> <pre><code>foreach ( @glnums ) # my GL codes array { $ccsales{ $_} = 0.00; } </code></pre> <p>I've googled my issue several different ways, and been searching through prior issues on this site, in the hope of finding something that would point me in the right direction, but have not found anything. Help, please? I hope I've given you enough information, but please let me know if I have not. Thank you, in advance! </p>
<p>Your question doesn't give any context to the fragments of code that you show, and all I can see is that</p> <pre><code>if ( $num = $amt[4] ) </code></pre> <p>is probably wrong because it is an assignment, not a comparison. It is also likely that this is the cause of your missing zeroes, because a value of zero, <code>undef</code> or an empty string <code>""</code> in <code>$amt[4]</code> evaluate as <em>false</em>, and the block will not be executed. You probably need a string comparison, like this</p> <pre><code>if ( $num eq $amt[4] ) </code></pre> <p>Also, your change to the sort</p> <pre><code>my @srtkeys = sort { $a cmp $b } keys %ccsales </code></pre> <p>has made no difference as it is the same as a bare <code>sort</code> like this</p> <pre><code>my @srtkeys = sort keys %ccsales </code></pre> <p>Beyond that I cannot help. You should show much more of your code if you need additional assistance</p>