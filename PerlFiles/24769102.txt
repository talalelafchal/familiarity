Matching with multiple results perl
<p>I have a quick question. Say I have a list of names where some are missing an "account number." I will give an example delimited by the pipe,"|". "_" will represent blank.</p> <pre><code>Jim|1 John|_ Joe|2 John|_ John|_ JEff_234 JEff_298 </code></pre> <p>.....the list goes on for say 10,000 more rows with customers lacking ID numbers.</p> <p>My goal is to populate the blanks with each appropriate ID, John for example needs an ID.</p> <p>Luckily, we have a master list to reference the names to their appropriate IDs, but like I said, it would take forever to manually populate the blanks due to the large amount of rows.</p> <p>The problem is that John or whomever else may have more than one ID.</p> <p>The script I have will populate 'John' with only the first ID given..check the example below.</p> <pre><code>LINE: while (&lt;&gt;) { if (/(John)/gi){print $_ = $1."|"."ID_NUMBER_5"."\n"; print STDOUT "match!!!!\n"; next}; if (/(John)/gi){print $_ = $1."|"."ID_NUMBER_6"."\n"; print STDOUT "match!!!!\n"; next}; if (/(John)/gi){print $_ = $1."|"."ID_NUMBER_7"."\n"; print STDOUT "match!!!!\n"; next}; print; } </code></pre> <p>The result I get is this:</p> <pre><code>Jim|1 John|ID_NUMBER_5 Joe|2 John|ID_NUMBER_5 John|ID_NUMBER_5 JEff_234 JEff_298 </code></pre> <p>So if John has multiple "accounts" or "ids" this will not work.</p> <p>My desired result is this:</p> <pre><code>Jim|1 John|ID_NUMBER_5 Joe|2 John|ID_NUMBER_6 John|ID_NUMBER_7 JEff_234 JEff_298 </code></pre> <p>Any thoughts or proper methods of going about this?</p>
<p>Save the accounts in a hash of lists. Use the keys of the hash when looking for a match on each line. Each time you find a match and still have account list entries shift out one from the corresponding list.</p> <pre><code>my %accountMap = ("John", ["ID_NUMBER_5", "ID_NUMBER_6", "ID_NUMBER_7"], "Bob", ["ID_NUMBER_8"]); LINE: while (&lt;&gt;) { foreach $acctName (keys %accountMap) { if (/($acctName)/gi &amp;&amp; $accountMap{$acctName} &amp;&amp; scalar @{$accountMap{$acctName}} &gt; 0) { my @accounts = @{$accountMap{$acctName}}; my $account = shift @accounts; $accountMap{$acctName} = [@accounts]; print $_ = $1."|". $account ."\n"; next LINE; } } print; } </code></pre>