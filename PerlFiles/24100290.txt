Openshift Perl script can't connect to MYSQL
<p>Embarrassed to have to ask this of you Openshift guys, but Perl won't connect to MySQL, though PHP does just fine.</p> <p>Following code works just fine on the client (I added OPENSHIFT env variables on my local machine) but fails on the Openshift app:</p> <pre><code>my $db_name = 'campaignmotor'; my $db_host = $ENV{'OPENSHIFT_MYSQL_DB_HOST'}; my $db_port = $ENV{'OPENSHIFT_MYSQL_DB_PORT'}; my $db_pw = $ENV{'OPENSHIFT_MYSQL_DB_PASSWORD'}; my $db_user = $ENV{'OPENSHIFT_MYSQL_DB_USERNAME'}; sub db_connect { my $dsn = "DBI:mysql:database=$db_name;host=$db_host;port=$db_port"; my $dbh = DBI-&gt;connect($dsn, $db_user, $db_pw); return $dbh; } </code></pre> <p>I get unending messages like: <code>ERROR 2002 (HY000): Can't connect to local MySQL server through socket '/var/lib/mysql/mysql.sock' (2)</code></p> <p>Following PHP config on my web app works just fine:</p> <pre><code>$db['default']['hostname'] = getenv('OPENSHIFT_MYSQL_DB_HOST') . ':' . getenv('OPENSHIFT_MYSQL_DB_PORT'); $db['default']['username'] = getenv('OPENSHIFT_MYSQL_DB_USERNAME'); $db['default']['password'] = getenv('OPENSHIFT_MYSQL_DB_PASSWORD'); $db['default']['database'] = 'campaignmotor'; </code></pre> <p>mysql, mysqldump etc. all work on the command line.</p> <p>This is an HAProxy PHP application</p> <p>Odd thing is I have no OPENSHIFT_MYSQL_DB_SOCKET variable. Most of the helper threads on this topic reference that.</p> <p>Thanks in advance!</p>
<p>Corey - thanks!</p> <blockquote> <p>In your shell command above, specify the -h option for the host, or else yes, it would try to use the socket.</p> </blockquote> <p>And I'll add you need to specify the port as well, since in HAProxy mode MySQL runs on a non-standard port number. I added both -h with host and -P with port, and it works!</p> <p>I might have stumbled on this except that the command worked as expected when run direct on the shell, even without Port number and host specified. Weird!</p> <p>Thanks again!</p>