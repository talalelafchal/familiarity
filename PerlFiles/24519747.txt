Replacing ( string ) ^ 2 to sqrt ( string ) in Perl
<p>A given string (called <code>$bbb</code>!) contains many operands and operators. I want to replace every occurrence of <code>muth ( math ) ^ 2 mith</code> to <code>muth sqrt( math ) mith</code>. (whitespace can be more than just one).</p> <p><strong>EDIT:</strong> Assume that, in the entire expression, there is only either one <code>(simple linear expression) ^ 2</code> or none --if it makes it easier.</p> <p><strong>Inclusive Example:</strong></p> <p><code>1.2 * ( 4.7 * a * ( b - 0.02 ) ^ 2 * ( b - 0.02 + 1 ) / ( b - 0.0430 ) )</code></p> <p>should be changed to:</p> <p><code>1.2 * ( 4.7 * a * sqrt( b - 0.02 ) * ( c - 0.02 + 1 ) / ( d - 0.0430 ) )</code></p>
<p>Well... weird problem...</p> <p>Try it with this a bit <em>advanced</em> expression</p> <pre><code>(?&lt;math&gt;\((?:[^()]+|(?&amp;math))*\))\s*\^\s*2 </code></pre> <p>Hopefully the graphic illustrates what's going on</p> <p><img src="https://www.debuggex.com/i/JTJHrsv4hlK05nss.png" alt="Regular expression visualization"></p> <p><a href="https://www.debuggex.com/r/JTJHrsv4hlK05nss" rel="nofollow">Debuggex Demo</a></p> <p>The replacement string must than be <code>sqrt $1</code></p> <p>The command in perl would look like</p> <pre><code>$bbb =~ s/(?&lt;math&gt;\((?:[^()]+|(?&amp;math))*\))\s*\^\s*2/sqrt $1/ </code></pre> <p>A running example can be found here: <a href="http://regex101.com/r/qU8dV0/3" rel="nofollow">http://regex101.com/r/qU8dV0/3</a></p> <hr> <p><strong>some words on what the heck, this is</strong></p> <p>the main structure here is <code>anything\s*\^\s*2</code>, it's matching anything followed by <code>^2</code></p> <ul> <li><code>(?&lt;math&gt;...)</code> builds a pattern named <em><code>math</code></em></li> <li><code>\(...\)</code> the pattern <em><code>math</code></em> must begin with an opening parenthesis and end with a closing one</li> <li><strong>within the parenthesisses:</strong> <ul> <li><code>[^()]+</code> anything except parenthesisses is allowed or</li> <li><code>(?&amp;math)</code> another in parenthesis wrapped term with the already defined structure, is allowed, so the outer pattern <em><code>math</code></em> is recursively repeated </li> </ul></li> </ul>