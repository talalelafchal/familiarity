Omit Excel error when importing data into worksheet using Spreadsheet::WriteExcel
<p>I'm writing one Perl script to generate excel report by spooling data from MySQL table.My script is working fine but,in the final report i see <code>number stored as text error</code> in one of the columns.Actually that column has number but appended with <strong>dollar($)</strong> sign.<br/>Is there any ways to handle this error in perl script itself. <br/></p> <p><strong>Error screenshot:</strong></p> <p><img src="https://i.stack.imgur.com/xbGo4.jpg" alt="enter image description here"></p>
<p>Sounds to me like you should be writing the value as a number but formatting as a dollar amount.</p> <p>It would look something like this.</p> <pre><code>my $num = $workbook-&gt;add_format(); $num-&gt;set_num_format('$0.00'); </code></pre> <p>Then, when you actually set the value:</p> <pre><code>$workbook-&gt;write($row, $col, $value, $num); </code></pre> <p>Alternatively, you can format an entire column, which would allow you to use write_row without having explicitly declare the format on each write.</p> <pre><code>$workbook-&gt;set_column($from_col, $thru_col, $width, $num); </code></pre> <p>Also, for what it's worth, <a href="https://metacpan.org/pod/Excel%3a%3aWriter%3a%3aXLSX" rel="nofollow"><code>Excel::Writer::XLSX</code></a> is the newer incarnation of <a href="https://metacpan.org/pod/Spreadsheet%3a%3aWriteExcel" rel="nofollow"><code>Spreadsheet::WriteExcel</code></a>.</p>