attachment displaying full path when emailed using perl script
<p>My perl script emails attachment which displays full path (/abc/xyz/report.xls) in outlook email client but not in lotus notes email client.</p> <p>environment: 2010 Outlook on windows 7 OS.</p> <p>How do I make sure path is not displayed in the attachment?</p> <p><strong>Code Snippet:</strong></p> <pre><code>&amp;sendEmail(@subject, @message, $exception_report_xls); sub sendEmail { my $subject = "@subject"; my $distlist = 'ayc@abc.com'; my $message ="\n\n\n@message \n"; my $send = system("\(echo \"$message\" ; uuencode \"$exception_report_xls\" \"$exception_report_xls\"\) | mailx -s \"$subject\" \"$distlist\""); } </code></pre> <p>Appreciate any resonse!</p> <p>Ramya.</p>
<p>You are writing the full path and filename of the XLS file in the source of the message. So, some mail clients will display the full path.</p> <p>If you are wedded to using (antiquated) UUENCODE, try it this way instead:</p> <pre><code> sub Send_Email_UUENCODE { local($to, $from, $subj, $message, $attach) = @_; local($i,$filename,$cmd,$att,$mailprog); $i=length($attach)-1; while( (substr($attach,$i,1) cmp '/')!=0 &amp;&amp; $i&gt;0) {$i--;} $filename=substr($attach,$i+1,length($attach)-$i-1); if ($attach) { $cmd="uuencode " . $attach . ' ' . $filename; $att=`$cmd`; } $mailprog = "/usr/sbin/sendmail -f " . $from; open (MAIL, "|$mailprog $to") || die "Can't open $mailprog!\n"; print MAIL "To: $to\n"; print MAIL "From: $from\n"; print MAIL "Subject: $subj\n"; print MAIL "$message\n"; if ($attach) { print MAIL "$att\n"; } close (MAIL); } </code></pre> <p>But, better might be to use MIME encoding instead of UUENCODE.</p>