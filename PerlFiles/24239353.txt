Multiple print unless perl
<p>I have a file that looks like this:</p> <pre><code>#AllowAgentForwarding yes #AllowTcpForwarding yes #GatewayPorts no #X11Forwarding yes #XAuthLocation /usr/X11R6/bin/xauth #X11DisplayOffset 10 #X11UseLocalhost yes </code></pre> <p>I'm trying to write a script that uncomments the following lines:</p> <pre><code>#X11Forwarding yes #XAuthLocation /usr/X11R6/bin/xauth </code></pre> <p>I have written following script:</p> <pre><code>open(my $in, '&lt;', '/etc/ssh/sshd_config') or die "Cannot open /etc/ssh/sshd_config $!"; open(my $out, '&gt;', '/etc/ssh/sshd_config2') or die "/etc/ssh/sshd_config2: $!"; while (&lt;$in&gt;) { print $out $_ unless /X11Forwarding/ ; } $txt='#X11Forwarding yes'; $txt=reverse $txt; chop($txt); $txt=reverse $txt; `echo "$txt \n" &gt;&gt; '/etc/ssh/sshd_config2'`; `mv '/etc/ssh/sshd_config2' '/etc/ssh/sshd_config'`; close($in); close($out); </code></pre> <p>Now this script works the way I want. The X11Forwarding segment is uncommented, but I can't seem to get it working so the XAuthLocation segment is also uncommented. Is there a way that I can print the file without the X11Forwarding and XAuthLocation segment?</p>
<p>In a single line:</p> <pre><code>perl -i -pe's/^#(?=X11Forwarding|XAuthLocation)//' /etc/ssh/sshd_config </code></pre>
<p>If you already have these two lines, and only want to uncomment them,</p> <pre><code>while (&lt;$in&gt;) { s/#\s*(?=X11Forwarding|XAuthLocation)//; print $out $_; } </code></pre>
<p>Okay, here to make it official, just add the <code>XAuthLocation</code> Part to the <em>skip</em> line:</p> <pre><code>print $out $_ unless /X11Forwarding|XAuthLocation/; </code></pre>