PDF::API2 can't write to page 2
<p>I have 2 .pdf files. Both are 1 page. I use them as watermark for invoices. Once page 1 (the 1st pdf) is filled I then like to import page 2 (the 2nd pdf) after page 1 and write to it. Obviously if it page 1 is not filled carry on writing to it. Here is a test code I have written:</p> <pre><code>my $pdf = PDF::API2-&gt;new(); my $sec_page = PDF::API2-&gt;open('./useful_scripts/invoice_page_2.pdf'); $pdf = PDF::API2-&gt;open('./useful_scripts/invoice.pdf'); my $page = $pdf-&gt;openpage(1); my $text = $page-&gt;text(); my $font = $pdf-&gt;corefont('Helvetica-Bold'); $text-&gt;fillcolor('black'); $text-&gt;font($font, 11); $text-&gt;translate(170, 785); $text-&gt;text($invoice-&gt;ott_invoice_number); my ( $y, $d, $x ) = ( 718, 15, 57 ); foreach my $line ( @{ $invoice-&gt;invoice_lines } ) { $text-&gt;translate( $x, $y ); my $product = join( ': ', @{ $line-&gt;{display} } ); $text-&gt;text($product); $y = $y - 13; if ( $line-&gt;{options} ) { foreach my $option ( @{ $line-&gt;{options} } ) { $text-&gt;translate( $x + 10, $y ); $text-&gt;text($option); } } } $y = 100; #This is for testing purposes #so that I can make sure it is #writing to page 2 if( $y &lt; 150 ){ $page = $pdf-&gt;importpage($sec_page); $page = $pdf-&gt;openpage(2); $text = $page-&gt;text(); $text-&gt;translate(100,200); $text-&gt;text('Some test text...'); #This is LINE 59 } #END $pdf-&gt;saveas('./test.pdf'); say 'Printing done... ;)'; </code></pre> <p>However on line 59 (I have commented as line 59) I get an error saying:</p> <pre><code>Can't call method "isvirtual" on an undefined value at /usr/local/lib/perl5/site_perl/5.14.2/PDF/API2/Content.pm line 1558. </code></pre> <p>I have read similar questions with similar issues to myself and have tried the solutions that had been suggested. But none seem to work for me. Any ideas?</p>
<p>When you create the <code>$text</code> object for the second page, you need to call <code>$text-&gt;font(...)</code> again. It doesn't carry over from the first page.</p> <p>Add the following between line 57 and line 59:</p> <pre><code>$text-&gt;font($font, 11); </code></pre>