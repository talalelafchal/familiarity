How can I serve CGI scripts using perlbrew w/ Apache?
<p>Error log:</p> <pre><code>[Tue Jun 17 12:08:35 2014] [error] [client 172.18.40.199] Perl v5.16.0 required--this is only v5.10.1, stopped at index.cgi line 2. [Tue Jun 17 12:08:35 2014] [error] [client 172.18.40.199] BEGIN failed--compilation aborted at index.cgi line 2. [Tue Jun 17 12:08:35 2014] [error] [client 172.18.40.199] Premature end of script headers: index.cgi </code></pre> <p>This is run as the user: 'support' and support runs perlbrew w/ switch set to 5.16.3 as shown below:</p> <pre><code># su - support print() on closed filehandle $fh at /loader/0x1cb94a8/App/perlbrew.pm line 19. -bash-4.1$ perl -v This is perl 5, version 16, subversion 3 (v5.16.3) built for x86_64-linux </code></pre> <p>What do I need to do to ensure Apache executes index.cgi w/ the perl installed by perlbrew?</p>
<p>Is there a shebang in index.cgi? Which perl does it point to?</p> <p>I believe the shebang should point to your custom perl not the system perl that you have shown.</p>
<p>The OS executes the interpreter identified by the shebang (<code>#!</code>) line of the script it was asked to execute (<code>index.cgi</code>). It's just a question of specifying the path to the interpreter you installed using <code>perlbrew</code> there.</p> <p>Execute <code>which perl</code> (more familiar) or <code>perl -E'say $^X'</code> (more reliable?) to determine the value needed.</p> <hr> <p>Let's do an example.</p> <p>One on of my machines, I get the following when using my threaded build of 5.18.2. (You'll get something different.)</p> <pre><code>$ which perl /home/ikegami/usr/perlbrew/perls/5.18.2t/bin/perl $ perl -E'say $^X' /home/ikegami/usr/perlbrew/perls/5.18.2t/bin/perl </code></pre> <p>So I'd use the following as the first line of <code>index.cgi</code>:</p> <pre><code>#!/home/ikegami/usr/perlbrew/perls/5.18.2t/bin/perl </code></pre>
<p>use a proper perl/bash shebang..</p> <p>the following would work perfectly</p> <pre><code>#!/bin/bash export PERLBREW_ROOT=/opt/perlbrew export PERLBREW_HOME=/tmp/.perlbrew export SHELL=/bin/bash #not really needed unset XTERM_SHELL #not really needed source ${PERLBREW_ROOT}/etc/bashrc perlbrew use perl-5.21.9 &gt; /dev/null 2&gt;&amp;1 # you can add your version here... eval 'exec perl -x -wS $0 ${1+"$@"}' if 0; #! -*-perl-*- # line 10 The above line/string resets the perldebug line-numbering... print "The perl interpretter running this code is $^X\n" ; print "This is perl version $^V\n" ; print "Hello PerlBrew \n" ; die "This should be line number 14\n" ; print "x\n" ; </code></pre> <p>That will result in... </p> <pre><code>The perl interpretter running this code is /opt/perlbrew/perls/perl-5.21.9/bin/perl5.21.9 This is perl version v5.21.9 Hello PerlBrew This should be line number 14 </code></pre> <p>Hope this helps... </p> <p>G</p>