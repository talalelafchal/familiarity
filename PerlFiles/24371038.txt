SQLite query optimization insert or replace
<p>I am a newbie as far as SQLITE is concerned. Here I have a working query and wanted to optimize the same to improve the performance.</p> <p>This table cinfo has 5 columns -- <code>ID</code> (Primary Key), <code>Name</code>, <code>StartDate</code>, <code>EndDate</code>, <code>Count</code> -- and I have around 3000K records with ID, name and date (<code>YYYYMMDD</code>) which I will be inserting into this table. Now the conditions are:</p> <ol> <li>If there is no records in the table with same ID, insert a new row wth <code>id</code>, <code>startdate=date</code>, <code>enddate=date</code> and <code>count</code> (count will depend on occurence of this id in another table which I don't want to consider as hardcoded value)</li> <li>If the record exists and <code>date</code> is less than <code>startdate</code>, <code>startdate</code> will be updated with <code>date</code>.</li> <li>If the record exists and <code>date</code> is greater than <code>enddate</code>, <code>enddate</code> will be updated with <code>date</code>.</li> <li><code>Name</code> will be update with new name only if condition 3 is true</li> </ol> <p>Count is depended on the other table so ignoring as of now. Here is the query-</p> <pre><code>INSERT OR REPLACE INTO cinfo (ID, StartDate, EndDate, Count, Name) values ('3', min(ifnull((select StartDate from cinfo where ID='3'),99999999), 20140113), max(ifnull((select EndDate from cinfo where ID='3'), 0), 20140113), ifnull((select Count from cinfo where ID='3'),0) + 1, ifnull((select Name from cinfo c where (ID='3') and (c.EndDate &gt; '20140113')), 'name3')); </code></pre> <p>the values of current record in this example are- <code>id=3</code>, <code>date='20140113'</code>, <code>name='name3'</code>.</p> <p>I am using perl script to connect and update this records.</p>