How to retrieve multiple values from database and set it as variable
<p><strong>Inside table(1)</strong></p> <pre><code>ID Name Address Phone InsertDate 1 Andrew 12-A,ABC 576849203 2014/05/06 1 Andrew 12-A,ABC 123456789 2014/07/08 </code></pre> <p><strong>Inside table(2)</strong></p> <pre><code>ID Name Address Phone InsertDate 1 Andrew 12-A,ABC 123456789 2014/07/08 </code></pre> <p>The problem I met is when I <code>Select * from table(1) where id='1'</code>. It will retrieve two records. Then when I try to insert to <code>table(2)</code>. It only show one record in table(2) instead of 2 records.</p> <p>What should I do so I can get the two records from table(1) and insert to table(2)?</p> <p>My example Code:</p> <pre><code>$mysql="Select * from table(1) where id='1'"; **Perform the query** **Retrieve values** $sth-&gt;bind_col(1, \$Name); $sth-&gt;bind_col(2, \$Address); $sth-&gt;bind_col(3, \$Phone); $sth-&gt;bind_col(4, \$InsertDate); if($sth-&gt;fetch()){ $mysql="Insert into table(2) values($Name,$Address,$Phone,InsertDate)"; **Perform the query** } </code></pre> <p>Thanks for viewing,comments and answers!</p>
<p>first of all make sure in table2 , id or name or some other field is not set to primary or it will not allow u insert duplicate records ..</p> <p>try this PHP code...</p> <pre><code>result=mysql_query(" select * from table where id=1 "); while($row=mysql_fetch_assoc($result)) { $name=$row["Name"]; $address==$row["address"]; $phone==$row["phone"]; $insertdate=$row["insertdate"]; mysql_query( "insert into table2(name,address,phone,insertdate) values('$name','$address','$phone','$insertdate') "); } </code></pre>
<p>You are doing <code>SELECT * FROM table(1)</code> so you are fetching <em>all</em> of the columns. The first is <code>ID</code> so your column binding is incorrect, and it is hard to believe that your code copies even one record correctly. In addition, you are executing <code>fetch</code> only once, so you are only ever trying to insert one of the two rows into <code>table(2)</code>.</p> <p>You need to write something like this</p> <pre><code>my $read = $dbh-&gt;prepare(&lt;&lt;'__END_SQL__'); SELECT Name, Address, Phone, InsertDate FROM table(1) WHERE ID = ? __END_SQL__ my $write = $dbh-&gt;prepare(&lt;&lt;'__END_SQL__'); INSERT INTO table(2) (Name, Address, Phone, InsertDate) VALUES (?, ?, ?, ?) __END_SQL__ $read-&gt;execute(1); while (my $row = $read-&gt;fetchrow_arrayref) { $write-&gt;execute(@$row); } </code></pre> <p>But, unless there is a reason why you want access at the Perl level to the records being copied, you could let the database do all of it for you, like this</p> <pre><code>my copy = $dbh-&gt;prepare(&lt;&lt;'__END_SQL__'); INSERT INTO table(2) (Name, Address, Phone, InsertDate) SELECT Name, Address, Phone, InsertDate FROM table(1) WHERE ID = ? __END_SQL__ $copy-&gt;execute(1); </code></pre>