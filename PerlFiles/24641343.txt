Is it possible to move Outlook folders using Win32::OLE?
<p>I have manage to add folders in Outlook, but can't work out how to move them. The code I have does not throw out any warnings and does not move the folder:</p> <pre><code>#!/usr/bin/perl use strict; use warnings; use Win32::OLE; use Win32::OLE::Const 'Microsoft Outlook'; # use existing instance if Outlook is already running, or launch a new one my $Outlook; eval {$Outlook = Win32::OLE-&gt;GetActiveObject('Outlook.Application')}; die "Outlook not installed" if $@; unless (defined $Outlook) { $Outlook = Win32::OLE-&gt;new('Outlook.Application', sub {$_[0]-&gt;Quit;}) or die "Oops, cannot start Outlook"; } my $namespace = $Outlook-&gt;GetNamespace("MAPI"); #my $Folder = $namespace-&gt;Folders("backupadmin")-&gt;Folders( # "Inbox")-&gt;Folders-&gt;Add("test"); my $Folder = $namespace-&gt;Folders("backupadmin")-&gt;Folders( "Inbox")-&gt;Folders("test")-&gt;MoveTo("test1"); </code></pre>
<p>If you use the popular Outlook Redemption library, you can retrieve a RDO Folder object for the folder you want to move and then call the <code>MoveTo</code> method with the destination RDO folder as the parameter. For some sample Perl code, you can reference the <code>Email::PST::Win32</code> CPAN module which uses <code>Win32::OLE</code> and Outlook Redemption to access RDO Folder objects.</p> <p>Outlook Redemption: <a href="http://www.dimastr.com/redemption/home.htm" rel="nofollow">http://www.dimastr.com/redemption/home.htm</a></p> <p>RDO Folder with MoveTo Method: <a href="http://www.dimastr.com/redemption/rdo/rdofolder.htm" rel="nofollow">http://www.dimastr.com/redemption/rdo/rdofolder.htm</a></p> <p>Email::PST::Win32: <a href="https://metacpan.org/release/Email-PST-Win32" rel="nofollow">https://metacpan.org/release/Email-PST-Win32</a></p>