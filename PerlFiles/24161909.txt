How to add an arbitrary field with XML::Compile::WSDL11 (mistake: tag `param' not used at...)
<p>I'm trying to use the module <a href="https://metacpan.org/pod/XML%3a%3aCompile%3a%3aWSDL11" rel="nofollow"><code>XML::Compile::WSDL11</code></a> to create a SOAP message in base of a wsdl file. In the xsd definitions there is a parameter called <code>UserArea</code> that is supposed to hold arbitrary fields (extensions):</p> <pre><code>&lt;xsd:element name="UserArea" type="UserAreaType"/&gt; &lt;xsd:complexType name="UserAreaType"&gt; &lt;xsd:sequence&gt; &lt;xsd:any namespace="##any" processContents="lax" minOccurs="0" maxOccurs="unbounded"/&gt; &lt;/xsd:sequence&gt; &lt;/xsd:complexType&gt; </code></pre> <p>So I can create manually a valid xml like:</p> <pre><code>&lt;ProcessAssessmentOrder&gt; ... &lt;DataArea&gt; ... &lt;AssessmentOrder&gt; ... &lt;UserArea xmlns:xxx="http://example.com"&gt; &lt;xxx:someURL&gt;http://someurl.example.com&lt;/xxx:someURL&gt; &lt;/UserArea&gt; &lt;/AssessmentOrder&gt; &lt;/DataArea&gt; &lt;/ProcessAssessmentOrder&gt; </code></pre> <p>That works and validates. However trying to use <code>XML::Compile::WSDL11</code> I got the error:</p> <pre><code>mistake: tag `xxx:SomeURL' not used at {http://www.hr-xml.org/3}ProcessAssessmentOrder/DataArea/AssessmentOrder/CustomerParty/PartyReportingIDs/UserArea </code></pre> <p>And the parameter is not in the generated xml.</p> <p>So far this is my Perl code:</p> <pre><code>use strict; use warnings; use DateTime; use XML::Compile::Transport::SOAPHTTP; use XML::Compile::SOAP11; use XML::Compile::WSDL11; my %args = ( releaseID =&gt; '3.3', ApplicationArea =&gt; { CreationDateTime =&gt; DateTime-&gt;now, }, DataArea =&gt; { Process =&gt; {}, AssessmentOrder =&gt; { UserArea =&gt; { 'xxx:SomeURL' =&gt; 'www.example.com', }, }, }, ); my $wsdl_path = '/home/david/HR-XML-3_3/Assessments/org_hr-xml/3_3/WebServices/WSDL/AssessmentOrder.wsdl'; my $wsdl = XML::Compile::WSDL11-&gt;new($wsdl_path); import_definitions($wsdl, '/home/david/HR-XML-3_3/Assessments/'); $wsdl-&gt;compileCalls( port =&gt; 'AssessmentOrder_Port', endpoint =&gt; 'http://127.0.0.1/xxx', ); my($response, $trace) = $wsdl-&gt;call('ProcessAssessmentOrder', %args); sub import_definitions { my($wsdl, $path) = @_; opendir (my $dh, $path); while (my $file = readdir($dh)) { next if ($file eq '.' || $file eq '..'); if (-d "$path/$file") { import_definitions($wsdl, "$path/$file"); } elsif ($file =~ m#\.xsd$#) { $wsdl-&gt;importDefinitions("$path/$file"); } } closedir($dh); }; </code></pre> <p>How to make it work to get the xml having the line</p> <pre><code>&lt;xxx:someURL&gt;http://someurl.example.com&lt;/xxx:someURL&gt; </code></pre> <p>¿·_·?</p>
<p>Yo can try adding this:</p> <pre><code>my $myns = 'http://example.com'; $wsdl-&gt;prefixes =&gt; { $myns =&gt; [ uri =&gt; $myns, prefix =&gt; 'xxx' ] }; </code></pre> <p>seen at <a href="http://search.cpan.org/~markov/XML-Compile-1.44/lib/XML/Compile/Schema.pod#Administration" rel="nofollow">http://search.cpan.org/</a></p>
<p>If I read things right at <a href="http://lists.scsys.co.uk/pipermail/xml-compile/2009-July/000250.html" rel="nofollow">http://lists.scsys.co.uk/pipermail/xml-compile/2009-July/000250.html</a>, I think XML::Compile doesn't support the xsd:any element. Further than that, I can't say, as I'm wresting with a similar issue myself.</p>