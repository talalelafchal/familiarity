select substring between two matching strings
<p>I have three files: <em>File 1</em> contains a number of stings like below:</p> <pre><code>AGGUGCAGAGCUUAGCUGAUUGGUGAACAGUGAUUGGUUUCCGCUUUGUUCACAGUGGCUAAGUUCUGCACCU </code></pre> <p><em>File 2</em> contains a substring of the string in file 1 matching the <strong>left</strong> side:</p> <pre><code>AGGUGCAGAGCUUAGCUGAUUGGUGAACAGUGAUUGGUUUCCGCUUUGUUCACAGUGGCUAAGUUCUGCACCU AGAGCUUAGCUGAUUGGUGAAC </code></pre> <p><em>File 3</em> contains a substring of the string in file 1 matching the <strong>right</strong> side:</p> <pre><code>AGGUGCAGAGCUUAGCUGAUUGGUGAACAGUGAUUGGUUUCCGCUUUGUUCACAGUGGCUAAGUUCUGCACCU UUCACAGUGGCUAAGUUCUGC </code></pre> <p>I want to extract the string that lies between the two strings that match </p> <pre><code>AGGUGCAGAGCUUAGCUGAUUGGUGAACAGUGAUUGGUUUCCGCUUUGUUCACAGUGGCUAAGUUCUGCACCU AGAGCUUAGCUGAUUGGUGAAC UUCACAGUGGCUAAGUUCUGC </code></pre> <p>Output:</p> <pre><code> AGUGAUUGGUUUCCGCUUUG </code></pre> <p>I would like to do this for all my strings in <em>file 1</em> (approx 200 strings)</p> <p>example <em>file 1</em>:</p> <pre><code>&gt;mmu-let-7g CCAGGCTGAGGTAGTAGTTTGTACAGTTTGAGGGTCTATGATACCACCCGGTACAGGAGATAACTGTACAGGCCACTGCCTTGCCAGG &gt;mmu-let-7i CTGGCTGAGGTAGTAGTTTGTGCTGTTGGTCGGGTTGTGACATTGCCCGCTGTGGAGATAACTGCGCAAGCTACTGCCTTGCTAG &gt;mmu-miR-1a-1 GCTTGGGACACATACTTCTTTATATGCCCATATGAACCTGCTAAGCTATGGAATGTAAAGAAGTATGTATTTCAGGC </code></pre> <p>Example <em>file 2</em> and <em>file 3</em>:</p> <pre><code>&gt;mmu-let-7g-5p MIMAT0000121 Mus musculus let-7g-5p UGAGGUAGUAGUUUGUACAGUU &gt;mmu-let-7g-3p MIMAT0004519 Mus musculus let-7g-3p ACUGUACAGGCCACUGCCUUGC &gt;mmu-let-7i-5p MIMAT0000122 Mus musculus let-7i-5p UGAGGUAGUAGUUUGUGCUGUU </code></pre>
<p>Assuming you are working with something like this:</p> <pre><code>file1 &lt;- "AGGUGCAGAGCUUAGCUGAUUGGUGAACAGUGAUUGGUUUCCGCUUUGUUCACAGUGGCUAAGUUCUGCACCU" file2 &lt;- "AGAGCUUAGCUGAUUGGUGAAC" file3 &lt;- "UUCACAGUGGCUAAGUUCUGC" </code></pre> <p>You can try constructing your search pattern with "file2" and "file3" and using <code>gsub</code>.</p> <p>Example:</p> <pre><code>gsub(paste0("(^.*", file2, ")(.*)(", file3, ".*)$"), "\\2", file1) # [1] "AGUGAUUGGUUUCCGCUUUG" </code></pre>
<p>You could also try:</p> <pre><code>str1 &lt;- "AGGUGCAGAGCUUAGCUGAUUGGUGAACAGUGAUUGGUUUCCGCUUUGUUCACAGUGGCUAAGUUCUGCACCU" leftstr &lt;- "AGAGCUUAGCUGAUUGGUGAAC" rightstr &lt;- "UUCACAGUGGCUAAGUUCUGC" library(qdap) unname(genXtract(str1,leftstr, rightstr)) #[1] "AGUGAUUGGUUUCCGCUUUG" </code></pre> <h3>Update</h3> <p>If you have multiple strings</p> <pre><code> str2 &lt;- c(str1, "AGGUGUCCCCCCUUUUUGGAGUGGCCGCUUUUGCGGGGUAAUUG") leftstr1 &lt;- c(leftstr, "CCCCCUUUU") rightstr1 &lt;- c(rightstr, "UUUUGCGG") unlist(genXtract(str2, leftstr1, rightstr1)) #[1] "AGUGAUUGGUUUCCGCUUUG" "UGGAGUGGCCGC" </code></pre> <p>Comparing the results with @Venkataramanan's post</p> <pre><code> temp1 &lt;- mapply(gsub, leftstr1, "|", str2) temp2 &lt;- mapply(gsub, rightstr1, "|", temp1) unlist(strsplit(temp2, "|", fixed=T),use.names=F)[c(F,T,F)] #[1] "AGUGAUUGGUUUCCGCUUUG" "UGGAGUGGCCGC" </code></pre> <p>or</p> <pre><code> scan(text=gsub(paste(rightstr1, collapse="|"), " ",gsub(paste(leftstr1,collapse="|")," ",str2)), what="character")[c(F,T,F)] #Read 6 items # [1] "AGUGAUUGGUUUCCGCUUUG" "UGGAGUGGCCGC" </code></pre> <p>or</p> <pre><code> library(stringr) str_extract_all(str1, perl(paste0("(?&lt;=",leftstr,")",".*(?=", rightstr,")")))[[1]] #[1] "AGUGAUUGGUUUCCGCUUUG" </code></pre>
<p>The following code does the job:</p> <pre><code>temp1&lt;- gsub("AGAGCUUAGCUGAUUGGUGAAC", "|", "AGGUGCAGAGCUUAGCUGAUUGGUGAACAGUGAUUGGUUUCCGCUUUGUUCACAGUGGCUAAGUUCUGCACCU") temp1 temp2&lt;- gsub("UUCACAGUGGCUAAGUUCUGC","|", temp1) temp2 unlist(strsplit(temp2, "|", fixed=T))[2] </code></pre>