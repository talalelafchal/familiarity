Sending a POST in Perl using Net::HTTP
<p>I've been looking through documentation for this, but I can't seem to find the answers to my questions. I'm trying to POST some data to a url using Net::HTTP in my perl script. The problem is, I need to be able to modify the headers (like add proxy information) for the request.</p> <p>Does anyone have a simple example of something like this?</p>
<p>Most people send a post through Net::HTTP as follows:</p> <pre><code>use LWP::UserAgent qw( ); my $ua = LWP::UserAgent-&gt;new(); my $response = $ua-&gt;post($url, [ foo =&gt; 123, bar =&gt; 546, ]); </code></pre>
<p>You can make a POST request using <code>Net::HTTP</code>, but as ikegami indicated, most people use <a href="https://metacpan.org/pod/LWP%3a%3aUserAgent" rel="nofollow"><code>LWP::UserAgent</code></a> for this sort of thing.</p> <pre><code>my $http = Net::HTTP-&gt;new('Host' =&gt; "stackoverflow.com") or die "Unable to connect: $@"; $http-&gt;write_request('POST' =&gt; "/", 'User-Agent' =&gt; "Mozilla/4.0", "foo=bar", ); my ($code, $message, %h) = $http-&gt;read_response_headers; if($code != 200) { die "Request failed: $message"; } my $response; while(1) { my $buf; my $n = $http-&gt;read_entity_body($buf, 1024); die "Read failed: $!" unless defined $n; last unless $n; $response .= $buf; } print "$response\n"; </code></pre>