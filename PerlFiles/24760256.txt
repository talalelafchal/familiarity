Find hostname of remote server through ssh in perl
<p>I have an array which contains a series of IPs. Now i'm trying to connect to those IPs through ssh and echo their hostname. I came accross <a href="http://stackoverflow.com/questions/20838158/perl-script-for-ssh-login-with-password-and-run-a-command-on-the-remote-server">this Stackoverflow answer</a> but didn't get much info out of it. This is what I've got:</p> <pre><code>#!/usr/bin/perl use warnings; use strict; use Term::ANSIColor; print colored( "Number of machines: \n", 'green' ); my $number = &lt;&gt;; my @arr = (); my $ip = 0; while (@arr &lt; $number) { print colored( "\nIP Address: \n", 'green' ); my $IP = &lt;STDIN&gt;; chomp $IP; push @arr, $IP; } print colored( "this is the hostname:\n", 'green' ); foreach $ip (@arr) { print "`ssh host\@$ip hostname \n`"; } </code></pre> <p>but I get following error:</p> <pre><code>Can't use string ("IP") as an ARRAY ref while "strict refs" in use at </code></pre> <p>When I remove <code>use strict; the error is also removed, but the code still doesn't work</code></p> <hr> <p>edit: the \@ did the trick of removing the error but now it just prints </p> <pre><code>`ssh axiroot@172.31.222.135` `hostname` </code></pre> <p>while it should print just the hostname</p>
<p>The syntax</p> <pre><code>@$ip </code></pre> <p>In your print statement is interpreted as an array reference. That is what caused the error. </p> <p>Try escaping:</p> <pre><code>"...host\@$ip..." </code></pre> <p>Furthermore, you can use backticks to execute a command and capture the output</p> <pre><code>`ssh bla@example.com hostname` </code></pre> <p>But you have surrounded the backticks with quotes, rendering them useless.. I think you want to remove the quotes.</p>
<p><code>@$ip</code> in the print statement is your problem. Try changing to <code>\@$ip</code>.</p>
<p>Your print has too many quotes to execute the ssh command. Try</p> <pre><code> print `ssh host\@$ip hostname \n`; </code></pre> <p>or </p> <pre><code>system "ssh host\@$ip hostname \n"; </code></pre> <p>Finally, "host" must be a valid user on the remote machine. The syntax for ssh is</p> <pre><code>ssh user@remote-host </code></pre>