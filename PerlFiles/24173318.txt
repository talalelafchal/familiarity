Get entire certificate using Perl's Net::SSLeay
<p>I want to use the Perl library <a href="https://metacpan.org/pod/Net%3a%3aSSLeay" rel="nofollow"><code>Net::SSLeay</code></a> to download a server's SSL certificate but am having trouble figuring out how to do this. I want the <em>entire</em> certificate, not just the common name and a few of the fields.</p> <p>For example, I would give the script the argument <code>google.com</code> and it would connect to <a href="https://google.com" rel="nofollow">https://google.com</a> and get the entire certificate string for the certificate with CN "*.google.com". </p> <p>This script needs to run on a Debian wheezy server so must use version 1.48 of <code>Net::SSLeay</code>.</p>
<p>I believe this might be what you want?</p> <pre><code>($reply, $err, $cert) = sslcat('www.google.com', 443, '/'); # 5 $PEM = Net::SSLeay::PEM_get_string_X509( $cert); </code></pre> <p>Will give you the PEM encoded SSL certificate. You can decode it using MIME::Base64. </p>