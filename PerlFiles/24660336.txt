Delete all the lines that start with a specific word from multiple (700+) text files
<p>I have about 700 text files in a folder, and each of them looks like this:</p> <pre><code>ATOM 46 H17 21Q A 1 8.755 9.236 19.160 1.00 10.00 H ATOM 47 H18 21Q A 1 4.986 13.632 21.286 1.00 10.00 H ATOM 48 H19 21Q A 1 4.073 12.279 20.536 1.00 10.00 H ATOM 49 H20 21Q A 1 4.447 12.245 22.293 1.00 10.00 H ATOM 50 H21 21Q A 1 -0.059 3.744 18.524 1.00 10.00 H ATOM 51 H22 21Q A 1 0.915 2.266 18.827 1.00 10.00 H ATOM 52 H23 21Q A 1 -0.811 2.321 19.321 1.00 10.00 H ATOM 53 H24 21Q A 1 -0.126 -0.895 21.075 1.00 10.00 H ATOM 54 H25 21Q A 1 1.167 0.041 20.250 1.00 10.00 H ATOM 55 H26 21Q A 1 1.247 -0.230 22.024 1.00 10.00 H ATOM 56 H27 21Q A 1 4.391 7.539 23.280 1.00 10.00 H CONECT 1 2 30 31 32 CONECT 2 1 3 33 34 CONECT 3 2 5 18 CONECT 4 5 19 35 CONECT 5 3 4 6 CONECT 6 5 24 26 CONECT 7 8 12 24 </code></pre> <p>what I am trying to do is to write a Perl script, able to process my 700 files while deleting all the lines that start with the word CONECT. At the same time I want to save the file under its original name. Unfortunately I only managed to open a single file (21Q) and to save it in an empty file that I created (21Q_2), not quite what I wanted.</p> <pre><code>#!perl use strict; use warnings; use LWP::Simple; use File::Slurp; open(my $in, '&lt;', 'C:\perl_old_test\TRP_ligands_PDB\21Q.txt', ) or die "Cannot open input.txt: $!"; open(my $out, '&gt;', 'C:\perl_old_test\TRP_ligands_PDB\21Q_2.txt') or die "Cannot open output.txt: $!"; while (&lt;$in&gt;) { print $out $_ unless /\bCONECT\b/; } close($in); close($out); </code></pre> <p>Any help would be really appreciated! Thank you very much, Arianna</p>
<p>You can do this using a simple Perl one-liner: </p> <pre><code>perl -ni.bak -e 'print unless /^CONECT/' &lt;filename glob&gt; </code></pre> <p>The <code>-n</code> flag assumes this loop around the code you wish to execute: </p> <pre><code>while (&lt;&gt;) { # code } </code></pre> <p>The <code>-i</code> modifies your text files in place, <code>.bak</code> creates a backup of the original file in case you want both copies. </p> <p>The <code>-e</code> flag indicates that Perl should execute this code. </p> <p><code>&lt;filename glob&gt;</code> should be replaced by a pattern that globs together all the files you want to examine. For instance if you wanted all files it would be <code>*</code>, or all files that have the .txt extension would be <code>*txt</code>. </p>
<p>Use the <a href="http://perldoc.perl.org/perlvar.html#General-Variables" rel="nofollow"><code>$INPLACE_EDIT</code></a> functionality:</p> <pre><code>use strict; use warnings; use autodie; my $file = 'C:\perl_old_test\TRP_ligands_PDB\21Q.txt' local @ARGV = ($file); local $^I = '.bak'; while (&lt;&gt;) { print if ! /\bCONECT\b/ } unlink "$file$^I"; </code></pre> <p>For additional methods for editing a file, read: <a href="http://perldoc.perl.org/perlfaq5.html#How-do-I-change%2c-delete%2c-or-insert-a-line-in-a-file%2c-or-append-to-the-beginning-of-a-file%3f" rel="nofollow">How do I change, delete, or insert a line in a file, or append to the beginning of a file?</a></p>