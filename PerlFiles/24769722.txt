Delete the first line using Tie::File without leave a newline at the end of the file
<p>I use the following code to delete the first line of a file:</p> <pre><code>use Tie::File; tie @task_queue, 'Tie::File', $queue_path or die $!; shift @task_queue; $#task_queue -= 1; untie @task_queue; </code></pre> <p>The file content is like:</p> <pre><code>line1 line2 line3 </code></pre> <p>But when I use the code, it will delete the line1 but leave a newline at the end of the file like this:</p> <pre><code>line2 line3 # &lt;- here is a blank line </code></pre> <p>Since I use this file as a queue, if I add some new line after, it will become:</p> <pre><code>line2 line3 # &lt;- here is a blank line line4 </code></pre> <p>So is there any way to avoid leaving a blank line when using Tie::File to delete the first line?</p>
<p>I don't know if this is a good solution, but it removes blank lines at the end of the file.</p> <pre><code>while ($task_queue[-1] eq '') { pop @task_queue; } </code></pre>
<p>Thanks to all that help with this. I found a solution, it's not beautiful code but works. I also found that the blank line is still generated even if I do only <strong>tie</strong> and <strong>untie</strong>(no action between them). It may be some design issue of the module.</p> <pre><code>use Tie::File; tie @task_queue, 'Tie::File', $queue_task_path or die $!; shift @task_queue; untie @task_queue; print("Removing the blank line.\n"); my $queue_task_file_size = -s $task_queue; truncate($task_queue, $queue_task_file_size - 1); </code></pre>