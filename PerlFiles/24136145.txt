retrieve child thread output in the mid of child thread execution
<p>I am writing a perl script using <a href="https://metacpan.org/pod/threads" rel="nofollow"><code>threads</code></a> and <a href="https://metacpan.org/pod/threads%3a%3ashared" rel="nofollow"><code>threads::shared</code></a> modules where parent process can retrieve the result of child thread in the mid of child execution. </p> <p>For eg. i need to get the output of child thread when flag=1 in the following script</p> <pre><code>#!/usr/bin/perl use strict; use warnings; use threads; use threads::shared; my $flag : shared = 0; my $num : shared = 0; my $thr = new threads(\&amp;sub1); my @res = $thr-&gt;join(); print "@res" if ($flag != 0); sub sub1 { for( $num=0;$num&lt;1000;$num++) { print "$num\t"; } print "\n"; $flag = 1; sleep(5); for( $num=50;$num&lt;100;$num++)`enter code here` { print "$num\t"; } print "\n"; } </code></pre>
<p>You want to wait inside and outside the thread for the flag to be set/unset. See the comments in the code:</p> <pre><code>#!/usr/bin/perl use strict; use warnings; use threads; use threads::shared; my $flag : shared = 0; my $num : shared = 0; my $thr = new threads(\&amp;sub1); # do some things here #wait for thread to set the flag while( $flag == 0) {} print "Outside thread: num=$num\n"; #unset flag so thread can continue $flag = 0; # do some things here #block until thread finishes my @res = $thr-&gt;join(); print "Outside thread: num=$num\n"; print @res; sub sub1 { #do initial calculations in thread for( $num=0;$num&lt;1000;$num++) { print "$num\t"; } print "\n"; #set flag to parent can read value $flag = 1; #wait for parent to unset the flag while($flag==1) {} #continue with rest of thread for( $num=50;$num&lt;100;$num++) { print "$num\t"; } print "\n"; return "I'm done\n"; } </code></pre>