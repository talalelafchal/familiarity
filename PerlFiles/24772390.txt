Interchange columns of an Excel file using perl
<p>I have a tab delimited Excel file with 65 columns and 350 rows. I need to rearrange it such that columns 60-65 are inserted after column1 , followed by col2, col3 ... col 59 using only PERL .. i.e.</p> <p>Col1 Col60 Col61 Col62 Col2 Col3 Col4 Col5 Col6</p> <p>I wrote a shell command to do it :</p> <p>paste &lt;(awk -F '\t' '{print $1}' part.xls ) &lt;(awk -F '\t' '{print $60}' part.xls ) &lt;(awk -F '\t' '{print $61}' part.xls ) &lt;(awk -F '\t' '{print $62}' part.xls ) &lt;(awk -F '\t' -v f=2 -v t=59 '{ for (i=f; i&lt;=t;i++) printf("%s\t%s", $i,(i==t) ? "\n" : OFS) }' part.xls) > new.xls</p> <p>part.xls = original file with 65 columns new.xls = file with reordered columns</p> <p>I need to incorporate this into my PERL script . I tried using system command but it gave me errors.</p> <p>system("paste &lt;(awk -F '\t' '{print \$1}' part.xls ) &lt;(awk -F '\t' '{print \$60}' part.xls ) &lt;(awk -F '\t' '{print \$61}' part.xls ) &lt;(awk -F '\t' '{print \$62}' part.xls ) &lt;(awk -F '\t' -v f=2 -v t=59 '{ for (i=f; i&lt;=t;i++) printf("%s\t%s", $i,(i==t) ? "\n" : OFS) }' part.xls) > new.xls");</p> <p>Can someone plz point out my mistake ? Thanks in advance.</p>
<p>Your <code>awk</code> code can be simplified:</p> <pre><code>awk -F"\t" ' { printf("%s\t%s\t%s\t%s", $1, $60, $61, $62) for (i=2; i&lt;=59; ++i) printf("\t%s", $i) print "" } ' part.xls &gt; new.xls </code></pre> <p>But since you're already using <code>perl</code> (which is a kind of "super awk"!), you may as well just do something like this:</p> <pre><code>open(my $fin, "&lt;", "part.xls") or die("Can't open part.xls: $!"); open(my $fout, "&gt;", "new.xls") or die("Can't open new.xls: $!"); while (&lt;$fin&gt;) { my @f = split(/\t/); my $lineout = join("\t", $f[0], @f[59..61], @f[1..58]); print $fout $lineout, "\n"; } close($fin); close($fout); </code></pre> <p>Note that the field indices are zero-based in <code>perl</code>, whereas they are one-based in <code>awk</code>, so in <code>perl</code> they are all one less.</p>