Perl sub loops could not reset iterate interal variable
<p>When go into sub loops after jumped from it in next time, the iterate of sub loop should start from begin:</p> <pre><code>#!perl use 5.014; my %hash = ( "a" =&gt; 1, "b" =&gt; 2 , "c" =&gt; 3); my $pos = 0; POS: while ($pos &lt; 4) { $pos++; while (my ($key, $value) = each %hash) { say "key: $key value: $value"; next POS; } } </code></pre> <p>But the result is as follows:</p> <pre><code>$ perl bugs-loop.pl key: c value: 3 key: a value: 1 key: b value: 2 </code></pre> <p>How to get following result:</p> <pre><code>key: c value: 3 key: c value: 3 key: c value: 3 </code></pre>
<blockquote> <p><a href="http://perldoc.perl.org/functions/keys.html" rel="nofollow"><code>keys</code></a> resets the iterator. resets the internal iterator of the HASH or ARRAY (see <code>each</code>). In particular, calling <code>keys</code> in void context resets the iterator with no other overhead.</p> </blockquote> <pre><code>#!perl use 5.014; my %hash = ( "a" =&gt; 1, "b" =&gt; 2 , "c" =&gt; 3); my $pos = 0; POS: while ($pos &lt; 4) { $pos++; while (my ($key, $value) = each %hash) { say "key: $key value: $value"; keys %hash; # Reset iterator since we're bailing out. next POS; } } </code></pre>