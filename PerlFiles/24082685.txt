Require perl 5.10 for only some functions
<p>I have a library of perl routines which I load in perl scripts with </p> <pre><code>do "/path/to/library"; </code></pre> <p>Most of the functions in the library will run fine on perl >= 5.000 . However, one of the functions relies on perl >= 5.010 because it uses threading.</p> <p>Is there a clean way to allow programs to run on, say, perl 5.008, and load the library, and only fail at runtime if they try to access the restricted function?</p> <p>I tried</p> <pre><code>sub threadMap{ use 5.010; #need perl 5.10 threads or else you get confusing error messages my %arg = @_; </code></pre> <p>but perl seems to evaluate 'use' on just reading the library file:</p> <pre><code>[js21n17][/u/jamie/bin]&gt; ./jdPerlLib.pl Perl v5.10.0 required--this is only v5.8.8, stopped at ./jdPerlLib.pl line 12230. BEGIN failed--compilation aborted at ./jdPerlLib.pl line 12230. </code></pre> <p>I will use this perlvar <a href="http://perldoc.perl.org/perlvar.html#" rel="nofollow">http://perldoc.perl.org/perlvar.html#</a>$^V but thought I would ask for wisdom here in case that's a terrible idea.</p>
<p>For a run-time check, you can use</p> <pre><code>require 5.010; </code></pre> <p>You can also check using</p> <pre><code>if ($] &gt;= 5.010) { ... } </code></pre> <p>That said, 5.8 supported threads too. You should probably be using</p> <pre><code>require threads; </code></pre> <p>You can also check using</p> <pre><code>use Config qw( %Config ); if ($Config{usethreads}) { ... } </code></pre>