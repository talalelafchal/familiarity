Confused about multilingual collation in Perl
<p>Just when I thought I understood multilingual collation in Perl...</p> <p>I'm getting what appears to be different results for the relative ordering of $ and % when I use Unicode collation, compared to when I use plain old "cmp". I don't think my Unicode result is correct.</p> <p>The following script outputs:</p> <pre><code>Vanilla collation: alpha CMP beta for is -1 # I get it: "alpha" comes before "beta" Unicode::Collate collation: alpha CMP beta is -1 # I get it: "alpha" comes before "beta" Vanilla collation: $ CMP % for is -1 # I get it $ comes before % Unicode::Collate collation: $ CMP % is 1 # So why is this result different? </code></pre> <h2>So that's my question: Why does Unicode collation think that % comes before $ ?</h2> <pre><code>use HTML::Entities; use Unicode::Collate::Locale; require 'Unicode/Collate/Locale/fr.pl'; my $COLL = Unicode::Collate::Locale-&gt;new( locale =&gt; "fr", ); { my $a_text = "alpha"; my $b_text = "beta"; my $result = $a_text cmp $b_text; # returns 1, 0, or -1. printf qq(Vanilla collation: %s CMP %s for $lang is %s\n), $a_text, $b_text, $result; my $result1 = $COLL-&gt;cmp( $a_text, $b_text ); # returns 1, 0, or -1. printf qq(Unicode::Collate collation: %s CMP %s is %s\n), $a_text, $b_text, $result1; } { my $a_text = "\$"; my $b_text = "%"; my $result = $a_text cmp $b_text; # returns 1, 0, or -1. printf qq(Vanilla collation: %s CMP %s for $lang is %s\n), $a_text, $b_text, $result; my $result1 = $COLL-&gt;cmp( $a_text, $b_text ); # returns 1, 0, or -1. printf qq(Unicode::Collate collation: %s CMP %s is %s\n), $a_text, $b_text, $result1; } </code></pre>
<p>The results are correct.</p> <p>The <a href="http://www.unicode.org/reports/tr10/" rel="nofollow">Unicode Collation Algorithm</a> defines how things are ordered, with the help of the <a href="http://www.unicode.org/Public/UCA/latest/allkeys.txt" rel="nofollow">mappings</a> which include the following:</p> <pre><code>0024 ; [.15BA.0020.0002] # DOLLAR SIGN 0025 ; [*037A.0020.0002] # PERCENT SIGN </code></pre>