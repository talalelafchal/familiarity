Encoding newline, quotes and special character with Perl Mechanize
<p>I'm trying to develop a PERL program with Mechanize that will allow me to repost content from my website on another website. But I have some problems with encoding :</p> <ul> <li>there isn't newline in the other website when I repost my content</li> <li>the quotes are not interpreted</li> <li>the symbol like € are not interpreted too</li> </ul> <p>My website is encoded with UTF-8 and the other website is encoded with ISO-8859-15. Here is a sample of the data on my website and the result posted on the other website :</p> <p><em>10 M€ d'encours/10 M? d?encours</em></p> <p>here is my PERL program :</p> <pre><code>#!/usr/bin/perl use utf8; use strict; use warnings; use WWW::Mechanize; use HTML::TreeBuilder; use HTML::TreeBuilder::XPath; my $mech = WWW::Mechanize-&gt;new( stack_depth =&gt; 0, timeout =&gt; 10, ); $mech-&gt;get("RecoveredDataFromMyWebsiteUrl"); my $tree = HTML::TreeBuilder::XPath-&gt;new_from_content($mech-&gt;content); my $data = $tree-&gt;findvalue('/html/body//div[@id="content"]'); $data = Encode::encode("iso-8859-15",$data); $mech-&gt;get("OtherWebsiteFormularUrl"); $mech-&gt;form_name("formular")-&gt;accept_charset('iso-8859-15');# Form Post Emploi $mech-&gt;set_fields( content =&gt; $data ); $mech-&gt;submit; open FIC,"&gt;output.html" or die "E/S : $!\n"; my $out = select(FIC5); print $mech-&gt;content; </code></pre>
<p>I would change a few things about how you are crawling the site, but maybe trying to do this when trying to write to a file when encoding utf8:</p> <pre><code>my $out_file = 'output.html'; open ( my $fh, "&gt;:encoding(utf8)", $out_file) or die; </code></pre>