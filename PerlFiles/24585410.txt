Eval string string only if it is an assignment statement in perl
<p>I have a string with a hash table, that I would like to assign to a reference variable using Perl <code>eval</code>. Consider:</p> <pre><code>use warnings; use strict; use Data::Dump qw(dump); my $h; my $str=q/$h={a=&gt;'a',b=&gt;'b'}/; eval($str); if ($@) { print "An error occured processing the string\n"; die $@; } dump($h); </code></pre> <p>The problem is that the string is actually supplied by the user (read from file), and I would like to prevent malicious code to be executed in the <code>eval</code>. Is it possible to check that the string only represents a variable assignment (not code like <code>unlink my_important_file;</code>)?</p>
<p>Take a look to the module <a href="https://metacpan.org/pod/Quote%3a%3aRef" rel="nofollow">Quote::Ref</a>.</p>
<p>If you really do need to evaluate user input, use <a href="https://metacpan.org/pod/Safe" rel="nofollow"><code>Safe</code></a>. Example usage <a href="http://www.daniweb.com/software-development/perl/code/216821/an-extremely-safe-eval" rel="nofollow">here</a>.</p>