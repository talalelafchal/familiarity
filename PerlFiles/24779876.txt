Failed to detect DLL path in Win32::API
<p>I am trying to import a C++ DLL in Perl (Active Perl 5.12.2 Build 1202). My Subroutine for this is:</p> <pre><code>sub _import { my ($func,$params)=@_; print "DLL Pass value: $func $params \n"; my $retVal= new Win32::API($MY_DLL,$func,$params,'I'); croak("Failed to import $func from $MY_DLL \n") if(!$retVal); return $retVal; } </code></pre> <p>I have added <code>use Win32::API;</code> and I have defined <code>use constant MY_DLL =&gt; 'D:\MyData\MYDLL_CON'; # name of the dll</code></p> <p>What I get when I call <code>_import("Init",'P');</code> ("Init" function which accepts a pointer), Command line prints:</p> <p><code>DLL Pass value: Init P Failed to import Init from</code></p> <p>Note that there is a &lt; Space > after "from". DLL exists on the path but still it WIN32:API function treats it as blank! Same perl script works on certain machine and doesn't work (gives above error) on certain machine. All machines have same configuration plus same version of Perl and everything. But It finds the DLL on few machines and doesn't on rest!</p> <p>Dependency Walker doesn't show any dependency errors for the DLL.</p> <p>I am clueless what's happening!</p>
<p><code>$MY_DLL</code> is not the same thing as <code>MY_DLL</code>. Get rid of the <code>$</code>.</p>