Perl script to create a SSH session to a remote machine using Putty and execute commands from a Windows machine
<p>I want to create an SSH session to a remote machine using Perl, and execute commands automatically from a Windows machine. Is there a way I can do that?</p>
<p>The <code>Net::SSH</code> module relies on a command-line <code>ssh</code> tool, which Windows doesn't have straight from the box.</p> <p>I suggest you use Putty's <code>plink</code> command instead of <code>putty</code> itself, as <code>plink</code> is much closer to an <code>ssh</code> command-line utility and is intended for this sort of thing. Together with <a href="https://metacpan.org/module/IPC%3a%3aOpen3" rel="nofollow"><code>IPC::Open3</code></a> (or <a href="https://metacpan.org/module/IPC%3a%3aOpen2" rel="nofollow"><code>IPC::Open2</code></a> if you're not interested in seeing the output to STDERR) it will let you <code>print</code> commands and and <code>readline</code> the responses interactively. I am sure you can create your own log files.</p> <p>Alternatively you could consider <a href="https://metacpan.org/module/Net%3a%3aSSH%3a%3aW32Perl" rel="nofollow"><code>Net::SSH::W32Perl</code></a>, which is a compatibility layer around <a href="https://metacpan.org/module/Net%3a%3aSSH%3a%3aPerl" rel="nofollow"><code>Net::SSH::Perl</code></a>. It is rather old but should be better than relying on Putty.</p>