How can I, using Perl, filter out IP addresses from a log file or any other file?
<p>I am trying to find out how I can use Perl to scan thru a specific file and find all the IP addresses and block them so that I can convert the numbers in the IP address to x's. For example: 194.66.82.11 and after the code runs it is formatted like <code>xxx.xx.xx.11</code> instead of just removing it completely. This is in unix. </p>
<p>To match 4 numbers (with a maximum length of 3) separated with a period you can use the following regex:</p> <pre><code>(?:[0-9]{1,3}\.){3}([0-9]{1,3}) </code></pre> <p>You can access the last capturing group (the first is a non-capturing group) with <code>\1</code> when replacing, thus <code>xxx.xxx.xxx.\1</code>, for instance. Note that the result will not have the same number of <code>x</code>s as the original IP had digits. If that's a problem you'd have to tweak the regex.</p>
<p>You've stated in the comments that you're working with a log file:</p> <pre><code>192.168.72.177 - - [22/Dec/2002:23:32:19 -0400] "GET /search.php HTTP/1.1" 400 1997 www.yahoo.com "-" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; ...)" "-" – </code></pre> <p>I therefore suggest that you just edit the first field of the log file to achieve your result.</p> <p>Using a perl one-liner</p> <pre><code>perl -lane '$F[0] =~ s/\d(?=.*\.)/x/g; print "@F"' file.log </code></pre> <p>Outputs:</p> <pre><code>xxx.xxx.xx.177 - - [22/Dec/2002:23:32:19 -0400] "GET /search.php HTTP/1.1" 400 1997 www.yahoo.com "-" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; ...)" "-" – </code></pre>