Loop through text files, replace consecutive asterisks with 0.00
<p>all,</p> <p>I am writing a matlab program to read in text data and rearrange it. Now I am meeting with a new problem. </p> <p>When I am writing data out to csv file, there are randomly missing data noted as ******, as shown below causing my program to terminate. </p> <pre><code>2055 6 17 24.2 29.57 7.02****** 0.99 2.65 2.73 4.09 0.11 </code></pre> <p>Any one can help me with a small program to loop through all the text files in the folder, and replace the consecutive stars, with 0.00? The stars are always in columns 33 to 38, occupying 6 spaces. I want it to be changed to be two spaces followed by 0.00.</p> <p>Thanks, James </p>
<p>For a given text file, you can read it into memory, replace the asterisks with the desired text, and then overwrite the original text file:</p> <pre><code>filename = 'blah.txt' % Read it into memory fid = fopen(filename, 'r'); scanned_fields = textscan(fid, '%s', 'Delimiter','\n'); fclose(fid); % The first (and only) field of textscan will be our cell array of text lines = scanned_fields{1}; % Replace the asterisks with the desired text lines = strrep(lines, '******', ' 0.00'); % Overwrite the original file fid = fopen(filename, 'w'); fprintf(fid, '%s\n', lines{:}); fclose(fid); </code></pre> <p>To do this for all of the text files in your directory, you can use <code>dir</code> to get a list of files in your current directory that end in ".txt":</p> <pre><code>files = dir('*.m'); filenames = {files.name}; </code></pre> <p>And then loop over the files:</p> <pre><code>for ii = 1:length(filenames) filename = filenames{ii}; % Read it into memory fid = fopen(filename, 'r'); scanned_fields = textscan(fid, '%s', 'Delimiter','\n'); fclose(fid); lines = scanned_fields{1}; % Replace the asterisks with the desired text lines = strrep(lines, '******', ' 0.00'); % Overwrite the original file fid = fopen(filename, 'w'); fprintf(fid, '%s\n', lines{:}); fclose(fid); % Go on to the next file end </code></pre> <p>And of course, I would recommend creating a backup copy of this directory before running this, just in case something unexpected comes up.</p>