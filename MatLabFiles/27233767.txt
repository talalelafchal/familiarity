Double summation in matlab
<p>I've got a (beginners)question about matlab. I have tried several things (e.g.: write it as a vectorized loop or write it as an 'if-loop' and compute the sum explicitly), but I keep making mistakes and therefore, I keep getting errors in matlab.</p> <p>I have to maximize the following function: </p> <pre><code>\sum_{i=1}^{L} \sum_{k=1}^K (r_k^3 t_{ik}) </code></pre> <p>with L, K, r_k known. Also, t_ik are desicion variables, so they have values in {0,1}.</p> <p>Any help would be appreciated.</p>
<p>If anyone comes looking, the correct way to do this is</p> <pre><code>sum(sum(a)) </code></pre> <p>where a is your matrix. This scales to more dimensions as well. </p>
<p>If you're seeking a more vectorized result, you can create the products within the summation by <a href="http://www.mathworks.com/help/matlab/ref/bsxfun.html" rel="nofollow"><code>bsxfun</code></a>, then <a href="http://www.mathworks.com/help/matlab/ref/sum.html" rel="nofollow"><code>sum</code></a> over the entire matrix to get your answer (Ã  la Adam Farabaugh). Your equation in LaTeX form looks like this (easier for me to read):</p> <p><img src="http://latex.codecogs.com/gif.latex?%5Csum_%7Bi%3D1%7D%5E%7BL%7D%20%5Csum_%7Bk%3D1%7D%5EK%20%28r_k%5E3%20t_%7Bik%7D%29" alt=""></p> <p>It looks like <code>t</code> is a 2D matrix while <code>r</code> is a vector. With the above statement, it looks like you are taking each row of <code>t</code>, and multiplying this row in an element-by-element fashion with <code>r</code> with each element in <code>r</code> raised to the third power. You repeat this for all of the rows in <code>t</code>, then sum up the results. Assuming that <code>r</code> is a row vector, and the amount of columns in <code>t</code> matches the number of elements in <code>r</code>, do something like this:</p> <pre><code>prods = bsxfun(@times, r.^3, t); result = sum(prods(:)); </code></pre> <p>The first statement will take <code>r</code> and creates a matrix where each row of this matrix will be a copy of <code>r</code> raised to the third power. This is a consequence of <code>bsxfun</code>, which is short for <strong>Binary Singleton EXpansion FUNction</strong>. In a nutshell, it replicates whatever dimension(s) of the variable that has the smaller dimensions between the two, and replicates the elements so that both variables match in size.</p> <p>We then take this new matrix and do an element-by-element multiplication with the matrix <code>t</code>. Once we do this, we simply sum over all of the elements in this matrix. You can nest <code>sum</code> calls like what Adam suggests, but if you really want to make it more general, you can simply <strong>unroll</strong> the matrix so that it's a single vector, then apply <code>sum</code> on this single vector.</p>
<p>You are describing a double for loop:</p> <pre><code>result=0; for i=1:L for k=1:K result=r(K)^3*t(i*k)+result ; end end </code></pre> <p>However I believe that your problem is not related to matlab, you just dont know how to convert from maths to code.</p>