How to concatenate submatrix into a bigger matrix in Octave
<p>I'm trying to solve the following issue: I have an 3x3x4 array like this:</p> <pre><code>A(:,:,1) = A(:,:,2) = A(:,:,3) = A(:,:,4) = 1 1 1 2 2 2 3 3 3 4 4 4 1 1 1 2 2 2 3 3 3 4 4 4 1 1 1 2 2 2 3 3 3 4 4 4 </code></pre> <p>I would like to produce a 6x6 matrix like the following:</p> <pre><code>B = 1 1 1 3 3 3 1 1 1 3 3 3 1 1 1 3 3 3 2 2 2 4 4 4 2 2 2 4 4 4 2 2 2 4 4 4 </code></pre> <p>My first thought was to use something like the reshape function, but since it operates columnwise, the result is not what I want.</p> <p>Do you have any ideas to perform it efficiently?</p> <p>Thanks in advance</p>
<p>Since your sub-matrices are all of the same size you can assign them directly into B:</p> <pre><code>clear B = zeros(6); A(:,:,1) = ones(3); A(:,:,2) = 2*ones(3); A(:,:,3) = 3*ones(3); A(:,:,4) = 4*ones(3); B = [A(:,:,1) A(:,:,3); A(:,:,2) A(:,:,4)] B = 1 1 1 3 3 3 1 1 1 3 3 3 1 1 1 3 3 3 2 2 2 4 4 4 2 2 2 4 4 4 2 2 2 4 4 4 </code></pre> <p>This might prove cumbersome if you have many more sub-matrices though but that could be automated.</p>
<p>This is for a general case of converting a <code>3D</code> array into such a <code>2D</code> array -</p> <pre><code>m = 2; %// number of 3D slices to be vertically concatenated to form the rows m1 = size(A,1)*m; m2 = size(A,3)/m; B = reshape(permute(reshape(permute(A,[1 3 2]),m1,m2,[]),[1 3 2]),m1,[]) </code></pre> <p>Sample run -</p> <pre><code>A(:,:,1) = 1 1 7 1 9 1 1 7 2 A(:,:,2) = 3 9 2 9 4 7 9 3 7 A(:,:,3) = 2 6 8 4 8 4 1 8 4 A(:,:,4) = 1 1 7 8 3 4 1 9 8 A(:,:,5) = 7 9 2 6 8 5 4 1 6 A(:,:,6) = 3 2 8 4 9 1 4 4 4 B = 1 1 7 2 6 8 7 9 2 1 9 1 4 8 4 6 8 5 1 7 2 1 8 4 4 1 6 3 9 2 1 1 7 3 2 8 9 4 7 8 3 4 4 9 1 9 3 7 1 9 8 4 4 4 </code></pre>
<p><code>permute</code> is much more efficient (à la Divakar) or manually slicing into a 2D array (à la Benoit), but I'll add something to the mix for future readers. One way I can suggest is to take each plane and place it into a 1D cell array, reshape the cell array into a 2 x 2 grid, then convert the 2 x 2 grid into a final matrix. Something like:</p> <pre><code>B = arrayfun(@(x) A(:,:,x), 1:4, 'uni', 0); B = reshape(B, 2, 2); B = cell2mat(B) B = 1 1 1 3 3 3 1 1 1 3 3 3 1 1 1 3 3 3 2 2 2 4 4 4 2 2 2 4 4 4 2 2 2 4 4 4 </code></pre>