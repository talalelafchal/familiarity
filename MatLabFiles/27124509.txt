How to multiply matrix of nxm with matrix nxmxp different dimensions in matlab
<p>In my current analysis, I am trying to multiply a matrix (flm), of dimension <em>nxm</em>, with the inverse of a matrix <em>nxmxp</em>, and then use this result to multiply it by the inverse of the matrix (flm). </p> <p>I was trying using the following code: </p> <pre><code>flm = repmat(Data.fm.flm(chan,:),[1 1 morder]); %chan -&gt; is a vector 1by3 A = (flm(:,:,:)/A_inv(:,:,:))/flm(:,:,:); </code></pre> <p>However. due to the problem of dimensions, I am getting the following error message: Error using ==> mrdivide Inputs must be 2-D, or at least one input must be scalar. To compute elementwise RDIVIDE, use RDIVIDE (./) instead.</p> <p>I have no idea on how to proceed without using a <em>for</em> loop, so anyone as any suggestion?</p>
<p>I think you are looking for a way to conveniently multiply matrices when one is of higher dimensionality than the other. In that case you can use <code>bxsfun</code> to automatically 'expand' the smaller matrix.</p> <pre><code>x = rand(3,4); y = rand(3,4,5); bsxfun(@times,x,y) </code></pre> <p>It is quite simple, and very efficient.</p> <p>Make sure to check out <code>doc bsxfun</code> for more examples.</p>