Fastest way to export a 2d matrix to a triples format CSV file in Matlab
<p>I want to convert a 2d matrix, for example:</p> <pre><code>10 2 3 5 </code></pre> <p>to a (row,col,value) CSV file, for example:</p> <pre><code>1,1,10 1,2,2 2,1,3 2,2,5 </code></pre> <p>is it possible to do it in a single Matlab command?</p>
<p>Assuming <code>A</code> to be the input matrix, two approaches can be suggested here.</p> <p><strong><a href="http://in.mathworks.com/help/matlab/ref/fprintf.html" rel="nofollow"><code>fprintf</code></a></strong> based solution -</p> <pre><code>output_file = 'data.txt'; %// Edit if needed to be saved to a different path At = A.'; %//' [y,x] = ndgrid(1:size(At,1),1:size(At,2)); fid = fopen(output_file, 'w+'); for ii=1:numel(At) fprintf(fid, '%d,%d,%d\n',x(ii),y(ii),At(ii)); end fclose(fid); </code></pre> <hr> <p><strong><a href="http://in.mathworks.com/help/matlab/ref/dlmwrite.html" rel="nofollow"><code>dlmwrite</code></a></strong> based approach -</p> <pre><code>At = A.'; %//' [y,x] = ndgrid(1:size(At,1),1:size(At,2)); dlmwrite(output_file,[x(:) y(:) At(:)]); </code></pre> <p><strong>Some quick tests</strong> seem to suggest that <code>fprintf</code> performs better across varying input datasizes.</p>
<p>I didn't find a way with a single command, but try the following code:</p> <pre><code>[i1,i2] = ind2sub(size(A),1:numel(A)); csvwrite('test.csv',[i2',i1',reshape(A',numel(A),1)]); </code></pre> <p>The output is:</p> <pre><code>type test.csv 1,1,10 1,2,2 2,1,3 2,2,5 </code></pre>