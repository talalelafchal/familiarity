Normalized cut: what does this code do?
<p>I'm going through some <a href="http://www.cis.upenn.edu/~jshi/software/" rel="nofollow">MATLAB code for Normalized Cut for image segmentation</a>, and I can't figure out what this code below does:</p> <pre><code>% degrees and regularization d = sum(abs(W),2); dr = 0.5 * (d - sum(W,2)); d = d + offset * 2; dr = dr + offset; W = W + spdiags(dr,0,n,n); </code></pre> <p><code>offset</code> is defined to be 0.5.</p> <p><code>W</code> is a square, sparse, symmetric matrix (<code>w_ij</code> is defined by the similarity between pixels <code>i</code> and <code>j</code>). <code>W</code> is then used to solve the eigenvalue problem <code>d^(-1/2)(D-W)d^(-1/2) x = \lambda x</code></p> <p>The <code>w_ij</code>'s are all positives because of the way the weights are defined, so <code>dr</code> is a vector of 0's.</p> <p>What are the offsets for? How are they chosen? What's the reason behind <code>offset*2</code>? I have the feeling this is to avoid some potential pitfalls in certain cases. What could these be? </p> <p>Any help would be really appreciated, thanks!</p>
<p>I believe you came across a piece of code written by <a href="http://www1.icsi.berkeley.edu/~stellayu/" rel="nofollow">Prof Stella X Yu</a>.<br> Indeed, when <code>W</code> is positive this code has no effect and this is the usual case for NCuts.<br> However, in a <a href="http://www.eecs.berkeley.edu/Research/Projects/CS/vision/stellayu/doc/cvpr01.pdf" rel="nofollow">CVPR 2001 paper</a> Yu and Shi extend NCuts to handle <strong>negative</strong> interactions as well as positive ones. In these circumstances <code>dr</code> (r for "repulsion") plays a significant role.</p> <p>Speaking of negative weights, I must say that personally I do not agree with the approach of Yu and Shi.<br> I strongly believe that when there is repulsion information <a href="http://www.wisdom.weizmann.ac.il/~bagon/pub/LargeScaleCorrClust_2011.pdf" rel="nofollow">Correlation Clustering</a> is a far better objective function than the extended NCuts objective. Results of some image segmentation experiments I conducted with negative weights suggested that Correlation clustering objective is better than the extended NCuts.</p>