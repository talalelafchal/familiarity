on the use and understanding of pwelch in matlab
<p>I'm using the pwelch method in matlab to compute the power spectra for some wind speed measurements. So, far I have written the following code as an example:</p> <pre><code>t = 10800; % number of seconds in 3 hours t = 1:t; % generate time vector fs = 1; % sampling frequency (seconds) A = 2; % amplitude P = 1000; % period (seconds), the time it takes for the signal to repeat itself f1 = 1/P; % number of cycles per second (i.e. how often the signal repeats itself every second). y = A*sin(2*pi*f1*t); % signal fh = figure(1); set(fh,'color','white','Units', 'Inches', 'Position', [0,0,6,6],... 'PaperUnits', 'Inches', 'PaperSize', [6,6]); [pxx, f] = pwelch(y,[],[],[],fs); loglog(f,10*(pxx),'k','linewidth',1.2); xlabel('log10(cycles per s)'); ylabel('Spectral Density (dB Hz^{-1})'); </code></pre> <p><em>I cannot include the plot as I do not have enough reputation points</em></p> <p>Does this make sense? I'm struggling with the idea of having noise at the right side of the plot. The signal which was decomposed was a sine wave with no noise, where does this noise come from? Does the fact that the values on the yaxis are negative suggest that those frequencies are negligible? Also, what would be the best way to write the units on the y axis if the wind speed is measured in m/s, can this be converted to something more meaningful for environmental scientists?</p>
<p>Your results are fine. <code>dB</code> can be confusing.</p> <p>A linear plot will get a good view,</p> <pre><code>Fs = 1000; % Sampling frequency T = 1/Fs; % Sample time L = 1000; % Length of signal t = (0:L-1)*T; % Time vector y = sin(2 * pi * 50 * t); % 50Hz signal </code></pre> <p>An <code>fft</code> approach,</p> <pre><code>NFFT = 2^nextpow2(L); % Next power of 2 from length of y Y = fft(y,NFFT)/L; f = Fs/2*linspace(0,1,NFFT/2+1); subplot(1,2,1); plot(f,2*abs(Y(1:NFFT/2+1))) xlabel('Frequency (Hz)') ylabel('|Y(f)|') </code></pre> <p><code>pwelch</code> approach,</p> <pre><code>subplot(1,2,2); [pxx, freq] = pwelch(y,[],[],[],Fs); plot(freq,10*(pxx),'k','linewidth',1.2); xlabel('Frequency (Hz)'); ylabel('Spectral Density (Hz^{-1})'); </code></pre> <p><img src="https://i.stack.imgur.com/S2pXL.png" alt="enter image description here"></p> <p>As you can see they both have peak at <code>50Hz</code>.</p> <p>Using <code>loglog</code> for both,</p> <p><img src="https://i.stack.imgur.com/gpUWX.png" alt="enter image description here"></p> <p>So "noise" is of <code>1e-6</code> and exists in <code>fft</code> as well, and can be ignored.</p> <p>For your second question, I don't think the axis will change it will be <code>frequency</code> again. For <code>Fs</code> you should use the sampling frequency of wind speed, like if you have <code>10</code> samples of speed in one second your <code>Fs</code> is <code>10</code>. Higher frequencies in your graph means more changes in wind speed and lower frequencies represent less changes for the speed.</p>