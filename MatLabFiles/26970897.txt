p = NaN for goodness of fit matlab
<p>Hi have a set of observations <code>obs</code> = <a href="https://drive.google.com/file/d/0B3vXKJ_zYaCJVlhqd3FJT0xtWFk/view?usp=sharing" rel="nofollow">https://drive.google.com/file/d/0B3vXKJ_zYaCJVlhqd3FJT0xtWFk/view?usp=sharing</a></p> <p>I would like to prove that they come from a Gamma distributions.</p> <p>To do that I:</p> <pre><code>%estimate parameters gamma distribution paramEsts_gamma = gamfit(obs); % estimate cdf gamma distribution (objects) gamma_cdf=makedist('Gamma','a',paramEsts_gamma(1),'b',paramEsts_gamma(2)); % test with kstest if data comes from a gamma distribution [h_gamma_ks,p_gamma_ks,kstat_gamma_ks,cv_gamma_ks] = kstest(obs,'CDF',gamma_cdf) % test with chi2gofif data comes from a gamma distribution pd_gamma = fitdist(obs,'Gamma'); [h_gamma_chi,p_gamma_chi,st_gamma_chi] = chi2gof(obs,'CDF',pd_gamma) </code></pre> <p>My problem is that I get NaN for the pvalue <code>p_gamma_chi</code>.... Where do I make a mistake? Thanks</p> <p>Here some code to check visually the distributions</p> <pre><code>%% Plot cdf % empirical cdf [f_emp,x_values] = ecdf(obs); f_gamma = gamcdf(x_values,paramEsts_gamma(1),paramEsts_gamma(2)); figure hold on; F = plot(x_values,f_emp); set(F,'LineWidth',2); G = plot(x_values,f_gamma,'r-'); set(G,'LineWidth',2); legend([F G],... 'Empirical CDF','Gamma CDF',... 'Location','SE'); </code></pre>
<p>As the output of your code shows <code>st_gamma_chi.df = 0</code>, which means 0 degrees-of-freedom (<code>dof</code>).</p> <pre><code>dof = N - n - 1 </code></pre> <p>where: <br> <code>N</code> is the number of frequencies, in your case <code>N = length(st_gamma_chi.edges)-1 = 3</code>;<br> <code>n</code> is the number of fitted parameters, in your case <code>n = 2</code>.</p> <p>Thus you get 0 dof with the default options, you can ameliorate this issue for example by increasing the number of bins where the frequencies are calculated:</p> <p><code>[h_gamma_chi,p_gamma_chi,st_gamma_chi] = chi2gof(obs,'CDF',pd_gamma, 'NBins', 20)</code></p> <p>But this will not exempt you from understanding chi-squared test.</p>