Running Matlab GUI from C#
<p>In my project, I am integrating Matlab GUI application with in a C# application.</p> <p>The solution I thought about is to create a standalone application from the Matlab GUI and start it via a button in C#:</p> <pre><code>Process exeProcess = Process.Start("Data_Capture_Direct_call.exe"); if(!exeProcess.HasExited) { exeProcess.WaitForExit(); } exeProcess.Close(); </code></pre> <p>The problem is that after the splash screen of Matlab GUI is closed and before the actual program opens, C# detects that the program has been closed already and carries on to the next line.</p> <p>In addition, the next few lines of code are not properly executed:</p> <pre><code>List&lt;String&gt; Movement = new List&lt;String&gt;(); List&lt;String&gt; Repetition = new List&lt;String&gt;(); List&lt;String&gt; Duration = new List&lt;String&gt;(); using (CsvFileReader reader = new CsvFileReader("capture.csv")) { CsvRow row = new CsvRow(); while (reader.ReadRow(row)) { Movement.Add(row[0]); Repetition.Add(row[1]); Duration.Add(row[2]); } } for (int i = 1; i &lt; Movement.Count; i++) { dataGridView1.Rows.Add(i, Movement[i], Repetition[i], Duration[i]); } </code></pre> <p>What happens is that after the C# wrongly detects closure of the process, the capture.csv file becomes empty and data is not loaded into the data grid.</p> <p>Please let me know where I am making a mistake or if there is a better way to do this!</p>
<p>In my solution you should do some settings before starting code in order to use Matlab instance in a C# application.</p> <p>Adding neccessary dll : First we will add dll reference with COM interface. Click RMB on project and choose [Add Reference] option. In new window click COM tab. In search text box write 'Matlab'. Then choose "Matlab Application (Version 7.10) Type Library".</p> <p>You should get references like below : </p> <p><img src="https://i.stack.imgur.com/hyiE4.png" alt="enter image description here"></p> <p>Now you can easily do whatever you can do on Matlab in C# . Lets give an basic example : </p> <pre><code> var acCtx = Type.GetTypeFromProgID("matlab.application.single"); var matlab = (MLApp.MLApp)Activator.CreateInstance(acCtx); </code></pre> <p>these two lines are creating of matlab instance in code.Now let's make a easy computation on Matlab.</p> <pre><code> Console.WriteLine(matlab.Execute("1+2")); // This will output 3 on console. matlab.Quit(); // you should close matlab in order to clean memory </code></pre> <p>Lets give solution to your actual problem.You want to execute a Matlab GUI program.And I think your Gui is recording some data to CSV file.Then your C# program processes that data.You should note that you can call your GUI in Matlab just writing your name of program as command.Suppose that you have a GUI called myGui.m.You can call that gui by calling myGui in command line as you can write 1+2 to get 3.</p> <p>Let's call gui.</p> <pre><code>matlab.Execute("myGui"); // This will execute your Gui. You can use buttons to save data to CSV file matlab.Quit(); </code></pre> <p>I have extended example on this page : <a href="http://www.codeproject.com/Articles/594636/Using-Matlab-from-a-Csharp-application" rel="nofollow noreferrer">Source</a></p>