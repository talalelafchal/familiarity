Find frequency of elements above threshold for each cell in matlab
<p>I have a 4-D matrix. The dimensions are longitude, latitude, days, years as [17,14,122,16]. I have to find out frequency of values above 98 percentile for each cell so that final output comes as as array of 17x14 containing number of occurrence of values above 98 threshold. I did something which gives me a matrix 17x14 of values associated with 98 percentile for each cell but I am unable to determine the frequency of occurrences. </p> <pre><code>k=0; p=cell(1,238); r=cell(1,238); for i=1:17 for j=1:14 n=m(i,j,[1:122],[1:16]); n=squeeze(n); k=k+1; q=prctile(n(:),98); r{k}=nansum(nansum(n&gt;=q)); p{k}=q; end end </code></pre> <p>This code gives matrix p fine but matrix r contains same values for all cells. How can this be possible. What wrong am I doing in this. Please help. </p>