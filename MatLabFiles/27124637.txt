Matlab: Proper way to index vector; Error in Matrix dimension for index time series
<p>I am trying to implement this formula: <img src="https://i.stack.imgur.com/4nk1X.png" alt="expression"></p> <p>where y(t) is the output of an autoregressive process AR(2). t = 1,2,..,5000 data samples at equal intervals. p =2. The code throws the error </p> <pre><code>Error using - Matrix dimensions must agree. </code></pre> <p>This happens because I don't know how to represent the lags in index notation which is stored in variable <code>L1</code>. Can somebody please help in mitigating this error by showing the proper way to index? This is how I have done:</p> <pre><code>var_eps = 1; epsilon = sqrt(var_eps)*randn(5000,1); % Gaussian signal exciting the AR model Y(1) = 0.0; Y(2) = 0.0; for n= 3:5000 Y(n)= 0.1950*Y(n-1) -0.9500*Y(n-2)+ epsilon(n); %AR(1) model end p=2; t= p+1; rho0 = randn(); %c phi1 = 0.1950; phi2 = -0.9500; L1 = (Y(t:end) - rho0 - phi1.*Y(2:end) - phi2.*Y(1:end)).^2; L11 = sum(L1); </code></pre>
<p>That's because <code>Y(t:end)</code>, <code>Y(2:end)</code> and <code>Y(1:end)</code> are all of different lengths, so you can't add or subtract them. Probably easier to use a <code>for</code> loop:</p> <pre><code>L1 = 0; for t=p+1:5000 L1 = L1 + (Y(t) -rho0 - phi1*Y(t-1) - phi2*Y(t-2))^2; end </code></pre>