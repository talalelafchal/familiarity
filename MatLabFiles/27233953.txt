MATLAB Engine application tries to load incompatible DLLs from Windows\System32
<p>I wrote a <a href="http://www.mathworks.com/help/matlab/matlab_external/introducing-matlab-engine.html" rel="nofollow">MATLAB Engine</a> application that my colleagues need to use on their own Windows computers with different versions of MATLAB (i.e. the location of their MATLAB installation varies). In order for the application to find MATLAB libraries, <a href="http://www.mathworks.com/help/matlab/matlab_external/building-and-running-engine-applications-on-windows-operating-systems.html" rel="nofollow">MATLAB's <code>bin\win64</code> directory is <em>appended</em> to the PATH manually</a>.</p> <p>Some of these MATLAB libraries rely on other DLLs, such as <code>tbb.dll</code>, which also ship with MATLAB. On some computers an incompatible version of this DLL might be present in the <code>Windows\System32</code> directory as well, causing the MATLAB application to fail to start (as it tries to load the incompatible version).</p> <p><strong>How can I ensure that my MATLAB Engine application only tries to load the correct versions of these DLLs</strong>, found in MATLAB's installation directory, instead of incompatible versions found in <code>Windows\System32</code>?</p> <p><a href="http://stackoverflow.com/questions/25919667/writing-a-matlab-file-from-a-dll-called-by-labview">This</a> is probably related.</p>