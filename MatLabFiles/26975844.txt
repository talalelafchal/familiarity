Solve a PDE variable coefficient
<p>I am trying to solve a certain PDE (2 variables) using the PDEtoolbox.</p> <p>The equation is <code>-(laplacian)u + V*u = 1</code>, elliptic equation with <code>c</code> and <code>f</code> equal to <code>1</code>, and <code>a=V</code> which is a 2-variable function defined on a m-file. I have some issues with the definition of <code>V</code>. Here's the code of the file (<code>M</code> is a global Matrix already defined)</p> <pre><code>function v = V(x,y) global M [i,j]=size(M) intx=int32(floor(i*x)+1) inty=int32(floor(j*y)+1) v = M(intx,inty) </code></pre> <p>It is possible to plot the function, but when I try to put <code>V(x,y)</code> in the <code>a</code> field in 'PDE specifications', when I ask to solve the equation I get the following error message:</p> <pre><code>'Expression evaluates to wrong size. Must be scalar or row vector. In a system case, pass first or second row; for example u(2,:). In expression: '-ux' when evaluating pde coefficients.' </code></pre> <p>Any help would be welcome, explaining why this doesn't work or giving me another way to solve the equation.</p>