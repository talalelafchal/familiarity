Spatial cross correlation field of matrix
<p>I have 1000 observation stations over the US for which I need to get the cross-correlation matrix of size 1000x1000. I can do so by doing</p> <pre><code>[corelMat,pval] = corr([A1 A2 .... A1000],'type','kendall') </code></pre> <p>However, I want to put zero to those elements in the cross-correlation matrix where the p-value is less than 0.001. </p> <p>How can I accomplish this in MATLAB?</p>
<p>Simply search for values in <code>pval</code> that are less than 0.001, then use this to index into <code>corelMat</code> and set those values to zero. As such:</p> <pre><code>corelMat(pval &lt; 0.001) = 0; </code></pre> <p><code>pval &lt; 0.001</code> generates a logical matrix where <code>true</code> denotes those p-values that are less than 0.001 and <code>false</code> otherwise. By providing a logical matrix that is the same size as <code>corelMat</code> as an argument into <code>corelMat</code>, you are only changing the corresponding positions in <code>corelMat</code> that were <code>true</code> from <code>pval</code>. Once you find these positions, you change those values in <code>corelMat</code> to 0.</p> <hr> <p>Hope this helps!</p>