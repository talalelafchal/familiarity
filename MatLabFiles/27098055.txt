Convert RGB to Grayscale while keeping maximum quality
<p>I have a program that requires grayscale format videos.</p> <p>The correct video format that I require looks like this when imported with <code>VideoReader</code></p> <p><img src="https://i.stack.imgur.com/OVA82.png" alt="enter image description here"></p> <p>I have received a video file that imports with VideoReader as follows:</p> <p><img src="https://i.stack.imgur.com/QCoLR.png" alt="enter image description here"></p> <p>So I want to change the VideoFromat to Grayscale. I found this code and ran it:</p> <p><a href="http://www.mathworks.com/matlabcentral/answers/102367-how-do-i-convert-my-video-2-gb-to-uncompressed-avi-grayscale-in-matlab-7-12-r2011a" rel="nofollow noreferrer">http://www.mathworks.com/matlabcentral/answers/102367-how-do-i-convert-my-video-2-gb-to-uncompressed-avi-grayscale-in-matlab-7-12-r2011a</a></p> <p>and while it does output a Grayscale video, the quality has been severely reduced (a lot of the detail is 'blurred' together and there looks like a lot of artifacts in the video). A part of the same frame shows what I mean:</p> <p><img src="https://i.stack.imgur.com/Yb82O.png" alt="enter image description here"></p> <p>I have also loaded the original video file into ImageJ as Grayscale and saved it as "Uncompressed AVI", and the same kind of thing happens.</p> <p>So my question is</p> <p>(a) why is this occurring?</p> <p>(b) what would be the best way to perform the conversion I am after?</p> <p>Thanks</p>
<p>The issue here is that your image has a depth of 24 bits but you convert it to an 8 bit grey-scale using the solution you linked. I presume ImageJ does the same thing by default.</p> <p>I think you can fix this by replacing 255 with (2^24)-1 in the line </p> <p><code>map = [(0:255)' (0:255)' (0:255)']/255;</code></p> <p>and uint8 to uint32 on the next line.</p>
<p>The image degradation in your image does not look like it was caused by conversion to grayscale... It looks more like compression or sub-sampling artifacts. <code>VideoWriter</code> uses compressed Motion JPEG format by default. Are you sure you are using <code>'Uncompressed Avi'</code>?</p> <p>Also, one of the options for <code>PROFILE</code> parameters of <code>VideoWriter</code> is <code>Grayscale AVI</code>. Try using that. You may not even have to call <code>rgb2gray</code>.</p>