Xtick marks and Xtick labels on heatmap in Matlab
<p>Environment: Windows 7 64 bit, Matlab 2014a</p> <p>Objective: </p> <ol> <li>To draw a heatmap of errors for two parameters to be optimized.</li> <li>To put proper tick marks and tick values</li> <li>Draw the grid lines in the correct place</li> </ol> <p>Problem: Arranging the X and Y tick positions and values. When the last ("end") value of the vectors in x and y axes are the same, the code I use puts the ticks and values properly. However, when the end values are different it does not, and produces something really weird. </p> <p>Below I have included the code which I have modified so that you can run it without the need of adding anything. Of course in my case the error vector are the error values, not random numbers. To see the problem of "end value" use the second b vector.</p> <pre><code>fontsize = 20 k = [2^-5, 2^-3, 2^-1, 2^0, 2^1, 2^3, 2^5, 2^7, 2^9, 2^11, 2^13, 2^15] b = [2^-5, 2^-3, 2^-1, 2^0, 2^1, 2^3, 2^5, 2^7, 2^8, 2^9, 2^10, 2^11, 2^13, 2^15] % b = [2^-5, 2^-3, 2^-1, 2^0, 2^1, 2^3, 2^5, 2^7, 2^8, 2^9, 2^10, 2^11, 2^13, 2^19] errorVector = randi(20, 1, length(b)*length(k))' figure % Create a matrix from error vector (size of error vector is [length(k)*length(b),1]) B = reshape(errorVector, [length(b), length(k)]) B = flipud(B) % imagesc(x,y,C) imagesc(b, k, B) title('Heatmap Parameters Percent Error', 'FontSize', fontsize); % Set colorbar limits caxis([0 15]) colorbar; ax1 = gca; xTickLabel = (k)' xTick = linspace(k(1), k(end), numel(xTickLabel))'; set(ax1, 'XTick', xTick, 'XTickLabel', xTickLabel) xlabel('k parameter', 'FontSize', fontsize) yTickLabel = (b)' yTick = linspace(b(1), b(end), numel(yTickLabel))'; set(ax1, 'YTick', yTick, 'YTickLabel', flipud(yTickLabel(:))) ylabel('b parameter', 'FontSize', fontsize) set(ax1,'FontSize', fontsize) </code></pre> <p>Here, change any of the end values of b or k vectors, and the program will output a graph where the X and Y ticks are totally wrong. </p> <p>Also, I would like to draw grid lines. When I use "grid on" it draws grid lines right on the tick marks which is not correct in the case of heatmap. Because tick marks will be in the center of the columns -or rows- but the grid lines should be at the boundaries between the columns -or rows. </p> <p>By the way if you know a better way to plot a heatmap in Matlab, please do tell.</p> <p>Please help me solve this problem. Any help is appreciated,</p> <p>Ilyas</p>
<p>First of all - you don't need to <code>flipud</code> the <code>B</code> matrix - by default <code>imagesc</code> plots the y-data inversed, but you can fix this with the following statement:</p> <pre><code>set(gca,'ydir','normal'); </code></pre> <p>This also means you don't have to mess around with flipping the tick-labels. You can get the labels right by doing the following:</p> <pre><code>% replace the imagesc call with: imagesc(B); set(gca,'ydir','normal'); % formatting stuff ... % replace the set commands with: set(ax1, 'XTick', 1:length(k), 'XTickLabel', k) set(ax1, 'YTick', 1:length(b), 'YTickLabel', b) </code></pre> <p>By default, if you don't provide x and y data to the <code>imagesc</code> command, it will number them linearly (1,2,3...). Basically what we've done here is make sure that it has ticks for each of the elements of <code>b</code> and <code>k</code>, and then set the labels to the values of the respective vectors. </p> <p>Unfortunately, I'm not sure if there is a way to get the grid spacing right with <code>imagesc</code> or not. You could try using <code>pcolor</code> instead, which has it's own set of issues, but allows you to get grid lines (of sorts) between the elements. It also allows you to use an interpolated shading mode, which will make your plot look more like a typical heat map.</p> <p>To use <code>pcolor</code> instead, you just have to replace <code>imagesc</code>:</p> <pre><code>% imagesc(B); % set(gca,'ydir','normal'); pcolor(B); % this uses a smoother shading method, for a more 'heatmap' like output % shading interp </code></pre> <p>Everything else should work as intended, I believe.</p>