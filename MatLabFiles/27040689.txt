Matlab HDF5 and JHDF5 library mismatch crash?
<p>I'm using Matlab version R2013b on Linux Ubuntu 12.04 and have a Matlab application that depends on the <a href="http://www.hdfgroup.org/products/java/" rel="nofollow">Java HDF5</a> the one from <a href="http://www.hdfgroup.org/" rel="nofollow">HDFGROUP</a>. My problem is that the JHDF5 wrapper composed of the two files <code>jhdf5.jar</code> and <code>libjhdf5.so</code> seems to be in some form incompatible with the HDF5 library integrated within Matlab. </p> <p>My environment is setup as follows i.e. to ensure a version of JAVA within Matlab:</p> <pre><code>$ env | grep JAVA MATLAB_JAVA=/opt/dev/java/1.7.0_55/jre JAVA_HOME=/opt/dev/java/1.7.0_55 JAVA_VERSION=1.7.0_55 </code></pre> <p>I start Matlab from a directory where I set the following two files to setup the JHDF5 library:</p> <p><strong>java.opts</strong></p> <pre><code>-XX:MaxPermSize=256m -Xmx4091m -Xms2048m -Dncsa.hdf.hdf5lib.H5.hdf5lib=/opt/dev/jhdf5/2.7/lib/linux/libjhdf5.so </code></pre> <p><strong>javaclasspath.txt</strong></p> <pre><code>/opt/dev/jhdf5/2.7/lib/jhdf5.jar ... </code></pre> <p>From within Matlab I get the following (meaning I have HDF5 version 1.8.6 and all the rest i.e. JRE and JHDF5 setup as required):</p> <pre><code>&gt;&gt; [maj,min,relnum] = H5.get_libversion maj = 1 min = 8 relnum = 6 &gt;&gt; java.lang.System.getProperty('ncsa.hdf.hdf5lib.H5.hdf5lib') ans = /opt/dev/jhdf5/2.7/lib/linux/libjhdf5.so &gt;&gt; version -java ans = Java 1.7.0_55-b13 with Oracle Corporation Java HotSpot(TM) 64-Bit Server VM mixed mode </code></pre> <p>but then when I try to run a simple command e.g. create an instance of <code>ncsa.hdf.hdf5lib.H5</code> or simply access it from the Matlab command line, Matlab crashes</p> <pre><code>&gt;&gt; ncsa.hdf.hdf5lib.H5 % crashes Matlab </code></pre> <p>I some times see the following error popping out in the console:</p> <pre><code>HDF5-DIAG: Error detected in HDF5 (1.8.6) thread 0: #000: H5Edeprec.c line 186 in H5Eget_minor(): not a error message ID major: Invalid arguments to routine minor: Inappropriate type </code></pre> <p>To recap I have the following versions:</p> <ul> <li>Java JDK 1.7.0_55</li> <li>Matlab R2013b</li> <li>HDF5 native library version 1.8.6</li> <li>JHDF5 wrapper library version 2.7 that is compatible with HDF5 native 1.8.6. See the compatibility note here <a href="http://www.hdfgroup.org/ftp/HDF5/prev-releases/HDF-JAVA/HDF-JAVA-2.7/RELEASE.txt" rel="nofollow">RELEASE.txt</a></li> </ul>