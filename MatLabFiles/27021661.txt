Data alignment in Excel or Matlab?
<p>I carried out an experiment and automatically got readings in a .csv file format.<br/> However the apparatus was supposed to take a reading every 0.1 seconds, and sometimes it was offline.<br/> However the apparatus kept counting but didn't print these in the csv file.<br/> For example, it would go reading 98.5, 98.6, 99.0. <br/> I'm looking a way to put blank rows in where there is missing data, such as it'll read 98.5, 98.6, 98.7, 98.8, 98.9, 99.0. And to give values of Nan for these.<br/> Doing it individually isn't an option, as there is a vast amount of data (864,00 for a day).<br/> Any ideas on doing this in Excel or Matlab?</p>
<h1>In MATLAB:</h1> <p>It looks like your data has one decimal digit. In order to avoid <a href="http://se.mathworks.com/help/matlab/matlab_prog/floating-point-numbers.html#bqxyrhp" rel="nofollow noreferrer">floating point errors</a>, you can multiply the first column by 10 and <a href="http://se.mathworks.com/help/matlab/ref/round.html" rel="nofollow noreferrer">round it</a>, to create indices. (An alternative is to use <a href="http://www.mathworks.com/matlabcentral/fileexchange/23294-ismemberf" rel="nofollow noreferrer"><code>ismemberf</code></a> from the fileexchange). </p> <p>Now, create a matrix of <code>NAN</code>s of the desired size. After that, fill the elements corresponding to the indices you just found. </p> <pre><code>idx = round(A(:,1)*10); x = NaN(max(idx)-min(idx),2); x(idx+1,:) = A A = 0 0.8147 0.1000 0.9058 0.5000 0.0975 0.6000 0.2785 0.7000 0.5469 0.8000 0.9575 1.1000 0.9649 1.2000 0.1576 1.3000 0.9706 1.4000 0.9572 x = 0 0.8147 0.1000 0.9058 NaN NaN NaN NaN NaN NaN 0.5000 0.0975 0.6000 0.2785 0.7000 0.5469 0.8000 0.9575 NaN NaN NaN NaN 1.1000 0.9649 1.2000 0.1576 1.3000 0.9706 1.4000 0.9572 </code></pre> <h1>In Excel:</h1> <p>You can use <code>vlookup</code>. If it doesn't find the value, it will return <code>N/A</code>. The function used in the screenshot below is:</p> <pre><code>=VLOOKUP(D1;$A$1:$B$10;2;0) </code></pre> <p><img src="https://i.stack.imgur.com/k8IBE.jpg" alt="enter image description here"></p>