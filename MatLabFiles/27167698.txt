How to plot individually colored vectors over a background image in matlab?
<p>I have a background image and a vectorfield with an individual color information for each vector which I want to plot over the background image:</p> <pre><code>% Random background image Image = rand(100,200); % Random colors color1 = rand(30,30); color2 = rand(30,30); color3 = rand(30,30); % Positions x = 31:60; y = 31:60; [X,Y] = meshgrid(x,y); % Random vectors DX = 10 * rand(30,30); DY = 20 * rand(30,30); % The vector at (X(i,j),Y(i,j)) is supposed % to have the RGB color [color1(i,j) color2(i,j) color3(i,j)] % Uniformly colored vector field - works fine imshow(Image); hold on; quiver(X,Y,DX,DY,'color',[0.5 0.75 1]); % What I would like - does not work imshow(Image); hold on; quiver(X(:),Y(:),DX(:),DY(:),'color',[color1(:) color2(:) color3(:)]); </code></pre> <p>A simple for-loop leads to an erasure of the background image as noted in: <a href="http://stackoverflow.com/questions/27144825/image-gradually-erased-when-overlayed-with-lines">Image gradually erased when overlayed with lines</a>, at least for Matlab version R2012b (8.0.0.783). </p> <p>Any ideas?</p>
<p>The first problem I have with your code is</p> <pre><code>color1 = rand(30,30); color2 = rand(30,30); color3 = rand(30,30); (...) quiver(X,Y,DX,DY,'color',[color1 color2 color3]); </code></pre> <p>Even assuming that <code>quiver</code> can take multiple colors (more on that below) the last argument you are passing is a 30x90 array. I don't see how to expect MATLAB to guess how this breaks into three 30x30 arrays (red, green, blue). Usually, the way to pass color data as RGB matrix is to give a <em>N</em>x3 vector for <em>N</em> points.</p> <p>More to the point though, I would not expect <code>quiver</code> to be able to accept multiple color arguments. (I cannot test right now.) See its <a href="http://fr.mathworks.com/help/matlab/ref/quiverseries-properties.html" rel="nofollow">properties page</a>, in particular the "Color" tab, and compare with the same for <a href="http://fr.mathworks.com/help/matlab/ref/scatterseries-properties.html" rel="nofollow">scatter properties</a>' "Cdata".</p> <p>I fail to see a proper fix for the problem, since at the bottom there is the apparent inability in Matlab to plot vectors of different colors with the same call. If plotting the vectors in uniform color and adding a <code>scatter</code> of various colors at the starting points of them is enough for you, go for it... Otherwise I would have a look at the source code of <a href="http://www.mathworks.com/matlabcentral/fileexchange/3225-quiverc" rel="nofollow">this</a>: it is not doing what you want, but maybe it can be adapted.</p>