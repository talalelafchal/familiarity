Solve a system of equations with a constraint to x in Matlab
<p>I have given a <code>nxn</code> upper triangular matrix <code>R</code> and I want to solve the system of equations <code>Rx=0</code> where <code>x</code> is a vector of size <code>n</code>. Moreover the lowermost diagonalement of <code>R</code> is <code>0</code> (<code>R(n,n)=0</code>). Therefore I want to set <code>x(n)=1</code>.</p> <p>I tried some loops but I do not know how to solve it.</p> <p>Thank you for your help.</p>
<p>It's guaranteed that R has a zero eigenvalue, and the solution you want is a multiple of the eigenvector corresponding to that eigenvalue. Let's create some matrix R first:</p> <pre><code>&gt;&gt; R = triu(rand(3, 3)); &gt;&gt; R(3, 3) = 0; &gt;&gt; R R = 0.8147 0.9134 0.2785 0 0.6324 0.5469 0 0 0 </code></pre> <p>Now let's get the eigenvalues and eigenvectors:</p> <pre><code>&gt;&gt; [V, E] = eig(R) V = 1.0000 -0.9806 0.4289 0 0.1958 -0.5909 0 0 0.6833 E = 0.8147 0 0 0 0.6324 0 0 0 0 </code></pre> <p>The eigenvectors are the diagonal elements of E</p> <pre><code>&gt;&gt; E = diag(E); &gt;&gt; index = find(abs(E) &lt; 1e-16); %// NB don't use find(E==0) because of fp problems... </code></pre> <p>Now pull out the correct eigenvector</p> <pre><code>&gt;&gt; v = V(:, index); </code></pre> <p>and make sure its final element is equal to 1</p> <pre><code>&gt;&gt; v = v / v(end) v = 0.6277 -0.8648 1.0000 </code></pre> <p>You can check that this is the solution you want</p> <pre><code>&gt;&gt; R * v ans = 0 0 0 </code></pre>