Newton's method roots on Matlab
<p>I am not so much experiences with Matlab. I just need it for the sake of solving some lengthy non-linear equations. Instead of using <code>fzero</code>, I wanna use Newton-Raphson's to solve the equation. </p> <p><code>newton.m</code> file contains the following code.</p> <pre><code>function [ x, ex ] = newton( f, df, x0, tol, nmax ) if nargin == 3 tol = 1e-4; nmax = 1e1; elseif nargin == 4 nmax = 1e1; elseif nargin ~= 5 error('newton: invalid input parameters'); end x(1) = x0 - (f(x0)/df(x0)); ex(1) = abs(x(1)-x0); k = 2; while (ex(k-1) &gt;= tol) &amp;&amp; (k &lt;= nmax) x(k) = x(k-1) - (f(x(k-1))/df(x(k-1))); ex(k) = abs(x(k)-x(k-1)); k = k+1; end end </code></pre> <p>And in the main file, I have called this function as follows:</p> <pre><code>ext_H = newton( exp(x) + x^3, diff(exp(x) + x^3), 9, 0.5*10^-5, 10); </code></pre> <p>When I run this function, it gives me the following error.</p> <pre><code>Error using sym/subsref (line 9) Error using maplemex Error, (in MTM:-subsref) Array index out of range Error in newton (line 37) x(1) = x0 - (f(x0)/df(x0)); Error in main (line 104) ext_H = newton( exp(x) + x^3, diff(exp(x) + x^3), 9, 0.5*10^-5, 10); </code></pre> <p>Could anyone please help me to get through this?</p>
<p>You can probably use Matlab's fsolve (<a href="http://uk.mathworks.com/help/optim/ug/fsolve.html" rel="nofollow">http://uk.mathworks.com/help/optim/ug/fsolve.html</a>) with a couple of options </p> <pre><code>x0 = 9; options = optimoptions('fsolve','Algorithm','levenberg-marquardt','TolFun',5*10^-6,'MaxIter',100); x = fsolve(@(x)(exp(x) + x^3), x0,options); </code></pre> <p>or just fzero (<a href="http://uk.mathworks.com/help/optim/ug/fzero.html" rel="nofollow">http://uk.mathworks.com/help/optim/ug/fzero.html</a>) which implements BD algorithm </p> <pre><code>x = fzero(@(x)(exp(x) + x^3), x0); </code></pre>