Saving grayscale image as it appears in jet colormap
<p>I have grayscale satellite image which is processed from spectral data (band classifications). If i use jet colormap in imshow it will show absolute colormapped image. But if i try to imwrite in particular place it is saved like a bluish image. I saw one example in matlab central, but i didnt get. can anyone help me to write my image with colorscaled image.</p> <p>Matlab central link: <a href="http://www.mathworks.in/matlabcentral/answers/25026-saving-grayscale-image-as-it-appears-in-jet-colormap-of-imagesc" rel="nofollow">http://www.mathworks.in/matlabcentral/answers/25026-saving-grayscale-image-as-it-appears-in-jet-colormap-of-imagesc</a></p> <p>there accepted answer link is : <a href="http://www.mathworks.com/matlabcentral/fileexchange/7943" rel="nofollow">http://www.mathworks.com/matlabcentral/fileexchange/7943</a></p> <p>I have tried many times, this will show colormaped images in plots (imshow) they didnt write anywhere with colormaped. Now i want to write my image with colormaped.</p> <p>example code:</p> <pre><code>I= imread('image path'); imshow(I,'colormap',jet); imwrite(I,'path','jpg'); /not working </code></pre> <p>or</p> <pre><code>imwrite(I,jet,'path','jpg'); /not working </code></pre> <p>Please help to solve this issue.</p>
<p>When you use <code>imshow</code> the colormap is always adjusted to the range of values in your image. <code>imwrite</code> however assumes your image has a value range of [0,1] if you are using <code>single</code> or <code>double</code> data types. Try to scale your image to the range [0,1] before saving. </p> <p>If you provide a colormap in the call to <code>imwrite</code>, MATLAB assumes you are using an indexed image. Thus you will have to convert the image to the indexed format first. The following snippet worked for a test image <code>I</code> of mine:</p> <pre><code>% scale to [0,1] I = I - min(I(:)); I = I ./ max(I(:)); % Create indexed image [J,~] = gray2ind(I); % Save image imwrite(J,jet,'path','jpg'); </code></pre>
<p>Solution by <a href="http://stackoverflow.com/questions/26773053/saving-grayscale-image-as-it-appears-in-jet-colormap/26773759#26773759/">hbaderts</a> worked well for me, but later I found out that some images were still scaled slightly different way from <code>imshow</code>.</p> <p>However, I might found a reason of an original problem. Just after Matlab starts, its default colormaps (including 'jet') are set to 64 colors (64x3). Then, if any image is shown with a colormap, for example if <code>imshow('cameraman.tif'), colormap('jet')</code> is executed, all default colormaps become 256x3 (can be verified with <code>jetMap=jet;</code> before and after). Then it might happen that an image was written with a colormap different from the one applied to image figure (for example, if a figure called after <code>imwrite</code>).</p> <p>Finally I found this solution (no image pre-scaling needed):</p> <pre><code>% Create indexed image, explicitly using 256 colors imInd=gray2ind(im,256); % Convert indexed image to RGB using 256-colors jet map jetRGB=ind2rgb(imInd,jet(256)); % Save image imwrite(jetRGB,'jet.png'); </code></pre> <p>The images I used have the same color scale now, both the saved one and the one shown in figure.</p>