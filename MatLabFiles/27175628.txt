How do I plot the output of a system with an impulse response in matlab?
<p>I am very new to matlab and need to plot y1[n] = x[n] + y1[n âˆ’ 1] where x[n] = [1,2,4] and an impulse response, h[n] = [1,1,1,1,1] and am not sure if I have went about it the right way</p> <p>My code so far is</p> <pre><code>x = [1,2,4]; h = [1,1,1,1,1]; y = []; for n=1:length(x) if (n==1) y(n) = x(n); else y(n) = (x(n)*h(n)) + (y(n-1)*h(n)); end end stem(y); </code></pre> <p>Please note that I cannot use the conv() function</p>
<p>Can you use <code>fft</code>?</p> <pre><code>lx = numel(x); lh = numel(h); m = max(lx, lh); y = ifft(fft([h zeros(1,max(lx-lh,0)+m)]) .* fft([x zeros(1,max(lh-lx,0)+m)])); y = y(1:lx+lh-1); </code></pre>
<p>I don't really know why it got so complicated,</p> <pre><code>x = [1,2,4]; h = [1,1,1,1,1]; y = []; lh = length(h); lx = length(x); t = -lh - lx : lh + lx; x(end + 1 : end + lh + 1) = 0; h(end + 1 : end + lx + 1) = 0; x = padarray(x,[0 max(t)],'pre'); h = padarray(h,[0 max(t)],'pre'); xinv = x(end:-1:1); for n = 1 : length(t) xinv = circshift(xinv,[0 1]); y(n) = sum(xinv .* h); end y = circshift(y,[0 find(t == 0)]); subplot(311) stem(t,x); xlim([-10 10]) subplot(312) stem(t,h); xlim([-10 10]) subplot(313) stem(t,y); xlim([-10 10]) </code></pre> <p><img src="https://i.stack.imgur.com/cg7mX.png" alt="enter image description here"></p> <p>It works fine but I believe it can be coded in a more simpler way.</p>