Replacing the colon operator with an equivalent vectorizable solution
<p>My current code does something like this:</p> <pre><code>for offset = 0:0.9:max_offset : x = offset:step_size:max_value; [...] end </code></pre> <p>I would like to vectorize and remove the for loop to make it faster, but if I try making <code>offset</code> a vector, the colon operator on the second line is equivalent to doing</p> <pre><code>x = offset(1):step_size:max_value; </code></pre> <p>What is the most efficient way to achieve the desired result, i.e. get</p> <pre><code>x = [ 0:step_size:max_value; 0.9:step_size:max_value; 1.8:step_size:max_value; ... ] </code></pre> <p>assuming I don't know <code>max_offset</code>, and therefore the length of number of rows I want in <code>x</code>?</p>
<p>Since each vector will be a different size, they wont fit in a matrix easily. You will have to put them in a cell array, like so:</p> <pre><code>offset=0:.9:max_offset; x=arrayfun(@(k) k:step_size:max_value,offset,'UniformOutput',false) </code></pre> <p>and rather than referring to rows of <code>x</code> by <code>x(i,:)</code> for a matrix, you would do <code>x{i}</code> to get the right vector out.</p>