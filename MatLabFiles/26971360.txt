Simulation Velocity of a harmonic oscillator system
<p>I am write a simulation for get true Velocity of a harmonic oscillator system as</p> <p><img src="https://i.stack.imgur.com/kZmyn.png" alt="enter image description here"></p> <p>Where P=[p1 p2;p2 p3] can find using Rung-Kutta Integration method with P(0)=[1 0; 0 1]</p> <p>Now, I want to write matlab code to get the true postion <code>z</code> of the system and estimate x inwhich x=[x1 x2]'. This is my code to find x and z. However, the result is not correct. Could you help me to modify it. This is my matlab code</p> <pre><code>function z=getPos(x) %% Function to get velocity v=0+1*randn; %r=1; z=[0 1]*x+v; return </code></pre> <p>This is my result <img src="https://i.stack.imgur.com/QoxHD.png" alt="enter image description here"></p> <p>Let see help me is correct implement for the solution. Thank you</p>
<p>Your code can return a negative value as randn is a normally distributed random number with standard deviation 1. In theory this could return any number and there is ~15% chance it will be less than -1.</p> <p>You are also correct than you should update x at each step. I would take x as an input into getPos and xdot as an output. Then add another step to update the position.</p>