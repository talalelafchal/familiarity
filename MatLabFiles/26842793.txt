extract data from a matrix, maintaining NaNs as NaNs matlab
<p>I have a dataset called 'data' of size 106*103*100. I am extracting a portion of the dataset for further analysis based on its geographical position using latitudes and longitudes and naming the extracted data 'testdata'). 'data' contains a mixture of both numbers and NaNs.</p> <p>The data I want to extract lies within the latitudinal and longitudinal bounds of ylat_south=44,ylat_north=55,xlon_west=16 and xlon_east=30;</p> <p>The matrix of latitudes is called: final_lat (106*103); The matrix of longitudes is called: final_lon (106*103); This is what I have to extract the data:</p> <pre><code>for i=1:size(data,3); testdata(:,:,i)=+(final_lat&gt;=ylat_south &amp; final_lat&lt;=ylat_north &amp; final_lon&gt;=xlon_west &amp; final_lon&lt;=xlon_east).*data(:,:,i); end </code></pre> <p>The code I have works (i.e. I end up with testdata of size 106*103*100), except, when testdata is written out, any cells that contained a NaN in 'data' are being written as a zero is the new 'testdata' matrix'. I know I could do this is a loop, with an if statement, but I am trying to keep the code as efficient as possible.</p> <p>Any suggestions appreciated.</p>