How to find local &quot;means&quot; from noisy signal with Matlab?
<p>I have 2-D data from a measurement that looks as below:</p> <p><img src="https://i.stack.imgur.com/obNuu.png" alt="matlab noisy data"></p> <p>The noise causes the Y data to be in the range from [4.03, 4.1]. How can I obtain a mean value (x, y) for each group of points, e.g. for the graphic this would be around (0.3, 4.07), (1.6, 4.08), (2.3, 4.05), (3, 4.07)?</p> <p>I saw something about nlfilter, but most example about that represent a 2-D image. Thanks for your help!</p> <p>EDIT:</p> <p>I generate the plot below with:</p> <pre><code>plot(t, y); </code></pre> <p>The t data looks as:</p> <pre><code>t(some_condition(1:40)) ans = 1.0e-04 * Columns 1 through 6 0.0216 0.0216 0.0216 0.0216 0.0216 0.0217 Columns 7 through 12 0.0217 0.0217 0.0217 0.0217 0.0218 0.0928 Columns 13 through 18 0.0928 0.0928 0.0928 &gt;&gt; mean(t(some_condition)) ans = 1.6686e-05 </code></pre> <p>So, I only get one value for the mean in t, while I want to have 4 means (actually, the 2 dots around 0.8) are noise too.</p>
<p>You can try the following:</p> <pre><code>x_filter = [0.03 0.16 0.23 0.30]*1e-5; % Insert value you want to filter here and exluce those which not for i = 1:numel(x_filter) ind = abs(t-x_filter(i))&lt;0.01e-5; % Or any other offset x_m = mean(t(ind)); y_m = mean(y(ind)); plot(x_m,y_m,'x','MarkerSize',20); end </code></pre>
<p>In MATLAB the mean function operates column-wise, so using mean(ydata) would give you an array containing the mean for each x-position. If I got you right, here is a sample code which does what you are after (I think):</p> <pre><code>clear clc %// Generate dummy data x = repmat(1:4,10,1); y = rand(10,4); My = mean(y) </code></pre> <p>My looks like this:</p> <pre><code>My = 0.5854 0.6799 0.5431 0.2933 </code></pre> <p>Then plot the points using scatter:</p> <pre><code>hold on for k = 1:size(y,2) scatter(x(:,k),y(:,k)) markerarea = 200; scatter(k,My(k),markerarea,'filled','d') %// Represent the mean as a diamond. end hold off axis([0 5 0 1]) </code></pre> <p>which looks like this:</p> <p><img src="https://i.stack.imgur.com/hxorH.jpg" alt="enter image description here"></p> <p>Is this what you had in mind? If not please tell me I'll edit/remove my answer :)</p>