Matlab vectorization of vector creation
<p>I would like to vectorize the creation of the following vector:</p> <p>For example- Let <code>A</code> be a vector <code>[5 3 2 1]</code> And let B be a vector <code>[1 2 3 4]</code></p> <p>I would like <code>C</code> to be the vector <code>[1 1 1 1 1 2 2 2 3 3 4]</code> </p> <p>Meaning- each element <code>i</code> in <code>B</code> is duplicated <code>A(i)</code> times in <code>C</code>.</p> <p>I haven't found a way to vectorize the creation of this, any ideas?</p> <p>Thanks in advance!</p> <p>Ronen</p>
<p><strong>Approach #1</strong></p> <p>Here's one approach if <code>B</code> doesn't have any <code>zeros</code> -</p> <pre><code>C = nonzeros(bsxfun(@times,bsxfun(@le,[1:max(A)]',A),B)) </code></pre> <hr> <p><strong>Approach #2</strong></p> <p>A general case solution -</p> <pre><code>mask = bsxfun(@le,[1:max(A)]',A) %//' B_ext = bsxfun(@times,mask,B) C = B_ext(mask) </code></pre> <hr> <p><strong>Approach #3</strong></p> <p><code>cumsum</code> based approach and must be pretty efficient one -</p> <pre><code>idx = [1 cumsum(A(1:end-1))+1] %// indices where each new B values start C = zeros(sum(A),1) %// storage for output C(idx) = diff([0 B]) %// put those values, but offseted C = cumsum(C) %// finally get the output </code></pre>