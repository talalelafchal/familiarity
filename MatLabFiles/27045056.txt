Trouble with horner function in MATLAB
<p>I have the following homework question:</p> <blockquote> <p>Apply linear least squares with the two models S1(A, B, C) = Ax^2 + Bx + C and S2(A, B, C, D) = Ax^3 + Bx^2 + Cx + D to the data set (0, 4), (1, −1), (2, 6), (3, 1), (4, −4), (5, −9). Solve in MATLAB using lspoly. Report the values of the parameters A, B, C and D clearly, and produce a plot showing the data and both fitting curves.</p> </blockquote> <p>I am working with the following function in MATLAB:</p> <p>Function 1</p> <pre><code>function y = horner(a,c) n=length(a)-1; y=a(n+1); for k = n:-1:1 y = a(k)+ c*y; end </code></pre> <p>Function 2</p> <pre><code>function C = lspoly(x,y,M) n = length(x); F = zeros(n,M+1); for k = 1:M+1 F(:,k) = x'.^(k-1); end A = F'*F; B = F'*y'; C = A\B; </code></pre> <p>And this is the code I wrote for the problem:</p> <pre><code>clc clear all close all x = [0, 1, 2, 3, 4, 5]; y = [4, -1, 6, 1, -4, -9]; C = lspoly(x,y,2); % finds the parameters xx = 0:0.01:5; yy = zeros(1, length(xx)); for i=1:length(xx) yy(i) = horner(C,xx(i)); end CC = lspoly(x,y,3); % finds the parameters xxx = 0:0.1:5; yyy = zeros(1, length(xxx)); for i=1:length(xxx) yyy(i) = horner(CC,xxx(i)); end figure(1) plot(x, y, 'o', xx, yy, 'r-', xxx, yyy, 'b-') </code></pre> <p>I am encountering some issues with this code. When I try to run the program, I get the following error:</p> <blockquote> <p>In an assignment A(I) = B, the number of elements in B and I must be the same.</p> <p>Error in HW7_1 (line 14) yy(i) = horner(C,xx(i));</p> </blockquote> <p>I can't really wrap my head around what exactly I need to do to fix this issue. I tried breaking down my program piece by piece to determine results at different spots in the code, but so far nothing of note has been found.</p> <p>Can someone help me fix this error?</p>
<p>It works just fine for me in Octave 3.8. The only thing I can think of is there a built-in function called <a href="http://uk.mathworks.com/help/symbolic/horner.html" rel="nofollow"><code>horner</code></a> in MATLAB (part of the <a href="http://uk.mathworks.com/products/symbolic/" rel="nofollow">Symbolic Math Toolbox</a>), so maybe your code is calling that function instead of yours. Maybe try renaming it to something different, like <code>my_horner</code> or similar.</p>