use library (gcc) in matlab and error with compile of mex
<p>I am using Mac OSX (yosemite V 10.10.1) and running MATLAB 2014a on it.</p> <p>I wanted to use SPAM library (sparse modeling software by J. Mairal) on MATLAB and for that I have to install XCode6.1 (that has gcc). First I type in command window <code>mex -setup</code> and result is shown below:</p> <pre><code>mex -setup MEX configured to use 'Xcode with Clang' for C language compilation. Warning: The MATLAB C and Fortran API has changed to support MATLAB variables with more than 2^32-1 elements. In the near future you will be required to update your code to utilize the new API. You can find more information about this at: http://www.mathworks.com/help/matlab/matlab_external/upgrading-mex-files-to-use-64-bit-api.html. To choose a different language, select one from the following: mex -setup C++ mex -setup FORTRAN </code></pre> <p>So after that I run the <code>compile.m</code> file in SPAM library and suddenly I saw an error that was:</p> <pre><code>add_flag = -mmacosx-version-min=10.6 Warning: Directory already exists. &gt; In compile at 144 compilation of: -I./linalg/ -I./decomp/ -I./prox/ -I./dictLearn/ dictLearn/mex/mexArchetypalAnalysis.cpp Building with 'Xcode Clang++'. clang: warning: argument unused during compilation: '-fopenmp' Error using mex ld: warning: directory not found for option '-L/usr/lib/gcc/x86_64-linux-gnu/4.8/' ld: library not found for -lgomp clang: error: linker command failed with exit code 1 (use -v to see invocation) Error in compile (line 439) mex(args{:}); </code></pre> <p>I don't understand what to do. please help me!</p>
<p>It appears that the actual error is occurring at the point of linking with precompiled libraries. The 2 issues are as follows:</p> <ol> <li><p>The compile code apparently included in the <code>compile.m</code> file looks like it is intended to compile with gcc (it is trying to include files installed by GCC, possibly even linux-specific ones, are you sure that it's an OSX-compatible toolbox?), and yet the error strongly suggests that you are in fact using clang to compile it - you will either need to change the compiler (easy) or rewrite <code>compile.m</code> (not so easy).</p></li> <li><p>One of the libraries that the code needs to have installed in order to be properly linked hasn't been found. On OSX I think this file should be called <code>libgomp.dylib</code> (any mac afficionados want to confirm this?). If you have it on your computer, then it's not in a directory that clang is looking in. You can confirm the library is installed by running <code>find / | grep libgomp.dylib</code> from the terminal - if it is there, you can add it into the compiler argument in <code>compile.m</code> using the <code>-I /DIRECTORY_HOLDING_LIBRARY</code> syntax.</p></li> </ol> <p>It is entirely possible that fixing 1. will also remediate 2. - I have never tried using SPAM</p>