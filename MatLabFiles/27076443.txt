Matlab Conditional probability from dataset
<p>I have a Matrix <code>M</code> of <code>500x5</code> and I need to calculate conditional probability. I have discretised my data and then I have this code that currently only works with <code>3</code> variables rather than <code>5</code> but that's fine for now. </p> <p>The code below already works out the number of times I get <code>A=1</code>, <code>B=1</code> and <code>C=1</code>, the number of times we get <code>A=2</code>, <code>B=1</code>, <code>C=1</code> etc.</p> <pre><code>data = M; npatients=size(data,1) asum=zeros(4,2,2) prob=zeros(4,2,2) for patient=1:npatients, h=data(patient,1) i=data(patient,2) j=data(patient,3) asum(h,i,j)=asum(h,i,j)+1 end for h=1:4, for i=1:2, for j=1:2, prob(h,i,j)=asum(h,i,j)/npatients end end end </code></pre> <p>So I need code to sum over to get the number of time we get <code>A=1</code> and <code>B=1</code> (adding over all C) to find:</p> <pre><code>Prob(C=1 given A=1 and B=1) = P(A=1,B=1, C=1)/P( A=1, B=1). </code></pre> <p>This is the rule strength of the first rule. I need to find out how to loop over <code>A</code>, <code>B</code> and <code>C</code> to get the rest and how to actually get this to work in Matlab. I don't know if its of any use but I have code to put each column into its own thing.:</p> <pre><code>dest = M(:,1); gen = M(:,2); age = M(:,3); year = M(:,4); dur = M(:,5); </code></pre> <p>So say <code>dest</code> is the consequent and <code>gen</code> and <code>age</code> are the antecedents how would I do this. </p> <p>Below is the data of the first <code>10</code> patients as an example:</p> <pre><code>destination gender age 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 1 3 2 2 2 2 2 3 2 1 3 2 1 </code></pre> <p>Any help is appreciated and badly needed.</p>
<p>Sine your code didn't work by copy &amp; paste, I changed it a little bit,</p> <p>It's better if you define a function that calculates the probability for given data,</p> <pre><code>function p = prob(data) n = size(data,1); uniquedata = unique(data); p = zeros(length(uniquedata),2); p(:,2) = uniquedata; for i = 1 : size(uniquedata,1) p(i,1) = sum(data == uniquedata(i)) / n; end end </code></pre> <p>Now in another script,</p> <pre><code>data =[3 2 91; 3 2 86; 3 2 90; 3 2 85; 3 2 86; 3 1 77; 4 2 88; 3 2 90; 4 2 79; 4 2 77; 4 1 65; 3 1 60]; pdest = prob(data(:,1)); pgend = prob(data(:,2)); page = prob(data(:,3)); </code></pre> <p>This will give,</p> <pre><code>page = 0.0833 60.0000 0.0833 65.0000 0.1667 77.0000 0.0833 79.0000 0.0833 85.0000 0.1667 86.0000 0.0833 88.0000 0.1667 90.0000 0.0833 91.0000 pgend = 0.2500 1.0000 0.7500 2.0000 pdest = 0.6667 3.0000 0.3333 4.0000 </code></pre> <p>That will give the probabilities you've already calculated,</p> <p>Note that the second column of <code>prob</code> is the valuse and the first column the probability.</p> <p>When you want to calculate probabilities for <code>des = 3 &amp; gend = 2</code> you should create a new data set and call <code>prob</code>, for new data set use,</p> <pre><code>mapd2g3 = data(:,1) == 3 &amp; data(:,2) == 2; datad2g3 = data(mapd2g3,:) 3 2 91 3 2 86 3 2 90 3 2 85 3 2 86 3 2 90 paged2g3 = prob(datad2g3(:,3)) 0.1667 85.0000 0.3333 86.0000 0.3333 90.0000 0.1667 91.0000 </code></pre> <p>This is the <code>prob(age|dest = 3 &amp; gend = 2)</code> .</p> <p>You could even write a function to create the data sets.</p>