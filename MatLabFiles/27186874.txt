How does imread scale 12bit images?
<p>I have a 12-bit pgm-image, which I read with imread. The result is a 16-bit image having values in the full range 0 to 2^16 - 1.</p> <p>How does Matlab scale? Will </p> <pre><code> X = imread('filename'); X = uint16(double(X)*((2^12-1)/(2^16-1))); </code></pre> <p>recover the original intensities?</p>
<p>MATLAB does load PGM 12-bit images correctly. However, after MATLAB loads the images, the image values are rescaled from 12-bit to 16-bit.</p> <p>MATLAB uses the following algorithm to scale the values from 12-bit to 16-bit:</p> <pre><code>% W contains the the 12-bit data loaded from file. Data is stored in 16-bit unsigned integer % First 4 bits are 0. Consider 12-bit pixel color value of ABC % Then W = 0ABC X = bitshift(W,4); % X = ABC0 Y = bitshift(W,-8); %Y = 000A Z = bitor(X,Y); %Z = ABCA % Z is the variable that is returned by IMREAD. </code></pre> <p>Workaround for this is like that</p> <pre><code>function out_image = imreadPGM12(filename) out_image = imread(filename); out_image = floor(out_image./16); return </code></pre> <p>Alternatively perform a 4 bit shift to the right:</p> <pre><code>function out_image = imreadPGM12(filename) out_image = imread(filename); out_image = bitshift(out_image,-4); return </code></pre> <p>Further information can be found here: <a href="http://www.mathworks.com/matlabcentral/answers/93578-why-are-12-bit-pgm-images-scaled-up-to-16-bit-value-representation-in-image-processing-toolbox-7-10">http://www.mathworks.com/matlabcentral/answers/93578-why-are-12-bit-pgm-images-scaled-up-to-16-bit-value-representation-in-image-processing-toolbox-7-10</a></p>