Use Matlab/Maple to find roots of a nonlinear equation
<p>I am having difficulty in finding roots of a nonlinear equation. I have tried Matlab and Maple both, and both give me the same error which is</p> <pre><code>Error, (in RootFinding:-NextZero) can only handle isolated zeros </code></pre> <p>The equation goes like</p> <pre><code>-100 + 0.1335600000e-5*H + (1/20)*H*arcsinh(2003.40/H) </code></pre> <p>The variable is <code>H</code> in the equation.</p> <p>How do I find the roots (or the approximate roots) of this equation?</p> <p>Matlab Code: The function file:</p> <pre><code>function hor_force = horizontal(XY, XZ, Lo, EAo, qc, VA) syms H equation = (-1*ZZ) + (H/qc)*(cosh((qc/H)*(XZ- XB))) - H/qc + ZB; hor_force = `solve(equation);` </code></pre> <p>The main file:</p> <pre><code>EAo = 7.5*10^7; Lo = 100.17; VA = 2002; XY = 0; ZY = 0; XB = 50; ZB = -2; XZ = 100; ZZ = 0; ql = 40; </code></pre> <p>Error which Matlab shows:</p> <pre><code>Error using sym/solve (line 22) Error using maplemex Error, (in RootFinding:-NextZero) can only handle isolated zeros Error in horizontal (line 8) hor_force = solve(equation); Error in main (line 34) h = horizontal(XY, XZ, Lo, EAo, ql, VA) </code></pre> <p><a href="http://postimg.org/image/gm93z3b7z/" rel="nofollow">http://postimg.org/image/gm93z3b7z/</a></p>
<p>You don't need the symbolic toolbox for this:</p> <p>First, create an anonymous function that can take vectors at input (use <code>.*</code> and <code>./</code>:</p> <pre><code>equation = @(H) ((-1*ZZ) + (H./qc).*(cosh((qc./H).*(XZ- XB))) - H./qc + ZB); </code></pre> <p>Second, create a vector that you afterwards insert into the equation to find approximately when the sign of the function changes. In the end, use <a href="http://www.mathworks.com/help/matlab/ref/fzero.html" rel="nofollow noreferrer"><code>fzero</code></a> with <code>x0</code> as the second input parameter.</p> <pre><code>H = linspace(1,1e6,1e4); x0 = H(find(diff(sign(equation(H))))); %// Approximation of when the line crosses zero x = fzero(equation, x0) %// Use fzero to find the crossing point, using the initial guess x0 x = 2.5013e+04 equation(x) ans = 0 </code></pre> <p>To verify:</p> <p><img src="https://i.stack.imgur.com/jS9k7.jpg" alt="enter image description here"></p> <p>You might want to check out <a href="http://stackoverflow.com/questions/16809744/equivalent-to-roots-for-non-polynomials-in-matlab">this question</a> for more information about how to find roots of non-polynomials.</p>
<p>In Maple, using the expression from your question,</p> <pre><code>restart: ee := -100 + 0.1335600000e-5*H + (1/20)*H*arcsinh(2003.40/H): Student:-Calculus1:-Roots(ee, -1e6..1e6); [ 5 ] [-1.240222868 10 , -21763.54830, 18502.23816] #plot(ee, H=-1e6..1e6, view=-1..1); </code></pre>