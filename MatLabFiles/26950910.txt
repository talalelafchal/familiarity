Component frequencies of signal
<p>I'm trying to get component frequencies of this signal:</p> <p><img src="https://i.stack.imgur.com/nB821.png" alt="enter image description here"></p> <p>Here is my code:</p> <pre><code>fs = 100; x = UI_przebiegi.signals.values(:,7); m = length(x); % Window length n = pow2(nextpow2(m)); % Transform length y = fft(x,n); % DFT of signal f = (0:n-1)*(fs/n)/10; % Frequency range p = y.*conj(y)/n; % Power of the DFT plot(f(1:floor(n/2)),p(1:floor(n/2))) </code></pre> <p>It give me:</p> <p><img src="https://i.stack.imgur.com/yJoml.png" alt="enter image description here"></p> <p>How to do it?</p>
<p>There is nothing wrong with your approach. The Fourier Transform is just fine, so don't worry about finding the Fourier Series as suggested in one of the comments. The signal is very low frequency, so the peak will nearly be at DC. The signal has what looks to be about 3pi rotation over what is apparently ~1200(s), which means is frequency is roughly 1/900(Hz). Since the frequency resolution of the FT will be 1/1200(Hz), the signal's peak will be barley one resolution cell from DC.</p> <p>Something puzzles me though: why are you dividing the frequency by 10? Are you trying to plot against deca-Hertz?</p> <p>See if my code below does not help you. I've tried to keep it similar to yours but of course had to make up my own signal.</p> <pre><code>fs = 100; % Sampling frequency of 100 (Hz). T = 1200; % Signal duration (s). t = 0 : 1/fs : T; % Time sample locations (s). x = cos( 2*pi * 1/900 * t ); % Signal of iterest. m = length(x); % Window length n = 2*pow2(nextpow2(m)); % Transform length y = fft(x,n); % DFT of signal f = (0:n-1)*(fs/n); % Frequency sample locations (Hz) p = y.*conj(y)/n; % Power of the DFT % Now we plot the spectral power and change the x-limits % to zoom in on where we expect the signal's energy to be. % We also draw a line a 1/900 (Hz) for illustration. plot(f(1:floor(n/2)), 20*log10( p(1:floor(n/2)) ) ); xlim( [ 0 3/900 ] ); line( 1/900 * [1 1], ylim(), 'color', 'k' ); </code></pre> <p>You see the line at the signal's frequency passing through the peak of the FT. I hope the above helps. Good luck.</p>