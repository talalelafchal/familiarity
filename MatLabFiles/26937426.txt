PHP upload with dynamic url by action attribute.
<p>I am trying to upload matlab file using php onto my server. I need to pass this file as the part of php url so that I can take out this from url and pass on this to some code in custom shell script.</p> <p>Here is the script I am using to change the URL but then the file is not uploading.</p> <p>HTML Code: </p> <pre><code>&lt;script type="text/javascript"&gt; window.onload = function(){ var form = document.getElementById("phpForm"); form.onsubmit = function(){ var matlabfile = document.getElementById("fileToUpload"); var filename = matlabfile.value; var filename2=filename.replace(/^.*\\/, ""); var filename3=filename2.substr(0, filename2.lastIndexOf('.')); window.location = "upload.php?matlabfile=" + filename3 return false; }; }; &lt;/script&gt; &lt;form action="" id="phpForm" method="post" name="phpForm" enctype="multipart/form-data&gt; &lt;table style=" text-align:center;"&gt; &lt;tr&gt; &lt;td&gt;&lt;b&gt;File 1:&lt;/b&gt; &lt;input id= "fileToUpload" name="fileToUpload" type="file"&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;&lt;input name="submit" type= "submit" value= "Upload Script"&gt;&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; &lt;/form&gt; </code></pre> <p>PHP Code:</p> <pre><code>&lt;?php $targetfolder = ""; $targetfolder = $targetfolder . basename( $_FILES['fileToUpload']['name']) ; if(move_uploaded_file($_FILES['fileToUpload']['tmp_name'], $targetfolder)) { echo "The file ". basename( $_FILES['fileToUpload']['name']). " is uploaded"; } else { echo "Problem uploading file"; } $var1=$_GET['matlabfile']; echo "&lt;pre&gt;$var1&lt;/pre&gt;"; echo "matlabfile : ".$_GET['matlabfile']."&lt;br&gt;"; $output = shell_exec("./n.sh $var1 2&gt;&amp;1"); echo "&lt;pre&gt;$output&lt;/pre&gt;"; ?&gt; </code></pre> <p>Could you please tell me what I am doing wrong.</p> <p>Looking forward to your replies.</p> <p>Thanks and Best Regards, Shivam Dixit</p>
<p>Your 'return false;' is preventing the submission of the form, and then the file isn't uploaded. You're simply moving the user to another address.</p> <p>Instead of</p> <pre><code>window.location = "upload.php?matlabfile=" + filename3; return false; </code></pre> <p>try to set the form action to the url you want:</p> <pre><code>form.setAttribute('action', "upload.php?matlabfile=" + filename3); </code></pre> <p>Then, the user will be sent to the page you want, and the file will be uploaded :)</p>