integration of incomplete beta function in matlab
<p>This line code works:</p> <pre><code>g=integral(@(z(z.^((2*0.1*0.7)-1)).*betainc(0.7./z,0.37,0.4),0.7,0.7.*exp(11/0.7),... 'RelTol',1e-16) </code></pre> <p>for other upper limits as <code>0.7*exp(120/0.7)</code> or <code>0.7*exp(5/0.7)</code> it works as well. However, if the limit is <code>0.7*exp(12/0.7)</code> or <code>0.7*exp(30/0.7)</code> I get the following error:</p> <pre><code>Error using betainc X must be in the interval [0,1]. Error in @(z)(z.^((2*0.1*0.7)-1)).*betainc(0.7./z,0.37,0.4) Error in integralCalc/iterateScalarValued (line 323) fx = FUN(t).*w; Error in integralCalc/vadapt (line 132) [q,errbnd] = iterateScalarValued(u,tinterval,pathlen); Error in integralCalc (line 75) [q,errbnd] = vadapt(@AtoBInvTransform,interval); Error in integral (line 88) Q = integralCalc(fun,a,b,opstruct); </code></pre>
<p>With the <code>0.7*exp(120/0.7) = 1.9751e+74</code> upper limit the result is clearly wrong (<code>9.3143e-16</code>), it is interesting that no warning message is given.</p> <p>What you want to calculate is an improper integral on an unbounded domain, see your function below: <img src="https://i.stack.imgur.com/6EKiJ.png" alt="enter image description here"></p> <p>It is not a good idea to try to give an enormous upper limit to approximate the improper integral. The help page of <a href="http://www.mathworks.com/discovery/integral.html" rel="nofollow noreferrer"><code>integral</code></a> recommends for this case to define the limit as <code>Inf</code>, using this the integral is calculated with the following warning message:</p> <blockquote> <p>Warning: Reached the limit on the maximum number of intervals in use. Approximate bound on error is 3.6e-07. The integral may not exist, or it may be difficult to approximate numerically to the requested accuracy.</p> </blockquote> <p>Since the result of the integral is <code>2.6349</code> the error is negligible (if we can believe the warning message), by the way it seems to me a reasonable number.</p> <p>Here is the code:</p> <pre><code>fun = @(z) (z.^((2*0.1*0.7)-1)).*betainc(0.7./z, 0.37, 0.4); ll = 0.7; ul = Inf; g = integral(fun, ll, ul, 'RelTol', 1e-16) </code></pre>