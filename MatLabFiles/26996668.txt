counting convex quadrilaterals
<p>In a grid 3x3, we have 1038 convex quadrilaterals, known form <a href="https://oeis.org/A189413" rel="nofollow">oeis</a>. The answer I calculate is 912.</p> <p>My approach:</p> <p>I calculate number of convex quadrilaterals in grid smaller than or equal to 3x3, which all points of it is on the boundary of the smaller grid. Then multiply a coefficient. This coefficient is the number of ways that the smaller grid can be placed within the larger one. For example, grid 1x1 can be placed 9 times, and grid 2x1 can be placed 6 times.</p> <p>My code:</p> <pre><code>n=3; exclusive1=zeros(n,n); for i=1:n for j=1:n exclusive1(i,j)=exclusive2(i,j); end end total=0; for i=1:n for j=1:n total=total+ exclusive1(i,j)*(n-i+1)*(n-j+1); end end total </code></pre> <p>exclusive2:</p> <pre><code>function [y ] = exclusive2( ni,nj ) M=max(ni,nj); m=min(ni,nj); % corner not selected sum0=0; sum0=(M-1)*(M-1)*(m-1)*(m-1); sum0 % one corner is chosen sum1=0; sum1=(M-1)*(m-1)*(M+m-2)*4; % one on side 1, one on side 2, one on side 3 or 4 if M&gt;=3 sum1=sum1+nchoosek(M-1,2)*(m-1)*4; % two on side 1, one on side 2 end if m&gt;=3 sum1=sum1+nchoosek(m-1,2)*(M-1)*4; % two on side 2, one on side 1 end sum1 % two corners are chosen % corners are on same side sum21=0; sum21=(M-1)* 2*(m-1)*4; % the 4 because 4 ways to select same side corners % one on side 1 and one on side 2 or 3 if M&gt;=3 sum21=sum21+2*nchoosek(M-1,2); % two on side 1 end if m&gt;=3 sum21=sum21+2*nchoosek(m-1,2); % two on side 2 end sum21 % two corners are chosen % different side sum22=0; sum22=(M-1)*(m-1)*2*2; % picking two pts from one side of diagonal % first *2 because diagonal splits it into two side % second *2 because we can pick two pairs of different side corners sum22=sum22+(M+m-2)*(M+m-2)*2; sum22 % three cor;ners sum3=0; sum3=4*(M-1+m-1); sum3 % four corners sum4=0; sum4=1; y=sum0+sum1+sum21+sum22+sum3+sum4; end </code></pre> <p>Please help. </p>