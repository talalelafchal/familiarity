MATLAB contour plot of 2D scatter
<p>What I want to do is very simple, I just cannot seem to get MATLAB to do it. I would like to plot contours using my 2D data set.</p> <p>My data set is large; 2 x 844240. I can do a scatter plot just fine,</p> <pre><code>scatter(Data(1,:), Data(2,:)); </code></pre> <p>Reading through the forums I found <a href="http://stackoverflow.com/questions/21006490/scatter-plot-with-density-in-matlab">Scatter plot with density in Matlab</a>, where a hisogram was plotted. This would suffice, however, I would like to overlay the plots.</p> <p><img src="https://i.stack.imgur.com/f9FhD.png" alt="enter image description here"></p> <p>The issue is that they have different axis, my scatter data has an axis of [0 0.01 0 2500]; whereas the histogram is [0 100 0 100].</p> <p>Is there a way to change the axis values of the histogram without modifying the image?</p> <p>Thanks!</p>
<p>If I understand correctly, you are using <code>hist3</code> to construct a histogram and then using <code>imagesc</code> to plot it. You can use the second output argument of <code>hist3</code> to get the histogram bin centers, and then pass those on to <code>imagesc</code>, e.g.</p> <pre><code>nBins_x = 100; nBins_y = 100; [counts, bin_centers] = hist3(Data, [nBins_x nBins_y]); x_bin_centers = bin_centers{1}; y_bin_centers = bin_centers{2}; imagesc(x_bin_centers, y_bin_centers, counts) </code></pre> <p>A couple other notes:</p> <ul> <li><p>In your case, you will need to transpose your [2 x N] matrix when passing it to <code>hist3</code>, which expects an [N x 2] matrix.</p></li> <li><p><code>imagesc</code> puts the first axis (which I've been calling the "x" axis) on the vertical axis and the second on the horizontal axis. If you want to flip it, you can use:</p> <pre><code>imagesc(y_bin_centers, x_bin_centers, counts') </code></pre></li> <li><p>If you want to specify the histogram bins explicitly (e.g. to match your scatterplot) you can specify that in the arguments to hist3:</p> <pre><code>x_bin_centers = linspace(0, .01, 100); y_bin_centers = linspace(0, 2500, 100); counts = hist3(Data, {x_bin_centers, y_bin_centers}; </code></pre></li> </ul> <p>And if you want a contour plot, you can use (note that <code>contour</code> takes the axes arguments in a different order than <code>imagesc</code>):</p> <pre><code>contour(x_bin_centers, y_bin_centers, counts'); </code></pre> <p>If you are unhappy with the jaggedness of the contours, you may consider using a kernel density estimate instead of a histogram <s>(check out ksdensity)</s> (oops, looks like <code>ksdensity</code> is 1-D only. But there are File Exchange submissions for bivariate kernel density estimation).</p>