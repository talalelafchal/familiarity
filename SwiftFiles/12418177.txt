How to get root view controller?
<p>I need an instance of root view controller. However this code return null:</p> <pre><code> UIViewController *rootViewController = (UIViewController*)[[[UIApplication sharedApplication] keyWindow] rootViewController]; </code></pre> <p>Any ideas why ? </p> <p>Also when i try to get array of controllers:</p> <pre><code>NSArray *viewControllers = self.navigationController.viewControllers; </code></pre> <p>This return just one controller, but this return isn't my root view controller.</p> <p>If i try to call this:</p> <pre><code>UIViewController *root = (UIViewController*)[self.navigationController.viewControllers objectAtIndex:0]; </code></pre> <p>This still returning null.</p> <p>What else i could try to get instance of my root view controller ?</p> <p>Thanks.</p>
<p>if you are trying to access the <code>rootViewController</code> you set in your appDelegate. try this:</p> <p><strong>Objective-C</strong></p> <pre><code>YourViewController *rootController =(YourViewController*)[[(YourAppDelegate*) [[UIApplication sharedApplication]delegate] window] rootViewController]; </code></pre> <p><strong>Swift</strong></p> <pre><code>let appDelegate = UIApplication.sharedApplication().delegate as AppDelegate let viewController = appDelegate.window!.rootViewController as YourViewController </code></pre>
<p>As suggested <a href="http://stackoverflow.com/questions/10003562/ios-how-to-segue-back-to-a-uiviewcontroller-thats-already-loaded">here</a> by @0x7fffffff, if you have UINavigationController it can be easier to do:</p> <pre><code>YourViewController *rootController = (YourViewController *) [self.navigationController.viewControllers objectAtIndex: 0]; </code></pre> <p>The code in the answer above returns UINavigation controller (if you have it) and if this is what you need, you can use <code>self.navigationController</code>.</p>
<p>Unless you have a good reason, in your root controller do this:</p> <pre><code>[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(onTheEvent:) name:@"ABCMyEvent" object:nil]; </code></pre> <p>And when you want to notify it:</p> <pre><code>[[NSNotificationCenter defaultCenter] postNotificationName:@"ABCMyEvent" object:self]; </code></pre>
<p>Swift way to do it, you can call this from anywhere, it returns optional so watch out about that: </p> <pre><code>/// EZSwiftExtensions - Gives you the VC on top so you can easily push your popups var topMostVC: UIViewController? { var presentedVC = UIApplication.sharedApplication().keyWindow?.rootViewController while let pVC = presentedVC?.presentedViewController { presentedVC = pVC } if presentedVC == nil { print("EZSwiftExtensions Error: You don't have any views set. You may be calling them in viewDidLoad. Try viewDidAppear instead.") } return presentedVC } </code></pre> <p>Its included as a standard function in:</p> <p><a href="https://github.com/goktugyil/EZSwiftExtensions" rel="nofollow">https://github.com/goktugyil/EZSwiftExtensions</a></p>
<p>In short hand way of access root view controller.</p> <p><strong>Objective C</strong></p> <pre><code>UIViewController *controller = [UIApplication sharedApplication].keyWindow.rootViewController; </code></pre> <p><strong>Swift 2.0</strong></p> <pre><code>let viewController = UIApplication.sharedApplication().keyWindow?.rootViewController </code></pre>
<p><strong>Objective-C format :</strong></p> <pre><code>UIViewController *objViewController = [UIApplication sharedApplication].keyWindow.rootViewController; </code></pre> <p><strong>Swift 2 format :</strong></p> <pre><code>let objViewController = UIApplication.sharedApplication().keyWindow?.rootViewController </code></pre> <p><strong>Swift 3 format :</strong></p> <pre><code>let objViewController = UIApplication.shared().keyWindow?.rootViewController </code></pre>
<p><strong>Swift 3: Chage ViewController withOut Segue and send AnyObject</strong> Use: Identity MainPageViewController on target ViewController </p> <pre><code> let mainPage = self.storyboard?.instantiateViewController(withIdentifier: "MainPageViewController") as! MainPageViewController var mainPageNav = UINavigationController(rootViewController: mainPage) self.present(mainPageNav, animated: true, completion: nil) </code></pre> <p><strong>or if you want to Change View Controller and send Data</strong></p> <p>let mainPage = self.storyboard?.instantiateViewController(withIdentifier: "MainPageViewController") as! MainPageViewController</p> <p>let dataToSend = "<strong>Any String</strong>" or var ObjectToSend:<strong>AnyObject</strong> </p> <p>mainPage.getData = dataToSend </p> <pre><code> var mainPageNav = UINavigationController(rootViewController: mainPage) self.present(mainPageNav, animated: true, completion: nil) </code></pre>
<p><strong>Swift 3:</strong></p> <pre><code>let appDelegate = UIApplication.shared.delegate as! AppDelegate let rootViewController = appDelegate.window!.rootViewController as! YourViewController </code></pre>