Cocoa Authorization in Swift
<p>This is my first time writing in Swift, Cocoa (have experience in Cocoa Touch), and using Authorization, so I honestly have no idea if I am even on the right track. I am trying to make a modification to the hosts file, which requires user authentication, but both the <code>AuthorizationCreate</code> and <code>AuthorizationExecuteWithPrivileges</code> methods are giving errors.</p> <pre><code>var authorizationRef:AuthorizationRef var status:OSStatus status = AuthorizationCreate(nil, environment:kAuthorizationEmptyEnvironment, flags:kAuthorizationFlagDefaults, authorization:&amp;authorizationRef) let overwrite_hosts = "echo \(hostsContents) &gt; /private/etc/hosts" let args = [overwrite_hosts.cStringUsingEncoding(NSUTF8StringEncoding)] status = AuthorizationExecuteWithPrivileges(authorizationRef, pathToTool:"/bin/sh", options:kAuthorizationFlagDefaults, arguments:args, communicationsPipe:nil) </code></pre> <p>Me calling <code>AuthorizationCreate</code> is throwing "Type '()' does not conform to protocol 'AuthorizationRef'" and my call of <code>AuthorizationExecuteWithPrivileges</code> is throwing "Could not find an overload for '__conversion' that accepts the supplied arguments"</p> <p>Any ideas? Am I approaching this incorrectly?</p> <p>Thanks for any help!</p>
<p>I was able to figure out how to do it via AppleScript, but you should be able to do it using the Authorization method I was trying before, therefore leaving this question open. Anybody looking for a quick solution (no error checks implemented) you can use what I wrote below:</p> <pre><code>func doScriptWithAdmin(inScript:String) -&gt; String{ let script = "do shell script \"\(inScript)\" with administrator privileges" var appleScript = NSAppleScript(source: script) var eventResult = appleScript.executeAndReturnError(nil) if !eventResult { return "ERROR" }else{ return eventResult.stringValue } } </code></pre>