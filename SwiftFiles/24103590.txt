How do you convert a String to a CString in the Swift Language?
<p>I am trying to use dispatch_queue_create with a dynamic String that I am creating at runtime as the first parameter. The compiler complains because it expects a standard c string. If I switch this to a compile time defined string the error goes away. Can anyone tell me how to convert a String to a standard c string?</p>
<p>You can get a <code>CString</code> as follows:</p> <pre><code>import Foundation var str = "Hello, World" var cstr = str.bridgeToObjectiveC().UTF8String </code></pre> <p><strong>EDIT:</strong> Beta 5 Update - <code>bridgeToObjectiveC()</code> no longer exists (thanks @Sam):</p> <pre><code>var cstr = (str as NSString).UTF8String </code></pre>
<p>Swift bridges String and NSString. I believe this may be possible alternative to Cezary's answer:</p> <pre><code>import Foundation var str = "Hello World" var cstr = str.cStringUsingEncoding(NSUTF8StringEncoding) </code></pre> <p>The API documentation:</p> <pre><code>/* Methods to convert NSString to a NULL-terminated cString using the specified encoding. Note, these are the "new" cString methods, and are not deprecated like the older cString methods which do not take encoding arguments. */ func cStringUsingEncoding(encoding: UInt) -&gt; CString // "Autoreleased"; NULL return if encoding conversion not possible; for performance reasons, lifetime of this should not be considered longer than the lifetime of the receiving string (if the receiver string is freed, this might go invalid then, before the end of the autorelease scope) </code></pre>
<p>There is also String.withCString() which might be more appropriate, depending on your use case. Sample:</p> <pre><code>var buf = in_addr() let s = "17.172.224.47" s.withCString { cs in inet_pton(AF_INET, cs, &amp;buf) } </code></pre> <p><em>Update Swift 2.2</em>: Swift 2.2 automagically bridges String's to C strings, so the above sample is now a simple:</p> <pre><code>var buf = in_addr() let s = "17.172.224.47" net_pton(AF_INET, s, &amp;buf) </code></pre> <p>Much easier ;-></p>