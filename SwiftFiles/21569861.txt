How to stop a time UILabel from resizing at every time increment?
<p>I have a stopwatch feature in my app that uses a centered attributed <code>UILabel</code> with a proportionally spaced font to render time. At every time increment the width of the label changes, creating a bouncing effect that looks especially bad at fast speeds. Here is an <a href="http://cl.ly/image/3L0D2O271K1h">example</a>.</p> <p>How can I fix this?</p> <p><strong>iOS 9 UPDATE</strong></p> <p>It is now a one-liner:</p> <pre><code>UIFont.monospacedDigitSystemFontOfSize(17, weight: UIFontWeightRegular) </code></pre> <p>Also, last time I tried, the solution below did not work for iOS 9. Wasted quite a bit of time debugging before stumbling on this in the header.</p> <p><strong>SOLUTION</strong></p> <p>Turned out to be trivial with Text Kit in iOS 7.</p> <p>Make sure Core Text is imported:</p> <pre><code>#import &lt;CoreText/CoreText.h&gt; </code></pre> <p>Create a setting that converts proportional numbers into monospaced:</p> <pre><code>NSArray *monospacedSetting = @[@{UIFontFeatureTypeIdentifierKey: @(kNumberSpacingType), UIFontFeatureSelectorIdentifierKey: @(kMonospacedNumbersSelector)}]; </code></pre> <p>Create a new font descriptor by appending the current one used by <code>UILabel</code>:</p> <pre><code>UIFontDescriptor *newDescriptor = [[timeLabel.font fontDescriptor] fontDescriptorByAddingAttributes:@{UIFontDescriptorFeatureSettingsAttribute: monospacedSetting}]; </code></pre> <p>Update label's font:</p> <pre><code>// Size 0 to use previously set font size timeLabel.font = [UIFont fontWithDescriptor:newDescriptor size:0]; </code></pre>
<p>Use a monospaced font or pass parameters when creating the font which force monospaced numbers:</p> <pre><code>//kNumberSpacingType 6 //kMonospacedNumbersSelector 0 NSArray *setting = @[ @{ UIFontFeatureTypeIdentifierKey: @(6), UIFontFeatureSelectorIdentifierKey: @(0) } ]; return [UIFont fontWithDescriptor:[[self fontDescriptor] fontDescriptorByAddingAttributes:@{UIFontDescriptorFeatureSettingsAttribute : setting}] size:0.0]; </code></pre>
<p>For future readers:</p> <p>This is how to enable monospaced numbers on iOS 9 with San Francisco:</p> <pre><code>let originalFont = UIFont.systemFontOfSize(17) let originalFontDescriptor = originalFont.fontDescriptor() let fontDescriptorFeatureSettings = [ [ UIFontFeatureTypeIdentifierKey: kNumberSpacingType, UIFontFeatureSelectorIdentifierKey: kMonospacedNumbersSelector ] ] let fontDescriptorAttributes = [UIFontDescriptorFeatureSettingsAttribute: fontDescriptorFeatureSettings] let fontDescriptor = originalFontDescriptor.fontDescriptorByAddingAttributes(fontDescriptorAttributes) let font = UIFont(descriptor: fontDescriptor, size: 0) </code></pre> <p>Edit:</p> <p>Also available on GitHub: <a href="https://github.com/salutis/Font-MonospacedNumbers" rel="nofollow">https://github.com/salutis/Font-MonospacedNumbers</a></p>