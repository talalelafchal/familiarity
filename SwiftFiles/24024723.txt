Swift using NSStatusBar statusItemWithLength and NSVariableStatusItemLength
<p>I'm trying to rewrite the following code from the <a href="https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/StatusBar/Tasks/creatingitems.html#//apple_ref/doc/uid/20000996-BBCDAGHB">Status Bar Programming Topics</a> in Swift.</p> <pre><code>NSStatusBar *bar = [NSStatusBar systemStatusBar]; theItem = [bar statusItemWithLength:NSVariableStatusItemLength]; [theItem retain]; [theItem setTitle: NSLocalizedString(@"Tablet",@"")]; ... </code></pre> <p>My Swift code so far:</p> <pre><code>let bar = NSStatusBar.systemStatusBar() let sm = bar.statusItemWithLength(NSVariableStatusItemLength) sm.title = "Tablet" ... </code></pre> <p>The problem is that the <code>statusItemWithLength</code> method in Swift excepts <code>CGFloat</code> but <code>NSVariableStatusItemLength</code> is defined as <code>CInt</code> in Swift. I see the following error:</p> <pre><code>'CInt' is not convertible to 'CGFloat' </code></pre> <p>Definition in Xcode:</p> <pre><code>var NSVariableStatusItemLength: CInt { get } var NSSquareStatusItemLength: CInt { get } class NSStatusBar : NSObject { class func systemStatusBar() -&gt; NSStatusBar! func statusItemWithLength(length: CGFloat) -&gt; NSStatusItem! ... } </code></pre> <p>Am I doing something wrong? How can I fix this?</p>
<p>For Beta 1 &amp; 2 you can manually convert NSVariableStatusItemLength from CInt to the required CGFloat like so:</p> <pre><code>let sm = bar.statusItemWithLength( CGFloat(NSVariableStatusItemLength) ) </code></pre> <p>In Beta 3 NSVariableStatusItemLength is now a CGFloat, but due to a linker error (bug) you have to use <br> -1 instead of NSVariableStatusItemLength and <br> -2 instead of NSSquareStatusItemLength</p> <pre><code>let sm = bar.statusItemWithLength( -1 ) </code></pre> <p>Thanks to suzhi and gui_dos for figuring this out!</p>
<p>As a workaround, with the Beta 3 release you can pass the Int constant directly. For instance:</p> <pre><code>statusItem = NSStatusBar.systemStatusBar().statusItemWithLength(-1) // NSVariableStatusItemLength </code></pre> <p><a href="https://github.com/gui-dos/Guigna/blob/181f9db1056dece888dc29424cc2da79f8f284e3/Guigna-Swift/Guigna/GuignaAppDelegate.swift#L138" rel="nofollow">https://github.com/gui-dos/Guigna/blob/181f9db1056dece888dc29424cc2da79f8f284e3/Guigna-Swift/Guigna/GuignaAppDelegate.swift#L138</a></p>