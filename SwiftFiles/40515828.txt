Twitter OAuth failing with &quot;Could not authenticate you.&quot; [Swift3]
I'm implementing Twitter OAuth in Swift3. Basically, I could generate the signatures and send post request in the required format. However, I'm still getting this error: { code = 32; message = "Could not authenticate you."; } My code for post request for obtaining the request token is as below. Is there something wrong with what I have over here? I'm sure I created the signatures following the right process.  func postToGetRequestToken() { let requestMethod = "POST" let requestURL = "https://api.twitter.com/oauth/request_token" // signature_key ok let signatureKey = APISecret.urlEncodedString+"&"+accessTokenSecret.urlEncodedString // get epoch time var timeString = String(NSDate().timeIntervalSince1970) if let dotRange = timeString.range(of: ".") { timeString.removeSubrange(dotRange.lowerBound..<timeString.endIndex) } var queryItems: [String:String] = [ "oauth_nonce": String(NSDate().timeIntervalSince1970), // ok "oauth_callback": "twitterauthtest://", "oauth_consumer_key": APIKey, // ok "oauth_signature_method": "HMAC-SHA1", // ok "oauth_timestamp": timeString, // ok "oauth_version": "1.0", // ok ] // Encode each parameter for key in queryItems.keys { if (key == "oauth_callback") { continue } if let value = queryItems[key] { queryItems[key] = value.urlEncodedString } } // sort parameter keys let sortedKeys = Array(queryItems.keys).sorted() // key=value&key=value&... var request_params = "" for key in sortedKeys { if (key == "oauth_callback") { continue } if let value = queryItems[key] { request_params += "\(key)=\(value)&" } } request_params = request_params.substring(to: request_params.index(before: request_params.endIndex)) let encodedRequestParams = request_params.urlEncodedString print(request_params) // url encode request method let encodedRequestMethod = requestMethod.urlEncodedString // url encode request url let encodedRequestUrl = requestURL.urlEncodedString // sig data let signatureData = "\(encodedRequestMethod)&\(encodedRequestUrl)&\(encodedRequestParams)" print("base string") print(signatureData) let hash:String = signatureData.hmac(algorithm: HMACAlgorithm.SHA1, key: signatureKey) let signature = hash.toBase64() print(signature) queryItems["oauth_signature"] = signature // key=value,key=value,... var header_params = "OAuth " for key in queryItems.keys { if let value = queryItems[key] { header_params += "\(key)=\"\(value.urlEncodedString)\", " } } header_params = header_params.substring(to: header_params.index(before: header_params.endIndex)) header_params = header_params.substring(to: header_params.index(before: header_params.endIndex)) print(header_params) var request = URLRequest(url: URL(string: requestURL)!) request.httpMethod = requestMethod request.addValue(header_params , forHTTPHeaderField: "Authorization") let task = URLSession.shared.dataTask(with: request) { data, response, error in if let data = try! JSONSerialization.jsonObject(with: data!, options: .allowFragments) as? [String: Any] { print(data) print(error) print(response) } } task.resume()