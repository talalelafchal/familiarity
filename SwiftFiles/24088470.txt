Getting AVAudioPCMBuffer working (AVAudioFile.mm error code -50)
<p>I'm trying to set up a basic example in a Swift playground (code below) but have also tried it with Objective-C with the same result.</p> <pre><code>import AVFoundation let fileURL = ... // have tried a wav file and a aiff file let myAudioFile = AVAudioFile(forReading: fileURL, error: nil) let myAudioFormat = myAudioFile.fileFormat let myAudioFrameCount = UInt32(myAudioFile.length) var myAudioBuffer = AVAudioPCMBuffer(PCMFormat: myAudioFormat, frameCapacity: myAudioFrameCount) // have also tried a smaller frameCapacity </code></pre> <p>It works fine up to this point, but then terminates with this:</p> <pre><code>var myError: NSError? myAudioFile.readIntoBuffer(myAudioBuffer, error:&amp;myError) </code></pre> <p>I have also tried naming the argument with buffer:myAudioBuffer but that gives an "extraneous argument" error.</p> <p>Ultimately, I want to get out raw PCM data from the buffer as a Swift array of floats.</p>
<p>The <code>AVAudioPCMBuffer</code>'s <code>PCMFormat</code> has to be set as the <code>AVAudioFile</code>'s <code>.processingFormat</code> and <em>not</em> its <code>.fileFormat</code>: I thought these were the same, but that's not the case!</p>