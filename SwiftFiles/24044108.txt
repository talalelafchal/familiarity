Pass variables from one ViewController to another in Swift
<p>I have a calculator class, a first ViewController to insert the values and a second ViewController to show the result of the calculation. Unfortunately I get a error called "Can't unwrap Optional.None" if I click the button. I know it's something wrong with the syntax, but I don't know how to improve it.</p> <p>The button in the first Viewcontroller is set to "Segue: Show (e.g. Push)" in the storyboard to switch to the secondViewController if he gets tapped. </p> <p>the calculator class is something like:</p> <pre><code>class Calculator: NSObject { func calculate (a:Int,b:Int) -&gt; (Int) { var result = a * b return (result) } } </code></pre> <p>The Viewcontroller calls the function, inserts a/b and wants to change the label which is located in the secondviewcontroller:</p> <pre><code>class ViewController: UIViewController { @IBAction func myButtonPressed(sender : AnyObject) { showResult() } var numberOne = 4 var numberTwo = 7 var myCalc = Calculator() func showResult () { var myResult = myCalc.calculate(numberOne, b: numberTwo) println("myResult is \(String(myResult))") var myVC = secondViewController() myVC.setResultLabel(myResult) } </code></pre> <p>And here is the code of the secondViewController</p> <pre><code>class secondViewController: UIViewController { @IBOutlet var myResultLabel : UILabel = nil func setResultLabel (resultValue:Int) { myResultLabel.text = String(resultValue) } init(coder aDecoder: NSCoder!) { super.init(coder: aDecoder) } </code></pre>
<p>The problem here is that the <code>FirstViewController</code> has no reference to the instance of <code>SecondViewController</code>. Because of this, this line:</p> <pre><code>secondViewController.setResultLabel(myResult) </code></pre> <p>does nothing (except probably causing the <code>Can't unwrap Optional.None</code> error). There are a few ways to solve this problem. If you are using storyboard segues you can use the <code>-prepareForSegue</code> method of <code>UIViewController</code>. Here is an example:</p> <p>In FirstViewController:</p> <pre><code>override func prepareForSegue(segue: UIStoryboardSegue!,sender: AnyObject!){ //make sure that the segue is going to secondViewController if segue.destinationViewController is secondViewController{ // now set a var that points to that new viewcontroller so you can call the method correctly let nextController = (segue.destinationViewController as! secondViewController) nextController.setResultLabel((String(myResult))) } } </code></pre> <p>Note: this code will not run as is because the function has no access to the result variable. you'll have to figure that out yourself :)</p>
<p>I think the issue here is, you are trying to set the UI component (here, its the label : myResultLabel)</p> <p>When segue is fired from first view controller, the second view has not yet been initialized. In other words, the UI object "myResultLabel" is still nil.</p> <p>To solve this, you will need to create a local string variable in second controller. Now, set that string to what you are trying to display, and finally, set the actual label in "viewDidLoad()" of the second controller. </p> <p>Best Regards, Gopal Nair.</p>
<p>In Swift, everything is public by default. Define your variables outside the classes:</p> <pre><code>import UIKit var placesArray: NSMutableArray! class FirstViewController: UIViewController { // .. // } </code></pre> <p>and then access it</p> <pre><code>import UIKit class TableViewController: UITableViewController { // placesArray = [1, 2, 3] // } </code></pre>