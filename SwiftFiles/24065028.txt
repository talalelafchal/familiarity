NSUserDefaults objectForKey() Receiving Error
<p>I was building a game in Swift that stored the user's highscore in NSUserDefaults, however later on the game kept crashing. I narrowed it down to reading the highscore of NSUserDefaults and so I made a simple app to test saving and reading values with NSUserDefaults. I run each function in order with button taps. Here's the code:</p> <pre><code>@IBOutlet var valueTextfield: UITextField @IBOutlet var keyTextfield: UITextField @IBOutlet var valueLabel: UILabel @IBAction func saveData(sender: UIButton){ NSUserDefaults.standardUserDefaults().setObject(valueTextfield.text, forKey: keyTextfield.text) } @IBAction func forceSynchronise(sender: UIButton){ NSUserDefaults.standardUserDefaults().synchronize() } @IBAction func refreshLabel(sender: UIButton){ valueLabel.text = NSUserDefaults.standardUserDefaults().objectForKey(keyTextfield.text) as String } </code></pre> <p>When the last function runs it throws the exception: 'fatal error: Can't unwrap Optional.None'. I thought that since the last line would definitely return a value, optionals weren't needed, but evidently I'm wrong. Could someone please point out what I'm doing wrong?</p> <p>Thanks for the help!</p>
<p>use</p> <pre><code>as? String </code></pre> <p>instead of </p> <pre><code>as String </code></pre> <p>otherwise you will get a crash on nil values.</p>
<p>I would do this:</p> <pre><code>if let valueText = NSUserDefaults.standardUserDefaults().objectForKey(keyTextfield.text) as? String{ valueLabel.text = valueText }else{ //handle nil value } </code></pre> <p>This won't crash and lets you handle getting a nil value.</p>