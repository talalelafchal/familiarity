UIPageController - Detect Current Page If swipe Cancelled (SWIFT 3.*)
I currently have a UIPageController which correctly detects the previous or next pageIndex upon scroll The problem I have of which I need a solution for is... Example:- The user scrolls left or right but then decides to cancel during the swipe... thus remains on the current page. The pageIndex changes to the pending page(next page) and not the actual current page.. My code currently to achieve the above statement :-- func pageViewController(_ pageViewController: UIPageViewController, willTransitionTo pendingViewControllers: [UIViewController]) { if let itemController = pendingViewControllers[0] as? PageContentViewController { nextIndex = itemController.pageIndex print("Page index = \(nextIndex)") } } func pageViewController(_ pageViewController: UIPageViewController, didFinishAnimating finished: Bool, previousViewControllers: [UIViewController], transitionCompleted completed: Bool) { currentIndex = nextIndex print("Current Page = \(currentIndex)") } func pageViewController(_ pageViewController: UIPageViewController, viewControllerAfter viewController: UIViewController) -> UIViewController? { let itemController = viewController as! PageContentViewController if itemController.pageIndex < numberOfPages { return getItemController(itemController.pageIndex+1) } return nil } func pageViewController(_ pageViewController: UIPageViewController, viewControllerBefore viewController: UIViewController) -> UIViewController? { let itemController = viewController as! PageContentViewController if itemController.pageIndex > 0 { return getItemController(itemController.pageIndex-1) } return nil } func getItemController(_ itemIndex: Int) -> PageContentViewController? { if itemIndex < numberOfPages { let pageItemController = self.storyboard!.instantiateViewController(withIdentifier: "Page1") as! PageContentViewController pageItemController.pageIndex = itemIndex return pageItemController } return nil } I want to get the page number before the page displays so I can display particular objects etc. viewControllerAfter and viewControllerBefore doesn't seem to be called every single time thus I cannot rely on this delegate method
I do not know how I missed this but in the didFinishAnimating method their is a completion block thus the following code fixed my issue func pageViewController(_ pageViewController: UIPageViewController, didFinishAnimating finished: Bool, previousViewControllers: [UIViewController], transitionCompleted completed: Bool) { if completed { currentIndex = nextIndex } print("Current Page = \(currentIndex)") }